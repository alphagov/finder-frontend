<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Finder-frontend</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.12.3/application.js' type='text/javascript'></script>
    <link href='./assets/0.12.3/application.css' media='screen, projection, print' rel='stylesheet' type='text/css' />
    <link rel="shortcut icon" type="image/png" href="./assets/0.12.3/favicon_yellow.png" />
    <link rel="icon" type="image/png" href="./assets/0.12.3/favicon.png" />
  </head>

  <body>
    <div id="loading">
      <img src="./assets/0.12.3/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" class="hide">
      <div class="timestamp">Generated <abbr class="timeago" title="2019-01-01T00:00:00+00:00">2019-01-01T00:00:00+00:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent">
      <span class="yellow">
  84.01%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         37.25
       </span>
    </span> hits/line
    )
  </h2>

  <a name="AllFiles"></a>

  <div>
    <b>131</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>3446</b> relevant lines,
    <span class="green"><b>2895</b> lines covered</span> and
    <span class="red"><b>551</b> lines missed. </span>
    (<span class="yellow">
  84.01%
</span>
)
  </div>

  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#4749fe99cd8c558360e4b643bb7a414d88726dd3" class="src_link" title="app/controllers/application_controller.rb">app/controllers/application_controller.rb</a></td>
            <td class="red strong cell--number t-file__coverage">73.21 %</td>
            <td class="cell--number">114</td>
            <td class="cell--number">56</td>
            <td class="cell--number">41</td>
            <td class="cell--number">15</td>
            <td class="cell--number">18.77</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#01f231d0f51b0a260a6639a4819731b0339d844e" class="src_link" title="app/controllers/concerns/finder_top_result_ab_testable.rb">app/controllers/concerns/finder_top_result_ab_testable.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">27</td>
            <td class="cell--number">10</td>
            <td class="cell--number">10</td>
            <td class="cell--number">0</td>
            <td class="cell--number">16.90</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#444f4a8d4793152287477027622184223a192a78" class="src_link" title="app/controllers/email_alert_subscriptions_controller.rb">app/controllers/email_alert_subscriptions_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">82.35 %</td>
            <td class="cell--number">69</td>
            <td class="cell--number">34</td>
            <td class="cell--number">28</td>
            <td class="cell--number">6</td>
            <td class="cell--number">1.53</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#65ac3c5eb8fe46d65557ebf10d366b6a54cfc204" class="src_link" title="app/controllers/finders_controller.rb">app/controllers/finders_controller.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">84.78 %</td>
            <td class="cell--number">200</td>
            <td class="cell--number">92</td>
            <td class="cell--number">78</td>
            <td class="cell--number">14</td>
            <td class="cell--number">57.30</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#dff0f55e1a82512d96da32c1361438bbd2b70ad1" class="src_link" title="app/controllers/redirection_controller.rb">app/controllers/redirection_controller.rb</a></td>
            <td class="red strong cell--number t-file__coverage">29.41 %</td>
            <td class="cell--number">43</td>
            <td class="cell--number">17</td>
            <td class="cell--number">5</td>
            <td class="cell--number">12</td>
            <td class="cell--number">0.29</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f8f6bffa205f389d3f70bd66d66b0fc39b419781" class="src_link" title="app/helpers/application_helper.rb">app/helpers/application_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">5</td>
            <td class="cell--number">3</td>
            <td class="cell--number">3</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.67</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#8c41a2e3b8e0bd4fbfe4f2967966a37302de7733" class="src_link" title="app/helpers/brexit_checker_helper.rb">app/helpers/brexit_checker_helper.rb</a></td>
            <td class="red strong cell--number t-file__coverage">30.77 %</td>
            <td class="cell--number">106</td>
            <td class="cell--number">52</td>
            <td class="cell--number">16</td>
            <td class="cell--number">36</td>
            <td class="cell--number">0.31</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f2b75c58a25c445f4c06888d615f377b19f607a6" class="src_link" title="app/helpers/page_metadata_helper.rb">app/helpers/page_metadata_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">12</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">35.29</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#87e7c707bec76e77a7cd7fe50c592b012d9ac1db" class="src_link" title="app/helpers/title_context_helper.rb">app/helpers/title_context_helper.rb</a></td>
            <td class="red strong cell--number t-file__coverage">75.00 %</td>
            <td class="cell--number">13</td>
            <td class="cell--number">8</td>
            <td class="cell--number">6</td>
            <td class="cell--number">2</td>
            <td class="cell--number">25.75</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2337228df133259f6429960db81aecd933fb276a" class="src_link" title="app/helpers/topic_finder_helper.rb">app/helpers/topic_finder_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">9</td>
            <td class="cell--number">5</td>
            <td class="cell--number">5</td>
            <td class="cell--number">0</td>
            <td class="cell--number">46.80</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ebcd738ff91561578e27b00548832484fbac8821" class="src_link" title="app/lib/brexit_checker/action.rb">app/lib/brexit_checker/action.rb</a></td>
            <td class="red strong cell--number t-file__coverage">54.55 %</td>
            <td class="cell--number">91</td>
            <td class="cell--number">44</td>
            <td class="cell--number">24</td>
            <td class="cell--number">20</td>
            <td class="cell--number">0.55</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b08459bab54cfa620e4e98909174d8c5a63ef097" class="src_link" title="app/lib/brexit_checker/criterion.rb">app/lib/brexit_checker/criterion.rb</a></td>
            <td class="red strong cell--number t-file__coverage">62.50 %</td>
            <td class="cell--number">30</td>
            <td class="cell--number">16</td>
            <td class="cell--number">10</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0.63</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b88bcd4e68e5d53487b63411388c45d1f418b974" class="src_link" title="app/lib/brexit_checker/group.rb">app/lib/brexit_checker/group.rb</a></td>
            <td class="red strong cell--number t-file__coverage">61.11 %</td>
            <td class="cell--number">43</td>
            <td class="cell--number">18</td>
            <td class="cell--number">11</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0.61</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#76d35338a9bb3ae1fd3936a3b62b49e429a36ed3" class="src_link" title="app/lib/brexit_checker/notification.rb">app/lib/brexit_checker/notification.rb</a></td>
            <td class="red strong cell--number t-file__coverage">58.33 %</td>
            <td class="cell--number">38</td>
            <td class="cell--number">24</td>
            <td class="cell--number">14</td>
            <td class="cell--number">10</td>
            <td class="cell--number">0.58</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1bcb1d680a07c2de7b4d9bbf9d4dc22b710af55c" class="src_link" title="app/lib/brexit_checker/question.rb">app/lib/brexit_checker/question.rb</a></td>
            <td class="red strong cell--number t-file__coverage">51.52 %</td>
            <td class="cell--number">67</td>
            <td class="cell--number">33</td>
            <td class="cell--number">17</td>
            <td class="cell--number">16</td>
            <td class="cell--number">0.52</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#107d297cd338afd183baeafc96e556090b96287b" class="src_link" title="app/lib/brexit_checker/question/option.rb">app/lib/brexit_checker/question/option.rb</a></td>
            <td class="red strong cell--number t-file__coverage">53.85 %</td>
            <td class="cell--number">22</td>
            <td class="cell--number">13</td>
            <td class="cell--number">7</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0.54</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#e3285d2ba113be79c2098d7737f3f3dc92e98d01" class="src_link" title="app/lib/facets_builder.rb">app/lib/facets_builder.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">86.57 %</td>
            <td class="cell--number">120</td>
            <td class="cell--number">67</td>
            <td class="cell--number">58</td>
            <td class="cell--number">9</td>
            <td class="cell--number">91.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#5d066880dc75a4f11eb72d4aa4400faeaa8cdcc2" class="src_link" title="app/lib/filters/checkbox_filter.rb">app/lib/filters/checkbox_filter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">12</td>
            <td class="cell--number">5</td>
            <td class="cell--number">5</td>
            <td class="cell--number">0</td>
            <td class="cell--number">5.20</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#28c8e8e509f9f72053048b3efeb0bb8ead701050" class="src_link" title="app/lib/filters/content_id_filter.rb">app/lib/filters/content_id_filter.rb</a></td>
            <td class="red strong cell--number t-file__coverage">63.64 %</td>
            <td class="cell--number">21</td>
            <td class="cell--number">11</td>
            <td class="cell--number">7</td>
            <td class="cell--number">4</td>
            <td class="cell--number">0.64</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#fefe491dbd0f7a81dbc54ffcdf60737660367a5f" class="src_link" title="app/lib/filters/date_filter.rb">app/lib/filters/date_filter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">35</td>
            <td class="cell--number">18</td>
            <td class="cell--number">18</td>
            <td class="cell--number">0</td>
            <td class="cell--number">14.33</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#5e46c09ebb3620113f123e7fd3556bff3e6994d9" class="src_link" title="app/lib/filters/dropdown_select_filter.rb">app/lib/filters/dropdown_select_filter.rb</a></td>
            <td class="red strong cell--number t-file__coverage">55.56 %</td>
            <td class="cell--number">17</td>
            <td class="cell--number">9</td>
            <td class="cell--number">5</td>
            <td class="cell--number">4</td>
            <td class="cell--number">0.56</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b30131afbc50e65d1939c8fa0fa395fecd181d12" class="src_link" title="app/lib/filters/filter.rb">app/lib/filters/filter.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">87.50 %</td>
            <td class="cell--number">46</td>
            <td class="cell--number">24</td>
            <td class="cell--number">21</td>
            <td class="cell--number">3</td>
            <td class="cell--number">40.25</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f306be89311661549335fa7536a134b9555d0c6a" class="src_link" title="app/lib/filters/hidden_clearable_filter.rb">app/lib/filters/hidden_clearable_filter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">9</td>
            <td class="cell--number">5</td>
            <td class="cell--number">5</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.20</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f3485fbbfc15e74555ca6966b3949feed1eca07c" class="src_link" title="app/lib/filters/hidden_filter.rb">app/lib/filters/hidden_filter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">9</td>
            <td class="cell--number">5</td>
            <td class="cell--number">5</td>
            <td class="cell--number">0</td>
            <td class="cell--number">3.60</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b381ee46fb2975bbdee33bd2cc1b9e0c170ebbf8" class="src_link" title="app/lib/filters/official_documents_filter.rb">app/lib/filters/official_documents_filter.rb</a></td>
            <td class="red strong cell--number t-file__coverage">75.00 %</td>
            <td class="cell--number">7</td>
            <td class="cell--number">4</td>
            <td class="cell--number">3</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0.75</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#3abe6516b9f13a1a82367e6c82d0ba47c68899c6" class="src_link" title="app/lib/filters/radio_filter.rb">app/lib/filters/radio_filter.rb</a></td>
            <td class="red strong cell--number t-file__coverage">40.91 %</td>
            <td class="cell--number">40</td>
            <td class="cell--number">22</td>
            <td class="cell--number">9</td>
            <td class="cell--number">13</td>
            <td class="cell--number">0.41</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1f4780ca86cb4af2c72c7fc9fa5eaa44d03a17c8" class="src_link" title="app/lib/filters/radio_filter_for_multiple_fields.rb">app/lib/filters/radio_filter_for_multiple_fields.rb</a></td>
            <td class="green strong cell--number t-file__coverage">93.33 %</td>
            <td class="cell--number">29</td>
            <td class="cell--number">15</td>
            <td class="cell--number">14</td>
            <td class="cell--number">1</td>
            <td class="cell--number">8.73</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#4ff409b48f96d95d6600bdf298b8ff8c1542ecf3" class="src_link" title="app/lib/filters/research_and_statistics_filter.rb">app/lib/filters/research_and_statistics_filter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">7</td>
            <td class="cell--number">4</td>
            <td class="cell--number">4</td>
            <td class="cell--number">0</td>
            <td class="cell--number">8.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#77e47b21a40220df942447308e460cc8749b719a" class="src_link" title="app/lib/filters/taxon_filter.rb">app/lib/filters/taxon_filter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">15</td>
            <td class="cell--number">8</td>
            <td class="cell--number">8</td>
            <td class="cell--number">0</td>
            <td class="cell--number">16.13</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#975b2c148d26ecd9c1055a7d7c18a8674fece4eb" class="src_link" title="app/lib/filters/text_filter.rb">app/lib/filters/text_filter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">9</td>
            <td class="cell--number">5</td>
            <td class="cell--number">5</td>
            <td class="cell--number">0</td>
            <td class="cell--number">29.80</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ffbcac1f61b4acefd89896312800a62db976b17f" class="src_link" title="app/lib/filters/topical_filter.rb">app/lib/filters/topical_filter.rb</a></td>
            <td class="red strong cell--number t-file__coverage">42.86 %</td>
            <td class="cell--number">41</td>
            <td class="cell--number">21</td>
            <td class="cell--number">9</td>
            <td class="cell--number">12</td>
            <td class="cell--number">0.43</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#d05d24f4805249bdb0a1543e8659fb3966f41681" class="src_link" title="app/lib/healthchecks/registries_cache.rb">app/lib/healthchecks/registries_cache.rb</a></td>
            <td class="red strong cell--number t-file__coverage">45.45 %</td>
            <td class="cell--number">45</td>
            <td class="cell--number">22</td>
            <td class="cell--number">10</td>
            <td class="cell--number">12</td>
            <td class="cell--number">0.45</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#524ab8f3c226bc8edf9e6dcc56a8bf7ec3036e26" class="src_link" title="app/lib/parameter_parser/email_alert_parameter_parser.rb">app/lib/parameter_parser/email_alert_parameter_parser.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">83.33 %</td>
            <td class="cell--number">102</td>
            <td class="cell--number">48</td>
            <td class="cell--number">40</td>
            <td class="cell--number">8</td>
            <td class="cell--number">1.96</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#dcf9cc821d9544d1b86257b583a50e477673efc8" class="src_link" title="app/lib/params_cleaner.rb">app/lib/params_cleaner.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">85.00 %</td>
            <td class="cell--number">54</td>
            <td class="cell--number">20</td>
            <td class="cell--number">17</td>
            <td class="cell--number">3</td>
            <td class="cell--number">24.75</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#600a840e983f41aa1d688f2f80c16e94199cba68" class="src_link" title="app/lib/registries/base_registries.rb">app/lib/registries/base_registries.rb</a></td>
            <td class="red strong cell--number t-file__coverage">80.00 %</td>
            <td class="cell--number">71</td>
            <td class="cell--number">30</td>
            <td class="cell--number">24</td>
            <td class="cell--number">6</td>
            <td class="cell--number">94.07</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#cd3af41a8183ea0d8b8113e65d8eba227a1f49c2" class="src_link" title="app/lib/registries/cacheable_registry.rb">app/lib/registries/cacheable_registry.rb</a></td>
            <td class="red strong cell--number t-file__coverage">52.63 %</td>
            <td class="cell--number">35</td>
            <td class="cell--number">19</td>
            <td class="cell--number">10</td>
            <td class="cell--number">9</td>
            <td class="cell--number">15.11</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#8793ab3c1e82abf139ce499c4aea654303797bc6" class="src_link" title="app/lib/registries/full_topic_taxonomy_registry.rb">app/lib/registries/full_topic_taxonomy_registry.rb</a></td>
            <td class="green strong cell--number t-file__coverage">94.12 %</td>
            <td class="cell--number">71</td>
            <td class="cell--number">34</td>
            <td class="cell--number">32</td>
            <td class="cell--number">2</td>
            <td class="cell--number">26.62</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#6e134b9b54335845507657374583c966f3c8b33d" class="src_link" title="app/lib/registries/manuals_registry.rb">app/lib/registries/manuals_registry.rb</a></td>
            <td class="green strong cell--number t-file__coverage">95.65 %</td>
            <td class="cell--number">48</td>
            <td class="cell--number">23</td>
            <td class="cell--number">22</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1.26</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#c8cc3e2ef1926de6973bce99693776c300b2ca91" class="src_link" title="app/lib/registries/organisations_registry.rb">app/lib/registries/organisations_registry.rb</a></td>
            <td class="green strong cell--number t-file__coverage">96.15 %</td>
            <td class="cell--number">52</td>
            <td class="cell--number">26</td>
            <td class="cell--number">25</td>
            <td class="cell--number">1</td>
            <td class="cell--number">22.65</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#d8029bdac666700e37f602fdfc203fffacc7e7bb" class="src_link" title="app/lib/registries/people_registry.rb">app/lib/registries/people_registry.rb</a></td>
            <td class="green strong cell--number t-file__coverage">95.83 %</td>
            <td class="cell--number">49</td>
            <td class="cell--number">24</td>
            <td class="cell--number">23</td>
            <td class="cell--number">1</td>
            <td class="cell--number">13.58</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#c5bf18235a9d903b8d64e099814eabc98f4c3468" class="src_link" title="app/lib/registries/registry.rb">app/lib/registries/registry.rb</a></td>
            <td class="red strong cell--number t-file__coverage">75.00 %</td>
            <td class="cell--number">7</td>
            <td class="cell--number">4</td>
            <td class="cell--number">3</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0.75</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#16f6fc12f26969aa49799de895d14c5db40025a3" class="src_link" title="app/lib/registries/roles_registry.rb">app/lib/registries/roles_registry.rb</a></td>
            <td class="red strong cell--number t-file__coverage">50.00 %</td>
            <td class="cell--number">48</td>
            <td class="cell--number">24</td>
            <td class="cell--number">12</td>
            <td class="cell--number">12</td>
            <td class="cell--number">0.50</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#c6e9b056aabcbce5c9c7006d2cc086cc419dba4a" class="src_link" title="app/lib/registries/topic_taxonomy_registry.rb">app/lib/registries/topic_taxonomy_registry.rb</a></td>
            <td class="green strong cell--number t-file__coverage">94.29 %</td>
            <td class="cell--number">67</td>
            <td class="cell--number">35</td>
            <td class="cell--number">33</td>
            <td class="cell--number">2</td>
            <td class="cell--number">15.11</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#55df5e93d48064ae99b1c54fc93a9b4f8235a4c8" class="src_link" title="app/lib/registries/topical_events_registry.rb">app/lib/registries/topical_events_registry.rb</a></td>
            <td class="red strong cell--number t-file__coverage">52.17 %</td>
            <td class="cell--number">49</td>
            <td class="cell--number">23</td>
            <td class="cell--number">12</td>
            <td class="cell--number">11</td>
            <td class="cell--number">0.52</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#cb6b06d36235215b31e98c89b4cd8417726381ca" class="src_link" title="app/lib/registries/world_locations_registry.rb">app/lib/registries/world_locations_registry.rb</a></td>
            <td class="green strong cell--number t-file__coverage">95.65 %</td>
            <td class="cell--number">49</td>
            <td class="cell--number">23</td>
            <td class="cell--number">22</td>
            <td class="cell--number">1</td>
            <td class="cell--number">11.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ca9a7aa1b87ded74d76a234a486fa77f30dc1876" class="src_link" title="app/lib/search/facet_query_builder.rb">app/lib/search/facet_query_builder.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">42</td>
            <td class="cell--number">16</td>
            <td class="cell--number">16</td>
            <td class="cell--number">0</td>
            <td class="cell--number">69.63</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#12e373d5cd501c31bb691c8ad3c6bc1f4ac7f347" class="src_link" title="app/lib/search/filter_query_builder.rb">app/lib/search/filter_query_builder.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">54</td>
            <td class="cell--number">21</td>
            <td class="cell--number">21</td>
            <td class="cell--number">0</td>
            <td class="cell--number">122.29</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#aff2e7df3b9ede76cd3808d92540af8397481953" class="src_link" title="app/lib/search/order_query_builder.rb">app/lib/search/order_query_builder.rb</a></td>
            <td class="green strong cell--number t-file__coverage">96.08 %</td>
            <td class="cell--number">95</td>
            <td class="cell--number">51</td>
            <td class="cell--number">49</td>
            <td class="cell--number">2</td>
            <td class="cell--number">46.67</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1c8f1a021533609a72fac3157d5f5b7f2ac6659d" class="src_link" title="app/lib/search/query.rb">app/lib/search/query.rb</a></td>
            <td class="red strong cell--number t-file__coverage">62.22 %</td>
            <td class="cell--number">103</td>
            <td class="cell--number">45</td>
            <td class="cell--number">28</td>
            <td class="cell--number">17</td>
            <td class="cell--number">20.36</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ab0d1b9eaa2fd10f00ef2028ba84120415a9887e" class="src_link" title="app/lib/search/query_builder.rb">app/lib/search/query_builder.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">89.90 %</td>
            <td class="cell--number">422</td>
            <td class="cell--number">99</td>
            <td class="cell--number">89</td>
            <td class="cell--number">10</td>
            <td class="cell--number">43.60</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#d6ced3fabb6cda63c64ce8ea3d8294b600e63c26" class="src_link" title="app/lib/services.rb">app/lib/services.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">86.36 %</td>
            <td class="cell--number">45</td>
            <td class="cell--number">22</td>
            <td class="cell--number">19</td>
            <td class="cell--number">3</td>
            <td class="cell--number">32.50</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#65b6df5db53621bed6bd96487fcac74306b33cec" class="src_link" title="app/lib/url_builder.rb">app/lib/url_builder.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">19</td>
            <td class="cell--number">8</td>
            <td class="cell--number">8</td>
            <td class="cell--number">0</td>
            <td class="cell--number">35.13</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#23a34640937c6e84fe75ba6d87658ac17fe09386" class="src_link" title="app/models/checkbox_facet.rb">app/models/checkbox_facet.rb</a></td>
            <td class="green strong cell--number t-file__coverage">95.24 %</td>
            <td class="cell--number">54</td>
            <td class="cell--number">21</td>
            <td class="cell--number">20</td>
            <td class="cell--number">1</td>
            <td class="cell--number">18.29</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2a3eddd65d416f5785c39e0a83a14a63325930d9" class="src_link" title="app/models/content_item.rb">app/models/content_item.rb</a></td>
            <td class="green strong cell--number t-file__coverage">97.50 %</td>
            <td class="cell--number">157</td>
            <td class="cell--number">80</td>
            <td class="cell--number">78</td>
            <td class="cell--number">2</td>
            <td class="cell--number">50.25</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#cd82b79c4f528c4749b1f14603c1628a9455bdcb" class="src_link" title="app/models/date_facet.rb">app/models/date_facet.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">88.46 %</td>
            <td class="cell--number">115</td>
            <td class="cell--number">52</td>
            <td class="cell--number">46</td>
            <td class="cell--number">6</td>
            <td class="cell--number">33.06</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2f6689f2561c5cbbafdbc2256118157e6fd9e523" class="src_link" title="app/models/document.rb">app/models/document.rb</a></td>
            <td class="green strong cell--number t-file__coverage">98.73 %</td>
            <td class="cell--number">179</td>
            <td class="cell--number">79</td>
            <td class="cell--number">78</td>
            <td class="cell--number">1</td>
            <td class="cell--number">166.04</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f244b5bab3bb165edcb5728aea44995cc99ec777" class="src_link" title="app/models/facet.rb">app/models/facet.rb</a></td>
            <td class="green strong cell--number t-file__coverage">91.43 %</td>
            <td class="cell--number">69</td>
            <td class="cell--number">35</td>
            <td class="cell--number">32</td>
            <td class="cell--number">3</td>
            <td class="cell--number">304.34</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#aaad658630e1a89ac4bc46c7509e2f50f3136948" class="src_link" title="app/models/filterable_facet.rb">app/models/filterable_facet.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">11</td>
            <td class="cell--number">6</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0</td>
            <td class="cell--number">46.50</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#97f2c104c6cbee9249b40ceb89c4c911002419d5" class="src_link" title="app/models/filters.rb">app/models/filters.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">85.71 %</td>
            <td class="cell--number">69</td>
            <td class="cell--number">7</td>
            <td class="cell--number">6</td>
            <td class="cell--number">1</td>
            <td class="cell--number">5.86</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#af6a18d198539d11a17cf531ec02f715b8e7725f" class="src_link" title="app/models/hidden_clearable_facet.rb">app/models/hidden_clearable_facet.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">47</td>
            <td class="cell--number">20</td>
            <td class="cell--number">20</td>
            <td class="cell--number">0</td>
            <td class="cell--number">2.60</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ef3002e867dfb75b2603307367d0196c2ce96a70" class="src_link" title="app/models/hidden_facet.rb">app/models/hidden_facet.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">90.00 %</td>
            <td class="cell--number">45</td>
            <td class="cell--number">20</td>
            <td class="cell--number">18</td>
            <td class="cell--number">2</td>
            <td class="cell--number">5.65</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#7e52ae4c2e5b8052573e6c85d50d1e2556874c46" class="src_link" title="app/models/option_select_facet.rb">app/models/option_select_facet.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">82</td>
            <td class="cell--number">30</td>
            <td class="cell--number">30</td>
            <td class="cell--number">0</td>
            <td class="cell--number">223.77</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#864175e2af47b83151a900d686de802cc99469b7" class="src_link" title="app/models/radio_facet_for_multiple_filters.rb">app/models/radio_facet_for_multiple_filters.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">50</td>
            <td class="cell--number">24</td>
            <td class="cell--number">24</td>
            <td class="cell--number">0</td>
            <td class="cell--number">7.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#73ecc5807db4ba8fd707df60df716b250db50f7b" class="src_link" title="app/models/result_set.rb">app/models/result_set.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">9</td>
            <td class="cell--number">6</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0</td>
            <td class="cell--number">28.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#5a504829663488e8d1514239affc8288555fcd55" class="src_link" title="app/models/taxon_facet.rb">app/models/taxon_facet.rb</a></td>
            <td class="red strong cell--number t-file__coverage">78.26 %</td>
            <td class="cell--number">124</td>
            <td class="cell--number">46</td>
            <td class="cell--number">36</td>
            <td class="cell--number">10</td>
            <td class="cell--number">21.67</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#4d9102f356cbb4ed1fea3ee73c9886be0f118e75" class="src_link" title="app/parsers/date_parser.rb">app/parsers/date_parser.rb</a></td>
            <td class="red strong cell--number t-file__coverage">72.97 %</td>
            <td class="cell--number">81</td>
            <td class="cell--number">37</td>
            <td class="cell--number">27</td>
            <td class="cell--number">10</td>
            <td class="cell--number">54.43</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#3a16219d1b7c4535ae15e8ec0e133b2913a3d8b6" class="src_link" title="app/parsers/result_set_parser.rb">app/parsers/result_set_parser.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">14</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">62.43</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#0f11ddcd2c73c6b9a5e0173063aaad124955dc48" class="src_link" title="app/presenters/atom_presenter.rb">app/presenters/atom_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">94.74 %</td>
            <td class="cell--number">33</td>
            <td class="cell--number">19</td>
            <td class="cell--number">18</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1.89</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#7e609695de9d79c3ffed5aea5f76a69dbd823995" class="src_link" title="app/presenters/entry_presenter.rb">app/presenters/entry_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">94.44 %</td>
            <td class="cell--number">36</td>
            <td class="cell--number">18</td>
            <td class="cell--number">17</td>
            <td class="cell--number">1</td>
            <td class="cell--number">2.33</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1360a8958c8e1a29b81cfdcd917a865bd0f0557c" class="src_link" title="app/presenters/facet_tag_presenter.rb">app/presenters/facet_tag_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">94.12 %</td>
            <td class="cell--number">37</td>
            <td class="cell--number">17</td>
            <td class="cell--number">16</td>
            <td class="cell--number">1</td>
            <td class="cell--number">24.29</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#117d5b179f3544054e7250b307127a870c225e36" class="src_link" title="app/presenters/facet_tags_presenter.rb">app/presenters/facet_tags_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">42</td>
            <td class="cell--number">19</td>
            <td class="cell--number">19</td>
            <td class="cell--number">0</td>
            <td class="cell--number">42.11</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#a8ba89d4555481c05077e28e986fd0a423834c21" class="src_link" title="app/presenters/finder_breadcrumbs_presenter.rb">app/presenters/finder_breadcrumbs_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">27</td>
            <td class="cell--number">15</td>
            <td class="cell--number">15</td>
            <td class="cell--number">0</td>
            <td class="cell--number">13.60</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#982aba2f2c3327c30139a168cfaa22b84590732f" class="src_link" title="app/presenters/metadata_presenter.rb">app/presenters/metadata_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">40</td>
            <td class="cell--number">15</td>
            <td class="cell--number">15</td>
            <td class="cell--number">0</td>
            <td class="cell--number">67.93</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1e45aeda816b245f28997d2de9d6e7e11ec1e314" class="src_link" title="app/presenters/pagination_presenter.rb">app/presenters/pagination_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">96.55 %</td>
            <td class="cell--number">60</td>
            <td class="cell--number">29</td>
            <td class="cell--number">28</td>
            <td class="cell--number">1</td>
            <td class="cell--number">24.14</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#e114bef4b7d11c3d94bddd8110ea11cd0a74c86a" class="src_link" title="app/presenters/result_set_presenter.rb">app/presenters/result_set_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">70</td>
            <td class="cell--number">35</td>
            <td class="cell--number">35</td>
            <td class="cell--number">0</td>
            <td class="cell--number">51.43</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#6360357fe6ff9c8252fbac2cc1b5d87e1a2d56b0" class="src_link" title="app/presenters/screen_reader_filter_description_presenter.rb">app/presenters/screen_reader_filter_description_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">33</td>
            <td class="cell--number">18</td>
            <td class="cell--number">18</td>
            <td class="cell--number">0</td>
            <td class="cell--number">40.89</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#8e22bd8968b405b262c27439a0d1c16640710622" class="src_link" title="app/presenters/search_result_presenter.rb">app/presenters/search_result_presenter.rb</a></td>
            <td class="red strong cell--number t-file__coverage">75.00 %</td>
            <td class="cell--number">111</td>
            <td class="cell--number">44</td>
            <td class="cell--number">33</td>
            <td class="cell--number">11</td>
            <td class="cell--number">76.45</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#6e49e4ecb28f03cf17631b562ce81bb9d6aa62be" class="src_link" title="app/presenters/signup_links_presenter.rb">app/presenters/signup_links_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">42</td>
            <td class="cell--number">22</td>
            <td class="cell--number">22</td>
            <td class="cell--number">0</td>
            <td class="cell--number">43.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#abfeafb3bcba9182e87d3b88dd3f8213b06bcdb4" class="src_link" title="app/presenters/signup_presenter.rb">app/presenters/signup_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">95.65 %</td>
            <td class="cell--number">99</td>
            <td class="cell--number">46</td>
            <td class="cell--number">44</td>
            <td class="cell--number">2</td>
            <td class="cell--number">6.70</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2eceedd192d8454ab94792d080713ea5794cc7c3" class="src_link" title="app/presenters/sort_option_presenter.rb">app/presenters/sort_option_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">94.12 %</td>
            <td class="cell--number">40</td>
            <td class="cell--number">17</td>
            <td class="cell--number">16</td>
            <td class="cell--number">1</td>
            <td class="cell--number">88.18</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#86fb29e7e95bb5635e2a55ba0ec8536ae753190d" class="src_link" title="app/presenters/sort_presenter.rb">app/presenters/sort_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">95.83 %</td>
            <td class="cell--number">102</td>
            <td class="cell--number">48</td>
            <td class="cell--number">46</td>
            <td class="cell--number">2</td>
            <td class="cell--number">410.81</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#80e70a4020126e9243dbf23f01caa93b32b42f35" class="src_link" title="app/presenters/spelling_suggestion_presenter.rb">app/presenters/spelling_suggestion_presenter.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">87.50 %</td>
            <td class="cell--number">24</td>
            <td class="cell--number">8</td>
            <td class="cell--number">7</td>
            <td class="cell--number">1</td>
            <td class="cell--number">20.75</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#1b01d6d58815108dee7b27e0ad0aa83dfeede73a" class="src_link" title="app/presenters/statistics_metadata_presenter.rb">app/presenters/statistics_metadata_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">24</td>
            <td class="cell--number">12</td>
            <td class="cell--number">12</td>
            <td class="cell--number">0</td>
            <td class="cell--number">11.08</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f0b242feff2583a6dca5a17403f6cd1edab63049" class="src_link" title="app/presenters/statistics_sort_presenter.rb">app/presenters/statistics_sort_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">93.55 %</td>
            <td class="cell--number">72</td>
            <td class="cell--number">31</td>
            <td class="cell--number">29</td>
            <td class="cell--number">2</td>
            <td class="cell--number">562.10</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#977c5f13daa592dee729a82e72c7e5421abbafd7" class="src_link" title="app/presenters/subscriber_list_params_presenter.rb">app/presenters/subscriber_list_params_presenter.rb</a></td>
            <td class="green strong cell--number t-file__coverage">94.44 %</td>
            <td class="cell--number">69</td>
            <td class="cell--number">36</td>
            <td class="cell--number">34</td>
            <td class="cell--number">2</td>
            <td class="cell--number">2.25</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#274fa4b3c17f00fe969d308bd30c4cdd469f3985" class="src_link" title="app/validators/date_validator.rb">app/validators/date_validator.rb</a></td>
            <td class="green strong cell--number t-file__coverage">90.48 %</td>
            <td class="cell--number">50</td>
            <td class="cell--number">21</td>
            <td class="cell--number">19</td>
            <td class="cell--number">2</td>
            <td class="cell--number">32.95</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ab1c7a025575331154d656851263b597013d5726" class="src_link" title="app/validators/email_alert_params_validator.rb">app/validators/email_alert_params_validator.rb</a></td>
            <td class="red strong cell--number t-file__coverage">69.23 %</td>
            <td class="cell--number">25</td>
            <td class="cell--number">13</td>
            <td class="cell--number">9</td>
            <td class="cell--number">4</td>
            <td class="cell--number">1.38</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#5d7944d3d1e247ebff430ec77e2e9bd4d8ac5909" class="src_link" title="app/validators/param_validator.rb">app/validators/param_validator.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">88.89 %</td>
            <td class="cell--number">34</td>
            <td class="cell--number">18</td>
            <td class="cell--number">16</td>
            <td class="cell--number">2</td>
            <td class="cell--number">27.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#8d15eacfdf2955e0dc8227f9ecafbe4fb9383b37" class="src_link" title="config/application.rb">config/application.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">67</td>
            <td class="cell--number">21</td>
            <td class="cell--number">21</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#18324319bd3293e6c6a2bc9ee953e2a634742486" class="src_link" title="config/boot.rb">config/boot.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">3</td>
            <td class="cell--number">2</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#80ccc3175e73b41c3a1a3271fc73302a57e1d533" class="src_link" title="config/environment.rb">config/environment.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">5</td>
            <td class="cell--number">2</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#9ee2feff3300aeb2be2c6bf9006326d025fff116" class="src_link" title="config/environments/test.rb">config/environments/test.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">51</td>
            <td class="cell--number">14</td>
            <td class="cell--number">14</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#b5064653d0a4682a52281c99097fafffabc4a069" class="src_link" title="config/initializers/application_controller_renderer.rb">config/initializers/application_controller_renderer.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">8</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#629b3ac7dee70f24856bc2b32b8c21fcffd917e2" class="src_link" title="config/initializers/assets.rb">config/initializers/assets.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">12</td>
            <td class="cell--number">2</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2d021ded7bbbe5c9642d07dc2df7e0c6ccdf7023" class="src_link" title="config/initializers/backtrace_silencers.rb">config/initializers/backtrace_silencers.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2f9d9a907aacccd60ea9abdb149dd4227bb02140" class="src_link" title="config/initializers/content_security_policy.rb">config/initializers/content_security_policy.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">28</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#c0056af7a9f2b7d497009d908652ba61fded8ad7" class="src_link" title="config/initializers/cookies_serializer.rb">config/initializers/cookies_serializer.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">5</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#011a4e61c5637fd822295094517db6f82151a83f" class="src_link" title="config/initializers/csp.rb">config/initializers/csp.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#6db0ea846f5fd14b0fbf5bd26d4975565e0aaf1d" class="src_link" title="config/initializers/filter_parameter_logging.rb">config/initializers/filter_parameter_logging.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">4</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#4a7a45439f381aaad0a5531db16633bc2cb9c805" class="src_link" title="config/initializers/govuk_publishing_components.rb">config/initializers/govuk_publishing_components.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">3</td>
            <td class="cell--number">2</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2115f35143208cb5938a283e2af1ba0f7ec4f93d" class="src_link" title="config/initializers/inflections.rb">config/initializers/inflections.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">16</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#41ad92a1b29a88815b7b1a2f1958511576e3f235" class="src_link" title="config/initializers/mime_types.rb">config/initializers/mime_types.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">4</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0</td>
            <td class="cell--number">0.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#c7f1a95261b2a40feccecde316e36f4082a1f0b3" class="src_link" title="config/initializers/sanitizer.rb">config/initializers/sanitizer.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#3d5f1bc386f265f803d1d8c14bb8c187034566b3" class="src_link" title="config/initializers/session_store.rb">config/initializers/session_store.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">3</td>
            <td class="cell--number">1</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#80b4ad15896c1173531b8c845172b8e999e1bb0f" class="src_link" title="config/initializers/wrap_parameters.rb">config/initializers/wrap_parameters.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">9</td>
            <td class="cell--number">2</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#668f49036af12d467f0df72e90674a2f151635e4" class="src_link" title="config/initializers/zeitwerk.rb">config/initializers/zeitwerk.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">5</td>
            <td class="cell--number">2</td>
            <td class="cell--number">2</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.50</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#c0e21e9d727c6ade2b1f96c2929ac9793a4cad50" class="src_link" title="config/routes.rb">config/routes.rb</a></td>
            <td class="green strong cell--number t-file__coverage">94.12 %</td>
            <td class="cell--number">58</td>
            <td class="cell--number">34</td>
            <td class="cell--number">32</td>
            <td class="cell--number">2</td>
            <td class="cell--number">4.18</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#a2d2abb5a6ec0d50cba9096394ddc434889fb3eb" class="src_link" title="features/step_definitions/analytics_steps.rb">features/step_definitions/analytics_steps.rb</a></td>
            <td class="red strong cell--number t-file__coverage">17.14 %</td>
            <td class="cell--number">59</td>
            <td class="cell--number">35</td>
            <td class="cell--number">6</td>
            <td class="cell--number">29</td>
            <td class="cell--number">0.17</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ca5ceb5e1db3a7e19a10ac6cca2d613249b0a036" class="src_link" title="features/step_definitions/filtering_steps.rb">features/step_definitions/filtering_steps.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">85.93 %</td>
            <td class="cell--number">893</td>
            <td class="cell--number">540</td>
            <td class="cell--number">464</td>
            <td class="cell--number">76</td>
            <td class="cell--number">1.26</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#369a0762d16ac5924b0784cd96e6f34ed6aabfcb" class="src_link" title="features/step_definitions/search_steps.rb">features/step_definitions/search_steps.rb</a></td>
            <td class="red strong cell--number t-file__coverage">35.48 %</td>
            <td class="cell--number">53</td>
            <td class="cell--number">31</td>
            <td class="cell--number">11</td>
            <td class="cell--number">20</td>
            <td class="cell--number">0.35</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#366c49f44f976af436c63543745a0fbdb0d1f0df" class="src_link" title="features/support/document_helper.rb">features/support/document_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">93.80 %</td>
            <td class="cell--number">1927</td>
            <td class="cell--number">242</td>
            <td class="cell--number">227</td>
            <td class="cell--number">15</td>
            <td class="cell--number">2.49</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#de47d5e21884e5ce32f275d325eb0b440fdf38e5" class="src_link" title="features/support/qa_helper.rb">features/support/qa_helper.rb</a></td>
            <td class="red strong cell--number t-file__coverage">45.45 %</td>
            <td class="cell--number">41</td>
            <td class="cell--number">22</td>
            <td class="cell--number">10</td>
            <td class="cell--number">12</td>
            <td class="cell--number">0.45</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#fafd6cff850fa798f7166e045d0a74eac1efde90" class="src_link" title="features/support/rummager_url_helper.rb">features/support/rummager_url_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">92.31 %</td>
            <td class="cell--number">99</td>
            <td class="cell--number">26</td>
            <td class="cell--number">24</td>
            <td class="cell--number">2</td>
            <td class="cell--number">7.50</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#34175305ca8434ba77268f2ab2334a3a4462051a" class="src_link" title="spec/factories/brexit_checker/action.rb">spec/factories/brexit_checker/action.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">20</td>
            <td class="cell--number">14</td>
            <td class="cell--number">14</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#92dfee68d45491efeefcc329ae9206f17593df9c" class="src_link" title="spec/factories/brexit_checker/criterion.rb">spec/factories/brexit_checker/criterion.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">8</td>
            <td class="cell--number">5</td>
            <td class="cell--number">5</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#6a0c9f89960f2d98bbe3cd9559c6efd1225ed694" class="src_link" title="spec/factories/brexit_checker/group.rb">spec/factories/brexit_checker/group.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">8</td>
            <td class="cell--number">6</td>
            <td class="cell--number">6</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#459cf651f7c28d317777fe6ec7183db3b03f396f" class="src_link" title="spec/factories/brexit_checker/notification.rb">spec/factories/brexit_checker/notification.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">10</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#7578f4032cfcccef4e3c5cc0b39d69033f6c9e86" class="src_link" title="spec/factories/brexit_checker/option.rb">spec/factories/brexit_checker/option.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">8</td>
            <td class="cell--number">5</td>
            <td class="cell--number">5</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#37c3d293700e7d3fdcca23b2d3650018468278f1" class="src_link" title="spec/factories/brexit_checker/question.rb">spec/factories/brexit_checker/question.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">10</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#d5eadc82299a603364917d24e590404b1edd669a" class="src_link" title="spec/factories/content_item.rb">spec/factories/content_item.rb</a></td>
            <td class="red strong cell--number t-file__coverage">72.73 %</td>
            <td class="cell--number">29</td>
            <td class="cell--number">11</td>
            <td class="cell--number">8</td>
            <td class="cell--number">3</td>
            <td class="cell--number">0.73</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#95462c451e06925d7379622af48b47b2d4979350" class="src_link" title="spec/factories/date_facet.rb">spec/factories/date_facet.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">9</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#c4f6ab8f1d88e751985a27890271f1cbc2ffdf9e" class="src_link" title="spec/factories/document.rb">spec/factories/document.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">8</td>
            <td class="cell--number">5</td>
            <td class="cell--number">5</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.00</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#84456bc0cae9c93698b12b3efd769e40c9da9e1f" class="src_link" title="spec/factories/document_hash.rb">spec/factories/document_hash.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">83.33 %</td>
            <td class="cell--number">35</td>
            <td class="cell--number">24</td>
            <td class="cell--number">20</td>
            <td class="cell--number">4</td>
            <td class="cell--number">0.83</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#f39e19f5ceda445bdfc750206e69e0c8282ccde7" class="src_link" title="spec/factories/level_one_taxon_hash.rb">spec/factories/level_one_taxon_hash.rb</a></td>
            <td class="green strong cell--number t-file__coverage">95.45 %</td>
            <td class="cell--number">39</td>
            <td class="cell--number">22</td>
            <td class="cell--number">21</td>
            <td class="cell--number">1</td>
            <td class="cell--number">14.45</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#3850ebabc5640b9b7e0db3db5da9000245c5dbc2" class="src_link" title="spec/factories/option_select_facet.rb">spec/factories/option_select_facet.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">90.00 %</td>
            <td class="cell--number">14</td>
            <td class="cell--number">10</td>
            <td class="cell--number">9</td>
            <td class="cell--number">1</td>
            <td class="cell--number">0.90</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#a43ac0fc68f0b27577ede51e14342608328f7af4" class="src_link" title="spec/factories/root_taxon_hash.rb">spec/factories/root_taxon_hash.rb</a></td>
            <td class="green strong cell--number t-file__coverage">93.33 %</td>
            <td class="cell--number">24</td>
            <td class="cell--number">15</td>
            <td class="cell--number">14</td>
            <td class="cell--number">1</td>
            <td class="cell--number">11.53</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#a1fcb2a892314f6b63c98b71ebcc387cea491ca3" class="src_link" title="spec/factories/taxon_hash.rb">spec/factories/taxon_hash.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">19</td>
            <td class="cell--number">10</td>
            <td class="cell--number">10</td>
            <td class="cell--number">0</td>
            <td class="cell--number">26.70</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#d793e8ba25b49374422bb1303a44d600018fba96" class="src_link" title="spec/support/content_helper.rb">spec/support/content_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">29</td>
            <td class="cell--number">11</td>
            <td class="cell--number">11</td>
            <td class="cell--number">0</td>
            <td class="cell--number">4.45</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#dc81a60c7a3bc8c04f3a3dc5cbe2a2bb73f84da7" class="src_link" title="spec/support/fixtures_helper.rb">spec/support/fixtures_helper.rb</a></td>
            <td class="red strong cell--number t-file__coverage">57.58 %</td>
            <td class="cell--number">65</td>
            <td class="cell--number">33</td>
            <td class="cell--number">19</td>
            <td class="cell--number">14</td>
            <td class="cell--number">0.64</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#8164c81838b846708738775b9bbb13c3f9133c74" class="src_link" title="spec/support/registry_helper.rb">spec/support/registry_helper.rb</a></td>
            <td class="yellow strong cell--number t-file__coverage">81.82 %</td>
            <td class="cell--number">174</td>
            <td class="cell--number">11</td>
            <td class="cell--number">9</td>
            <td class="cell--number">2</td>
            <td class="cell--number">6.09</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#aea4d507fee70b8b56ba42da22b7b66811338744" class="src_link" title="spec/support/taxonomy_helper.rb">spec/support/taxonomy_helper.rb</a></td>
            <td class="green strong cell--number t-file__coverage">94.44 %</td>
            <td class="cell--number">31</td>
            <td class="cell--number">18</td>
            <td class="cell--number">17</td>
            <td class="cell--number">1</td>
            <td class="cell--number">20.28</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>


        
      </div>

      <div id="footer">
        Generated by <a href="https://github.com/simplecov-ruby/simplecov">simplecov</a> v0.19.0
        and simplecov-html v0.12.3<br/>
        using Cucumber Features
      </div>

      <div class="source_files">
      
        <div class="source_table" id="4749fe99cd8c558360e4b643bb7a414d88726dd3">
  <div class="header">
    <h3>app/controllers/application_controller.rb</h3>
    <h4>
      <span class="red">
  73.21%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>56</b> relevant lines.
      <span class="green"><b>41</b> lines covered</span> and
      <span class="red"><b>15</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class ApplicationController &lt; ActionController::Base</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include Slimmer::Headers</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include Slimmer::Template</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  slimmer_template &quot;header_footer_only&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  # Prevent CSRF attacks by raising an exception.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  # For APIs, you may want to use :null_session instead.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  protect_from_forgery with: :exception</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  helper :application</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  after_action :skip_session_cookie</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  # rescue_from precedence is bottom up - https://stackoverflow.com/a/9121054/170864</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  unless Rails.env.development?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    rescue_from GdsApi::BaseError, with: :error_503</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">    rescue_from GdsApi::InvalidUrl, with: :unprocessable_entity</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">    rescue_from GdsApi::HTTPNotFound, with: :error_not_found</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">    rescue_from GdsApi::HTTPForbidden, with: :forbidden</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">    rescue_from GdsApi::HTTPUnprocessableEntity, with: :unprocessable_entity</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  if ENV[&quot;REQUIRE_BASIC_AUTH&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">    http_basic_authenticate_with(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">      name: ENV.fetch(&quot;BASIC_AUTH_USERNAME&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">      password: ENV.fetch(&quot;BASIC_AUTH_PASSWORD&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def skip_session_cookie</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="59" data-linenumber="32">
            <span class="hits">59</span>
            

            

            <code class="ruby">    unless session[:has_session]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="59" data-linenumber="33">
            <span class="hits">59</span>
            

            

            <code class="ruby">      request.session_options[:drop] = true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def logout!</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="38">
            
            

            

            <code class="ruby">    session.delete(:sub)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            
            

            

            <code class="ruby">    session.delete(:access_token)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="40">
            
            

            

            <code class="ruby">    session.delete(:refresh_token)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def error_503(exception)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="44">
            
            

            

            <code class="ruby">    error(503, exception)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def error(status_code, exception = nil)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="48">
            
            

            

            <code class="ruby">    if exception</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="49">
            
            

            

            <code class="ruby">      GovukError.notify(exception)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="52">
            
            

            

            <code class="ruby">    render status: status_code, plain: &quot;#{status_code} error&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def finder_base_path</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="56">
            <span class="hits">56</span>
            

            

            <code class="ruby">    &quot;/#{finder_slug}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="59">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def finder_slug</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="60">
            <span class="hits">56</span>
            

            

            <code class="ruby">    params[:slug]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def error_not_found</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="64">
            
            

            

            <code class="ruby">    render status: :not_found, plain: &quot;404 error not found&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="67">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def forbidden</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="68">
            
            

            

            <code class="ruby">    render status: :forbidden, plain: &quot;403 forbidden&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="71">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def unprocessable_entity</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="72">
            <span class="hits">1</span>
            

            

            <code class="ruby">    render status: :unprocessable_entity, plain: &quot;422 error: unprocessable entity&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="75">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filter_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">    # TODO: Use a whitelist based on the facets in the schema</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="608" data-linenumber="77">
            <span class="hits">608</span>
            

            

            <code class="ruby">    @filter_params ||= begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="78">
            <span class="hits">60</span>
            

            

            <code class="ruby">      permitted_params = params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">                           .except(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">                             :controller,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">                             :action,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby">                             :slug,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby">                             :format,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">                           )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">      # Convert a query with &#39;q=search_term&#39; into &#39;keywords=search_term&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="87">
            <span class="hits">60</span>
            

            

            <code class="ruby">      if permitted_params.key?(&quot;q&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="88">
            <span class="hits">1</span>
            

            

            <code class="ruby">        permitted_params[&quot;keywords&quot;] = permitted_params.delete(&quot;q&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="91">
            <span class="hits">60</span>
            

            

            <code class="ruby">      ParamsCleaner.new(permitted_params).cleaned</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="95">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def check_accounts_enabled</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="96">
            
            

            

            <code class="ruby">    unless accounts_enabled?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="97">
            
            

            

            <code class="ruby">      render file: Rails.root.join(Rails.root, &quot;public/404.html&quot;), status: :not_found</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="101">
            <span class="hits">1</span>
            

            

            <code class="ruby">  helper_method :accounts_enabled?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="102">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def accounts_enabled?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="103">
            
            

            

            <code class="ruby">    Rails.configuration.feature_flag_govuk_accounts</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="106">
            <span class="hits">1</span>
            

            

            <code class="ruby">  helper_method :logged_in?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="107">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def logged_in?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="108">
            
            

            

            <code class="ruby">    current_user.present? &amp;&amp; session[:has_session]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="109">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="111">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def current_user</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="112">
            
            

            

            <code class="ruby">    session[:sub]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="113">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="114">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="01f231d0f51b0a260a6639a4819731b0339d844e">
  <div class="header">
    <h3>app/controllers/concerns/finder_top_result_ab_testable.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>10</b> relevant lines.
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module FinderTopResultAbTestable</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  CUSTOM_DIMENSION = 69</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.included(base)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    base.helper_method(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">      :finder_top_result_variant,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">      :show_top_result?,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def finder_top_result_test</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="12">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @finder_top_result_test ||= GovukAbTesting::AbTest.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">      &quot;FinderAnswerABTest&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">      dimension: CUSTOM_DIMENSION,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">      allowed_variants: %w[A B],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">      control_variant: &quot;A&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def finder_top_result_variant</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="21">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @finder_top_result_variant ||= finder_top_result_test.requested_variant(request.headers)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def show_top_result?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="25">
            <span class="hits">54</span>
            

            

            <code class="ruby">    finder_top_result_variant.variant?(&quot;B&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="444f4a8d4793152287477027622184223a192a78">
  <div class="header">
    <h3>app/controllers/email_alert_subscriptions_controller.rb</h3>
    <h4>
      <span class="yellow">
  82.35%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>34</b> relevant lines.
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class EmailAlertSubscriptionsController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  layout &quot;finder_layout&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  protect_from_forgery except: :create</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  before_action :signup_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">  helper_method :subscriber_list_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def create</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="8">
            <span class="hits">2</span>
            

            

            <code class="ruby">    validate_choices!</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            
            

            

            <code class="ruby">    redirect_to email_alert_signup_api.signup_url</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">  rescue MissingFiltersError</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="11">
            <span class="hits">2</span>
            

            

            <code class="ruby">    render_error &quot;Please choose an email alert&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">  rescue UnprocessableFilterAlertParamsError</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="13">
            
            

            

            <code class="ruby">    render_error &quot;There was a problem with your chosen filters. Please try again.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">  rescue EmailAlertSignupAPI::UnprocessableSubscriberListError</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="15">
            
            

            

            <code class="ruby">    render_error(&quot;An error occurred. Please check your filters and try again.&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class MissingFiltersError &lt; StandardError; end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class UnprocessableFilterAlertParamsError &lt; StandardError; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def render_error(error_message)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="24">
            <span class="hits">2</span>
            

            

            <code class="ruby">    @error_message = error_message</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="25">
            <span class="hits">2</span>
            

            

            <code class="ruby">    render action: :new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="29">
            <span class="hits">10</span>
            

            

            <code class="ruby">    @content ||= ContentItem.from_content_store(request.path).as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def signup_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="33">
            <span class="hits">4</span>
            

            

            <code class="ruby">    @signup_presenter ||= SignupPresenter.new(content, params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def subscriber_list_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="37">
            <span class="hits">4</span>
            

            

            <code class="ruby">    SubscriberListParamsPresenter.new(content, filter_params).subscriber_list_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def email_alert_filter_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="41">
            <span class="hits">4</span>
            

            

            <code class="ruby">    @email_alert_filter_params ||= ParameterParser::EmailAlertParameterParser.new(content, filter_params, params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def validate_choices!</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="45">
            <span class="hits">2</span>
            

            

            <code class="ruby">    raise UnprocessableFilterAlertParamsError unless email_alert_filter_params.valid?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="46">
            <span class="hits">2</span>
            

            

            <code class="ruby">    raise MissingFiltersError unless email_alert_filter_params.required_facets_selected?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def applied_filters</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="50">
            
            

            

            <code class="ruby">    @applied_filters ||= email_alert_filter_params.applied_filters</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def email_alert_signup_api</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="54">
            
            

            

            <code class="ruby">    EmailAlertSignupAPI.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">      applied_filters: applied_filters,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">      default_filters: content[&quot;details&quot;].fetch(&quot;filter&quot;, {}),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">      facets: content[&quot;details&quot;].fetch(&quot;email_filter_facets&quot;, []),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">      subscriber_list_title: subscriber_list_title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="62">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def subscriber_list_title</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="63">
            
            

            

            <code class="ruby">    EmailAlertTitleBuilder.call(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">      filter: applied_filters,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">      subscription_list_title_prefix: content.dig(&quot;details&quot;, &quot;subscription_list_title_prefix&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">      facets: content[&quot;details&quot;].fetch(&quot;email_filter_facets&quot;, []),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="65ac3c5eb8fe46d65557ebf10d366b6a54cfc204">
  <div class="header">
    <h3>app/controllers/finders_controller.rb</h3>
    <h4>
      <span class="yellow">
  84.78%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>92</b> relevant lines.
      <span class="green"><b>78</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class FindersController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include FinderTopResultAbTestable</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  layout &quot;finder_layout&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">  before_action :remove_search_box</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  before_action do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="8">
            <span class="hits">56</span>
            

            

            <code class="ruby">    expires_in(5.minutes, public: true)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  ATOM_FEED_MAX_AGE = 300</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def show</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="13">
            <span class="hits">56</span>
            

            

            <code class="ruby">    respond_to do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="14">
            <span class="hits">56</span>
            

            

            <code class="ruby">      format.html do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="15">
            <span class="hits">55</span>
            

            

            <code class="ruby">        raise UnsupportedContentItem unless content_item.is_finder?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="17">
            <span class="hits">55</span>
            

            

            <code class="ruby">        show_page_variables</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="19">
            <span class="hits">56</span>
            

            

            <code class="ruby">      format.json do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="20">
            
            

            

            <code class="ruby">        @search_query = initialize_search_query</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="21">
            
            

            

            <code class="ruby">        if content_item.is_search? || content_item.is_finder?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">          @spelling_suggestion_presenter = spelling_suggestion_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">          render json: json_response</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">        else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            
            

            

            <code class="ruby">          render json: {}, status: :not_found</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="28">
            <span class="hits">56</span>
            

            

            <code class="ruby">      format.atom do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">        if content_item.is_redirect?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            
            

            

            <code class="ruby">          redirect_to_destination</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">        else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">          @search_query = initialize_search_query(is_for_feed: true)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">          expires_in(ATOM_FEED_MAX_AGE, public: true)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">          @feed = AtomPresenter.new(content_item, results, facet_tags)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  rescue ActionController::UnknownFormat</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            
            

            

            <code class="ruby">    render plain: &quot;Not acceptable&quot;, status: :not_acceptable</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">  rescue UnsupportedContentItem</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="41">
            
            

            

            <code class="ruby">    render plain: &quot;Not found&quot;, status: :not_found</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def show_page_variables</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="45">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @search_query = initialize_search_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="46">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @breadcrumbs = fetch_breadcrumbs</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="47">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @parent = parent</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="48">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @sort_presenter = sort_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="49">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @pagination = pagination_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="50">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @spelling_suggestion_presenter = spelling_suggestion_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class UnsupportedContentItem &lt; StandardError; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :search_query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="59">
            <span class="hits">1</span>
            

            

            <code class="ruby">  helper_method :facet_tags, :i_am_a_topic_page_finder, :result_set_presenter, :content_item, :signup_links, :filter_params, :facets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="61">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def redirect_to_destination</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="62">
            
            

            

            <code class="ruby">    @redirect = content_item.redirect</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="63">
            
            

            

            <code class="ruby">    @finder_slug = finder_slug</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="64">
            
            

            

            <code class="ruby">    render &quot;finders/show_redirect&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="67">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def json_response</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="69">
            
            

            

            <code class="ruby">      total: result_set_presenter.total_count,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">      display_total: result_set_presenter.displayed_total,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">      facet_tags: render_component(&quot;facet_tags&quot;, facet_tags.present),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby">      search_results: render_component(&quot;finders/search_results&quot;, result_set_presenter.search_results_content),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            
            

            

            <code class="ruby">      display_selected_facets_count: facet_tags.display_total_selected_filters,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby">      sort_options_markup: render_component(&quot;finders/sort_options&quot;, sort_presenter.to_hash),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">      next_and_prev_links: render_component(&quot;govuk_publishing_components/components/previous_and_next_navigation&quot;, pagination_presenter.next_and_prev_links),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">      suggestions: render_component(&quot;finders/spelling_suggestion&quot;, suggestions: spelling_suggestion_presenter.suggestions),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">      errors: search_query.errors_hash,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="81">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def render_component(partial, locals)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="82">
            
            

            

            <code class="ruby">    (render_to_string(formats: %w[html], partial: partial, locals: locals) || &quot;&quot;).squish</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="85">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1757" data-linenumber="86">
            <span class="hits">1757</span>
            

            

            <code class="ruby">    @content_item ||= ContentItem.from_content_store(finder_base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="89">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def result_set_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="637" data-linenumber="90">
            <span class="hits">637</span>
            

            

            <code class="ruby">    @result_set_presenter ||= ResultSetPresenter.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby">      content_item,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">      facets,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">      results,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">      filter_params,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">      sort_presenter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby">      content_item.metadata_class,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">      show_top_result?,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">      debug_score?,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="102">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="103">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @results ||= ResultSetParser.parse(search_results)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="106">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="323" data-linenumber="107">
            <span class="hits">323</span>
            

            

            <code class="ruby">    @facets ||= FacetsBuilder.new(content_item: content_item, search_results: search_results, value_hash: filter_params).facets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="108">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="109">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="110">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def signup_links</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="162" data-linenumber="111">
            <span class="hits">162</span>
            

            

            <code class="ruby">    @signup_links ||= SignupLinksPresenter.new(content_item, facets, keywords).signup_links</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="113">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="114">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize_search_query(is_for_feed: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="115">
            <span class="hits">56</span>
            

            

            <code class="ruby">    Search::Query.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            
            

            

            <code class="ruby">      content_item,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="117">
            
            

            

            <code class="ruby">      filter_params,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="118">
            
            

            

            <code class="ruby">      override_sort_for_feed: is_for_feed,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="119">
            
            

            

            <code class="ruby">      ab_params: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="120">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="121">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="122">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="123">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_item_with_search_results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="124">
            
            

            

            <code class="ruby">    @content_item_with_search_results ||= search_query.content_item_with_search_results</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="125">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="126">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="127">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def fetch_breadcrumbs</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="128">
            <span class="hits">55</span>
            

            

            <code class="ruby">    parent_slug = params[&quot;parent&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="129">
            <span class="hits">55</span>
            

            

            <code class="ruby">    org_info = organisation_registry[parent_slug] if parent_slug.present?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="130">
            <span class="hits">55</span>
            

            

            <code class="ruby">    FinderBreadcrumbsPresenter.new(org_info, content_item)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="131">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="132">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="133">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sort_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="164" data-linenumber="134">
            <span class="hits">164</span>
            

            

            <code class="ruby">    @sort_presenter ||= content_item.sorter_class.new(content_item, filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="135">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="136">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="137">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def pagination_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="138">
            <span class="hits">55</span>
            

            

            <code class="ruby">    PaginationPresenter.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="139">
            
            

            

            <code class="ruby">      per_page: content_item.default_documents_per_page,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="140">
            
            

            

            <code class="ruby">      start_offset: search_results.dig(&quot;start&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="141">
            
            

            

            <code class="ruby">      total_results: search_results.dig(&quot;total&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="142">
            
            

            

            <code class="ruby">      url_builder: finder_url_builder,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="143">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="144">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="145">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="146">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def search_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="273" data-linenumber="147">
            <span class="hits">273</span>
            

            

            <code class="ruby">    search_query.search_results</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="148">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="149">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="150">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def spelling_suggestion_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="151">
            <span class="hits">54</span>
            

            

            <code class="ruby">    suggested_queries = search_results.fetch(&quot;suggested_queries&quot;, [])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="152">
            <span class="hits">54</span>
            

            

            <code class="ruby">    SpellingSuggestionPresenter.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="153">
            
            

            

            <code class="ruby">      suggested_queries,</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="154">
            <span class="hits">54</span>
            

            

            <code class="ruby">      finder_url_builder.url(keywords: (suggested_queries.first || {}).dig(&quot;text&quot;)),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="155">
            
            

            

            <code class="ruby">      # Search api is set to always return an array with one item</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="156">
            
            

            

            <code class="ruby">      content_item.as_hash[&quot;base_path&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="157">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="158">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="159">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="160">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def finder_url_builder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="108" data-linenumber="161">
            <span class="hits">108</span>
            

            

            <code class="ruby">    UrlBuilder.new(content_item.base_path, filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="162">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="163">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="164">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def parent</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="165">
            <span class="hits">55</span>
            

            

            <code class="ruby">    params.fetch(:parent, &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="166">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="167">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="168">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def keywords</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="169">
            <span class="hits">54</span>
            

            

            <code class="ruby">    filter_params[&quot;keywords&quot;].presence</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="170">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="171">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="172">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facet_tags</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="161" data-linenumber="173">
            <span class="hits">161</span>
            

            

            <code class="ruby">    @facet_tags ||= FacetTagsPresenter.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="174">
            
            

            

            <code class="ruby">      facets.select(&amp;:filterable?),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="175">
            
            

            

            <code class="ruby">      sort_presenter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="176">
            
            

            

            <code class="ruby">      i_am_a_topic_page_finder: i_am_a_topic_page_finder,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="177">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="178">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="179">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="180">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def remove_search_box</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="181">
            <span class="hits">56</span>
            

            

            <code class="ruby">    hide_site_serch = params[&quot;slug&quot;] == &quot;search/all&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="182">
            <span class="hits">56</span>
            

            

            <code class="ruby">    set_slimmer_headers(remove_search: hide_site_serch)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="183">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="184">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="185">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def i_am_a_topic_page_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="79" data-linenumber="186">
            <span class="hits">79</span>
            

            

            <code class="ruby">    @i_am_a_topic_page_finder ||= taxonomy_registry.taxonomy.key? params[:topic]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="187">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="188">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="189">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def taxonomy_registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="78" data-linenumber="190">
            <span class="hits">78</span>
            

            

            <code class="ruby">    Services.registries.all[&quot;full_topic_taxonomy&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="191">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="192">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="193">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def organisation_registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="194">
            <span class="hits">3</span>
            

            

            <code class="ruby">    Services.registries.all[&quot;organisations&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="195">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="196">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="197">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def debug_score?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="198">
            <span class="hits">54</span>
            

            

            <code class="ruby">    params[:debug_score]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="199">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="200">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="dff0f55e1a82512d96da32c1361438bbd2b70ad1">
  <div class="header">
    <h3>app/controllers/redirection_controller.rb</h3>
    <h4>
      <span class="red">
  29.41%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>17</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class RedirectionController &lt; ApplicationController</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def redirect_covid</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="3">
            
            

            

            <code class="ruby">    redirect_to(finder_path(params[:slug], params: covid_topic_and_other_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def advanced_search</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">    conversion_hash =</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            
            

            

            <code class="ruby">        &quot;services&quot; =&gt; &quot;services&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">        &quot;guidance_and_regulation&quot; =&gt; &quot;guidance-and-regulation&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">        &quot;news_and_communications&quot; =&gt; &quot;news-and-communications&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">        &quot;research_and_statistics&quot; =&gt; &quot;research-and-statistics&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">        &quot;policy_and_engagement&quot; =&gt; &quot;policy-papers-and-consultations&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">        &quot;transparency&quot; =&gt; &quot;transparency-and-freedom-of-information-releases&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">    group = conversion_hash[params[&quot;group&quot;]]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="17">
            
            

            

            <code class="ruby">    error_not_found &amp;&amp; return if group.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="19">
            
            

            

            <code class="ruby">    topic = params[&quot;topic&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="20">
            
            

            

            <code class="ruby">    url_params = if topic.present?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="21">
            
            

            

            <code class="ruby">                   registry = Services.registries.all[&quot;full_topic_taxonomy&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">                   content_id, = registry.taxonomy.find { |_, hash| hash[&quot;base_path&quot;] == topic }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">                   { topic: content_id }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">                 else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            
            

            

            <code class="ruby">                   {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">                 end</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="27">
            
            

            

            <code class="ruby">    redirect_to(finder_path(&quot;search/#{group}&quot;, params: url_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def covid_topic_and_other_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            
            

            

            <code class="ruby">      keywords: filter_params[&quot;keywords&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">      level_one_taxon: &quot;5b7b9532-a775-4bd2-a3aa-6ce380184b6c&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      organisations: filter_params[&quot;organisations&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">      people: filter_params[&quot;people&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">      public_timestamp: filter_params[&quot;public_timestamp&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">      roles: filter_params[&quot;roles&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">      world_locations: filter_params[&quot;world_locations&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">    }.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f8f6bffa205f389d3f70bd66d66b0fc39b419781">
  <div class="header">
    <h3>app/helpers/application_helper.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>3</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module ApplicationHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def absolute_url_for(path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="3">
            <span class="hits">3</span>
            

            

            <code class="ruby">    URI.join(Plek.current.website_root, path)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="8c41a2e3b8e0bd4fbfe4f2967966a37302de7733">
  <div class="header">
    <h3>app/helpers/brexit_checker_helper.rb</h3>
    <h4>
      <span class="red">
  30.77%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>52</b> relevant lines.
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>36</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;addressable/uri&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">module BrexitCheckerHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def encoded_results_url</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="5">
            
            

            

            <code class="ruby">    CGI.escape(request.original_url)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filter_actions(actions, criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            
            

            

            <code class="ruby">    filtered = actions.select { |a| a.show?(criteria_keys) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="10">
            
            

            

            <code class="ruby">    sorted_actions(filtered)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sorted_actions(actions)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="14">
            
            

            

            <code class="ruby">    descending = -1</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="15">
            
            

            

            <code class="ruby">    actions.sort_by { |action| [(action.priority * descending), action.title] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def persistent_criteria_keys(question_criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="19">
            
            

            

            <code class="ruby">    criteria_keys - question_criteria_keys</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def format_question_options(options, criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">    options.map { |o| format_question_option(o, criteria_keys) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def format_question_option(option, criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="27">
            
            

            

            <code class="ruby">    checked = criteria_keys.include?(option.value)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="29">
            
            

            

            <code class="ruby">    { label: option.label,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">      text: option.label,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">      value: option.value,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">      checked: checked,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">      hint_text: option.hint_text }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def next_question_index(all_questions:, criteria_keys: [], previous_question_index: 0)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="37">
            
            

            

            <code class="ruby">    available_questions = all_questions[previous_question_index..] || []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            
            

            

            <code class="ruby">    relative_next_question_index = available_questions.find_index { |question| question.show?(criteria_keys) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="40">
            
            

            

            <code class="ruby">    relative_next_question_index ? previous_question_index + relative_next_question_index : nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def previous_question_index(all_questions:, criteria_keys: [], current_question_index: 0)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="44">
            
            

            

            <code class="ruby">    previous_questions = all_questions[0...current_question_index]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="45">
            
            

            

            <code class="ruby">    previous_questions.rindex { |question| question.show?(criteria_keys) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def notification_email_link(non_tracked_url, notification)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="49">
            
            

            

            <code class="ruby">    url = Addressable::URI.parse(non_tracked_url)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="50">
            
            

            

            <code class="ruby">    return non_tracked_url unless url.host == &quot;www.gov.uk&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="52">
            
            

            

            <code class="ruby">    url.query_values = (url.query_values || {}).merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">      utm_source: notification.id,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">      utm_medium: &quot;email&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">      utm_campaign: &quot;govuk-brexit-checker&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="58">
            
            

            

            <code class="ruby">    url.to_s</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="61">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def brexit_results_email_link_label(actions)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="62">
            
            

            

            <code class="ruby">    if actions.any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="63">
            
            

            

            <code class="ruby">      t(&quot;brexit_checker.results.email_sign_up_link&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="65">
            
            

            

            <code class="ruby">      t(&quot;brexit_checker.results.email_sign_up_link_no_actions&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="69">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def brexit_results_title(actions, criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="70">
            
            

            

            <code class="ruby">    if actions.any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="71">
            
            

            

            <code class="ruby">      t(&quot;brexit_checker.results.title&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="72">
            
            

            

            <code class="ruby">    elsif criteria_keys.any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="73">
            
            

            

            <code class="ruby">      t(&quot;brexit_checker.results.title_no_actions&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="75">
            
            

            

            <code class="ruby">      t(&quot;brexit_checker.results.title_no_answers&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="79">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def brexit_results_description(actions, criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="80">
            
            

            

            <code class="ruby">    if actions.any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="81">
            
            

            

            <code class="ruby">      t(&quot;brexit_checker.results.description&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="82">
            
            

            

            <code class="ruby">    elsif criteria_keys.present?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="83">
            
            

            

            <code class="ruby">      t(&quot;brexit_checker.results.description_no_actions&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="85">
            
            

            

            <code class="ruby">      t(&quot;brexit_checker.results.description_no_answers&quot;).html_safe</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="89">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def account_signup_jwt(criteria_keys, subscriber_list_slug)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="90">
            
            

            

            <code class="ruby">    account_jwt = BrexitChecker::AccountJwt.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby">      criteria_keys: criteria_keys,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">      subscriber_list_slug: subscriber_list_slug,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">      post_register_uri: Services.oidc.auth_uri(redirect_path: transition_checker_saved_results_path)[:uri],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">      post_login_uri: Services.oidc.auth_uri(redirect_path: transition_checker_save_results_confirm_path(c: criteria_keys))[:uri],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="96">
            
            

            

            <code class="ruby">    account_jwt.encode</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="99">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def path_based_on_account_feature_flag</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="100">
            
            

            

            <code class="ruby">    if Rails.configuration.feature_flag_govuk_accounts</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="101">
            
            

            

            <code class="ruby">      transition_checker_save_results_path(c: criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="103">
            
            

            

            <code class="ruby">      transition_checker_email_signup_path(c: criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f2b75c58a25c445f4c06888d615f377b19f607a6">
  <div class="header">
    <h3>app/helpers/page_metadata_helper.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>7</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module PageMetadataHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def page_metadata(content_item, filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="3">
            <span class="hits">54</span>
            

            

            <code class="ruby">    organisation_links = content_item.organisations.map do |organisation|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="29" data-linenumber="4">
            <span class="hits">29</span>
            

            

            <code class="ruby">      link_to(organisation[&quot;title&quot;], organisation[&quot;web_url&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="7">
            <span class="hits">54</span>
            

            

            <code class="ruby">    {}.tap do |metadata|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="8">
            <span class="hits">54</span>
            

            

            <code class="ruby">      metadata[:from] = organisation_links if organisation_links.present?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="9">
            <span class="hits">54</span>
            

            

            <code class="ruby">      metadata[:inverse] = true if topic_finder?(filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="87e7c707bec76e77a7cd7fe50c592b012d9ac1db">
  <div class="header">
    <h3>app/helpers/title_context_helper.rb</h3>
    <h4>
      <span class="red">
  75.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>8</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module TitleContextHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def title_context(filter_params = nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="51" data-linenumber="3">
            <span class="hits">51</span>
            

            

            <code class="ruby">    filter_params ||= params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="51" data-linenumber="5">
            <span class="hits">51</span>
            

            

            <code class="ruby">    topical_events = filter_params[&quot;topical_events&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="51" data-linenumber="6">
            <span class="hits">51</span>
            

            

            <code class="ruby">    topical_events = [topical_events] if topical_events.is_a? String</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="51" data-linenumber="8">
            <span class="hits">51</span>
            

            

            <code class="ruby">    if topical_events &amp;&amp; topical_events.count == 1</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            
            

            

            <code class="ruby">      registry = Services.registries.all[&quot;full_topical_events&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="10">
            
            

            

            <code class="ruby">      (registry[topical_events.first] || {})[&quot;title&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2337228df133259f6429960db81aecd933fb276a">
  <div class="header">
    <h3>app/helpers/topic_finder_helper.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>5</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module TopicFinderHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def topic_finder?(filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="215" data-linenumber="3">
            <span class="hits">215</span>
            

            

            <code class="ruby">    filter_params.include?(&quot;topic&quot;) &amp;&amp; topic_finder_parent(filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def topic_finder_parent(filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="7">
            <span class="hits">16</span>
            

            

            <code class="ruby">    Services.registries.all[&quot;full_topic_taxonomy&quot;][filter_params[&quot;topic&quot;]]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ebcd738ff91561578e27b00548832484fbac8821">
  <div class="header">
    <h3>app/lib/brexit_checker/action.rb</h3>
    <h4>
      <span class="red">
  54.55%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>44</b> relevant lines.
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>20</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;addressable/uri&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">class BrexitChecker::Action</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActiveModel::Validations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  CONFIG_PATH = Rails.root.join(&quot;app/lib/brexit_checker/actions.yaml&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_presence_of :id, :title, :consequence, :criteria</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_inclusion_of :audience, in: %w[business citizen]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_presence_of :guidance_link_text, if: :guidance_url</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_numericality_of :priority, only_integer: true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validate :has_criteria</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validate :citizen_action_has_grouping_criteria</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :id,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">              :title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">              :consequence,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">              :exception,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">              :title_url,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">              :title_path,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">              :lead_time,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">              :criteria,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">              :audience,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">              :guidance_link_text,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">              :guidance_url,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">              :guidance_path,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">              :guidance_prompt,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">              :priority,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">              :grouping_criteria</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(attrs)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">    attrs.each { |key, value| instance_variable_set(&quot;@#{key}&quot;, value) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="33">
            
            

            

            <code class="ruby">    @title_path = path_from_url(title_url) if title_url</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            
            

            

            <code class="ruby">    @guidance_path = path_from_url(guidance_url) if guidance_url</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="35">
            
            

            

            <code class="ruby">    validate!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def show?(selected_criteria)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            
            

            

            <code class="ruby">    BrexitChecker::Criteria::Evaluator.evaluate(criteria, selected_criteria)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.find_by_id(id)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="43">
            
            

            

            <code class="ruby">    load_all.find { |a| a.id == id }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load_all</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="47">
            
            

            

            <code class="ruby">    @load_all = nil if Rails.env.development?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="48">
            
            

            

            <code class="ruby">    @load_all ||= YAML.load_file(CONFIG_PATH)[&quot;actions&quot;].map { |a| new(a) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="51">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_criteria</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="52">
            
            

            

            <code class="ruby">    BrexitChecker::Criterion.load_by(all_criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_criteria_keys</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="56">
            
            

            

            <code class="ruby">    BrexitChecker::Criteria::Extractor.extract(criteria)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="59">
            <span class="hits">1</span>
            

            

            <code class="ruby">  delegate :hash, to: :id</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="61">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def eql?(other)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="62">
            
            

            

            <code class="ruby">    id == other.id</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="65">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def multiple_grouping_criteria?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="66">
            
            

            

            <code class="ruby">    grouping_criteria.count &gt; 1</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="69">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="71">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_criteria</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="72">
            
            

            

            <code class="ruby">    return unless all_criteria_keys.none?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="74">
            
            

            

            <code class="ruby">    errors.add &quot;Action must have at least one criterion&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="77">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def path_from_url(full_url)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="78">
            
            

            

            <code class="ruby">    url = Addressable::URI.parse(full_url)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="79">
            
            

            

            <code class="ruby">    if url.host == &quot;www.gov.uk&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="80">
            
            

            

            <code class="ruby">      url.path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="82">
            
            

            

            <code class="ruby">      full_url</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="86">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def citizen_action_has_grouping_criteria</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="87">
            
            

            

            <code class="ruby">    if audience == &quot;citizen&quot; &amp;&amp; grouping_criteria.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="88">
            
            

            

            <code class="ruby">      errors.add(:grouping_criteria, &quot;Can&#39;t be empty for citizen actions&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="b08459bab54cfa620e4e98909174d8c5a63ef097">
  <div class="header">
    <h3>app/lib/brexit_checker/criterion.rb</h3>
    <h4>
      <span class="red">
  62.5%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>16</b> relevant lines.
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class BrexitChecker::Criterion</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActiveModel::Validations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  CONFIG_PATH = Rails.root.join(&quot;app/lib/brexit_checker/criteria.yaml&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_presence_of :key, :text</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :key, :text</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(attrs)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">    attrs.each { |key, value| instance_variable_set(&quot;@#{key}&quot;, value) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            
            

            

            <code class="ruby">    validate!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  delegate :hash, to: :key</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">  # Overwriting functionality of eql? so we can call uniq on an criteria array</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def eql?(other)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="19">
            
            

            

            <code class="ruby">    key == other.key</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load_all</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">    @load_all = nil if Rails.env.development?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="24">
            
            

            

            <code class="ruby">    @load_all ||= YAML.load_file(CONFIG_PATH)[&quot;criteria&quot;].map { |c| new(c) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load_by(criteria_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="28">
            
            

            

            <code class="ruby">    load_all.select { |c| criteria_keys.include?(c.key) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="b88bcd4e68e5d53487b63411388c45d1f418b974">
  <div class="header">
    <h3>app/lib/brexit_checker/group.rb</h3>
    <h4>
      <span class="red">
  61.11%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>18</b> relevant lines.
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class BrexitChecker::Group</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActiveModel::Validations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  GROUPS_PATH = Rails.root.join(&quot;app/lib/brexit_checker/groups.yaml&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_inclusion_of :key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">                         in: %w[visiting-eu</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">                                visiting-uk</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">                                visiting-ie</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">                                living-eu</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">                                living-ie</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">                                living-uk</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">                                working-uk</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">                                studying-eu</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">                                studying-uk</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">                                common-travel-area]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :key, :heading, :priority</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(attrs)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="21">
            
            

            

            <code class="ruby">    attrs.each { |key, value| instance_variable_set(&quot;@#{key}&quot;, value) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">    validate!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load_all</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">    @load_all = nil if Rails.env.development?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="27">
            
            

            

            <code class="ruby">    @load_all ||= YAML.load_file(GROUPS_PATH)[&quot;groups&quot;].map { |a| new(a) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.find_by(key)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="31">
            
            

            

            <code class="ruby">    load_all.detect { |group| group.key == key }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">  delegate :hash, to: :key</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def eql?(other)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="37">
            
            

            

            <code class="ruby">    key == other.key</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def actions</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="41">
            
            

            

            <code class="ruby">    BrexitChecker::Action.load_all.select { |action| action.grouping_criteria&amp;.include?(key) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="76d35338a9bb3ae1fd3936a3b62b49e429a36ed3">
  <div class="header">
    <h3>app/lib/brexit_checker/notification.rb</h3>
    <h4>
      <span class="red">
  58.33%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>24</b> relevant lines.
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class BrexitChecker::Notification</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActiveModel::Validations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  CONFIG_PATH = Rails.root.join(&quot;app/lib/brexit_checker/notifications.yaml&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_presence_of :action_id</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_inclusion_of :type, in: %w[addition content_change]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_format_of :date, with: /\d{4}-\d{2}-\d{2}/</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_presence_of :note, if: -&gt; { type == &quot;content_change&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_length_of :id, is: SecureRandom.uuid.length, message: &quot;ID not a UUID&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :id, :action_id, :type, :note, :date, :criteria</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(attrs)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="15">
            
            

            

            <code class="ruby">    attrs.each { |key, value| instance_variable_set(&quot;@#{key}&quot;, value) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">    validate!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def action</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="20">
            
            

            

            <code class="ruby">    BrexitChecker::Action.find_by_id(action_id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load(params)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="24">
            
            

            

            <code class="ruby">    parsed_params = params.dup</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            
            

            

            <code class="ruby">    parsed_params[&quot;id&quot;] = params[&quot;uuid&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">    parsed_params[&quot;date&quot;] = params[&quot;date&quot;].to_s</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="27">
            
            

            

            <code class="ruby">    new(parsed_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load_all</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="31">
            
            

            

            <code class="ruby">    @load_all ||= YAML.load_file(CONFIG_PATH)[&quot;notifications&quot;].to_a</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">      .map { |c| load(c) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.find_by_id(id)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="36">
            
            

            

            <code class="ruby">    load_all.find { |c| c.id == id }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="1bcb1d680a07c2de7b4d9bbf9d4dc22b710af55c">
  <div class="header">
    <h3>app/lib/brexit_checker/question.rb</h3>
    <h4>
      <span class="red">
  51.52%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>33</b> relevant lines.
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>16</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class BrexitChecker::Question</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActiveModel::Validations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  CONFIG_PATH = Rails.root.join(&quot;app/lib/brexit_checker/questions.yaml&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_presence_of :key, :text</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_inclusion_of :type, in: %w[single single_wrapped multiple multiple_grouped]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validate { errors.add(&quot;Options is not an array&quot;) unless options.is_a? Array }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">              :text,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">              :description,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">              :hint_title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">              :hint_text,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">              :type,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">              :criteria,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">              :detail_text,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">              :detail_title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">              :caption</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(attrs)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">    attrs.each { |key, value| instance_variable_set(&quot;@#{key}&quot;, value) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">    validate!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def options(criteria_keys = nil)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="27">
            
            

            

            <code class="ruby">    return @options if criteria_keys.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="29">
            
            

            

            <code class="ruby">    @options.reject { |option| criteria_keys.include?(option.exclude_if) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def multiple?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="33">
            
            

            

            <code class="ruby">    type == &quot;multiple&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def multiple_grouped?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="37">
            
            

            

            <code class="ruby">    type == &quot;multiple_grouped&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def single_wrapped?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="41">
            
            

            

            <code class="ruby">    type == &quot;single_wrapped&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.find_by_key(key)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="45">
            
            

            

            <code class="ruby">    load_all.find { |q| q.key == key }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def show?(selected_criteria)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="49">
            
            

            

            <code class="ruby">    BrexitChecker::Criteria::Evaluator.evaluate(criteria, selected_criteria)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="52">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_values</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="53">
            
            

            

            <code class="ruby">    sub_options = options.flat_map(&amp;:sub_options)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="54">
            
            

            

            <code class="ruby">    (options + sub_options).map(&amp;:value).compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load(params)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="58">
            
            

            

            <code class="ruby">    parsed_params = params.dup</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="59">
            
            

            

            <code class="ruby">    parsed_params[&quot;options&quot;] = Option.load_all(params[&quot;options&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="60">
            
            

            

            <code class="ruby">    new(parsed_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load_all</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="64">
            
            

            

            <code class="ruby">    @load_all = nil if Rails.env.development?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="65">
            
            

            

            <code class="ruby">    @load_all ||= YAML.load_file(CONFIG_PATH)[&quot;questions&quot;].map { |q| load(q) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="107d297cd338afd183baeafc96e556090b96287b">
  <div class="header">
    <h3>app/lib/brexit_checker/question/option.rb</h3>
    <h4>
      <span class="red">
  53.85%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>13</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class BrexitChecker::Question::Option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActiveModel::Validations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  validates_presence_of :label</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :label, :value, :sub_options, :hint_text, :exclude_if</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(attrs)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            
            

            

            <code class="ruby">    attrs.each { |key, value| instance_variable_set(&quot;@#{key}&quot;, value) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="10">
            
            

            

            <code class="ruby">    validate!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load(params)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="14">
            
            

            

            <code class="ruby">    parsed_params = params.dup</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="15">
            
            

            

            <code class="ruby">    parsed_params[&quot;sub_options&quot;] = load_all(params[&quot;options&quot;].to_a)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">    new(parsed_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.load_all(options)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="20">
            
            

            

            <code class="ruby">    options.map { |o| load(o) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="e3285d2ba113be79c2098d7737f3f3dc92e98d01">
  <div class="header">
    <h3>app/lib/facets_builder.rb</h3>
    <h4>
      <span class="yellow">
  86.57%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>67</b> relevant lines.
      <span class="green"><b>58</b> lines covered</span> and
      <span class="red"><b>9</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class FacetsBuilder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(content_item:, search_results:, value_hash:)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="3">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="4">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @search_results = search_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="5">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @value_hash = value_hash.stringify_keys</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="9">
            <span class="hits">55</span>
            

            

            <code class="ruby">    facet_hashes.map do |facet_hash|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="313" data-linenumber="10">
            <span class="hits">313</span>
            

            

            <code class="ruby">      facet_hash_with_allowed_values = facet_hash.merge(&quot;allowed_values&quot; =&gt; allowed_values(facet_hash))</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="313" data-linenumber="11">
            <span class="hits">313</span>
            

            

            <code class="ruby">      build_facet(facet_hash_with_allowed_values)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :content_item, :search_results, :value_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filters_on_brexit_topic?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="20">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @value_hash[&quot;topic&quot;] == ContentItem::BREXIT_CONTENT_ID</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def is_related_to_transition_period_checkbox?(facet_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="24">
            <span class="hits">6</span>
            

            

            <code class="ruby">    facet_hash[&quot;key&quot;] == &quot;related_to_brexit&quot; &amp;&amp; facet_hash[&quot;filter_value&quot;] == ContentItem::BREXIT_CONTENT_ID</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facet_hashes</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="28">
            <span class="hits">55</span>
            

            

            <code class="ruby">    all_facet_hashes = content_item.raw_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="29">
            <span class="hits">55</span>
            

            

            <code class="ruby">    if filters_on_brexit_topic?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="7" data-linenumber="30">
            <span class="hits">7</span>
            

            

            <code class="ruby">      all_facet_hashes.reject { |facet_hash| is_related_to_transition_period_checkbox?(facet_hash) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="32">
            <span class="hits">54</span>
            

            

            <code class="ruby">      all_facet_hashes</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def build_facet(facet_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="313" data-linenumber="37">
            <span class="hits">313</span>
            

            

            <code class="ruby">    if facet_hash[&quot;filterable&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="240" data-linenumber="38">
            <span class="hits">240</span>
            

            

            <code class="ruby">      case facet_hash[&quot;type&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">      when &quot;text&quot;, &quot;content_id&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="141" data-linenumber="40">
            <span class="hits">141</span>
            

            

            <code class="ruby">        OptionSelectFacet.new(facet_hash, value_hash[facet_hash[&quot;key&quot;]])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">      when &quot;topical&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="42">
            
            

            

            <code class="ruby">        TopicalFacet.new(facet_hash, value_hash[facet_hash[&quot;key&quot;]])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">      when &quot;taxon&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="44">
            <span class="hits">25</span>
            

            

            <code class="ruby">        TaxonFacet.new(facet_hash, value_hash.slice(*facet_hash[&quot;keys&quot;]))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">      when &quot;date&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="46">
            <span class="hits">35</span>
            

            

            <code class="ruby">        DateFacet.new(facet_hash, value_hash[facet_hash[&quot;key&quot;]])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">      when &quot;hidden&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="13" data-linenumber="48">
            <span class="hits">13</span>
            

            

            <code class="ruby">        HiddenFacet.new(facet_hash, value_hash[facet_hash[&quot;key&quot;]])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">      when &quot;checkbox&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="50">
            <span class="hits">18</span>
            

            

            <code class="ruby">        CheckboxFacet.new(facet_hash, value_hash[facet_hash[&quot;key&quot;]])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">      when &quot;radio&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="52">
            
            

            

            <code class="ruby">        RadioFacet.new(facet_hash, value_hash[facet_hash[&quot;key&quot;]])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">      when &quot;hidden_clearable&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            <span class="hits">1</span>
            

            

            <code class="ruby">        HiddenClearableFacet.new(facet_hash, value_hash[facet_hash[&quot;key&quot;]])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">      when &quot;research_and_statistics&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="7" data-linenumber="56">
            <span class="hits">7</span>
            

            

            <code class="ruby">        RadioFacetForMultipleFilters.new(facet_hash, value_hash[facet_hash[&quot;key&quot;]], ::Filters::ResearchAndStatsHashes.new.call)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">      when &quot;official_documents&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="58">
            
            

            

            <code class="ruby">        RadioFacetForMultipleFilters.new(facet_hash, value_hash[facet_hash[&quot;key&quot;]], ::Filters::OfficialDocumentsHashes.new.call)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="60">
            
            

            

            <code class="ruby">        raise ArgumentError, &quot;Unknown filterable facet type: #{facet_hash[&#39;type&#39;]}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="73" data-linenumber="63">
            <span class="hits">73</span>
            

            

            <code class="ruby">      Facet.new(facet_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="67">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def allowed_values(facet_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="313" data-linenumber="68">
            <span class="hits">313</span>
            

            

            <code class="ruby">    return facet_hash[&quot;allowed_values&quot;] if facet_hash[&quot;allowed_values&quot;].present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="231" data-linenumber="70">
            <span class="hits">231</span>
            

            

            <code class="ruby">    facet_key = facet_hash[&quot;key&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="231" data-linenumber="71">
            <span class="hits">231</span>
            

            

            <code class="ruby">    if registries.all.key?(facet_key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="72">
            <span class="hits">60</span>
            

            

            <code class="ruby">      allowed_values_from_registry(facet_key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="171" data-linenumber="73">
            <span class="hits">171</span>
            

            

            <code class="ruby">    elsif (facet_details = search_results.dig(&quot;facets&quot;, facet_key))</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="74">
            
            

            

            <code class="ruby">      allowed_values_for_facet_details(facet_key, facet_details)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="78">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def allowed_values_for_facet_details(facet_key, facet_details)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="79">
            
            

            

            <code class="ruby">    facet_details.fetch(&quot;options&quot;, {})</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="80">
            
            

            

            <code class="ruby">      .map { |f| f.fetch(&quot;value&quot;, {}) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="81">
            
            

            

            <code class="ruby">      .map { |value| present_facet_option(value, facet_key) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="82">
            
            

            

            <code class="ruby">      .reject { |f| f[&quot;label&quot;].blank? || f[&quot;value&quot;].blank? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="85">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def allowed_values_from_registry(facet_key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="86">
            <span class="hits">60</span>
            

            

            <code class="ruby">    registries.all[facet_key].values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="87">
            <span class="hits">210</span>
            

            

            <code class="ruby">      .map { |_, results| present_facet_option(results, facet_key) }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="88">
            <span class="hits">210</span>
            

            

            <code class="ruby">      .reject { |f| f[&quot;label&quot;].blank? || f[&quot;value&quot;].blank? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="91">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def present_facet_option(value, facet_key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="92">
            <span class="hits">210</span>
            

            

            <code class="ruby">    slug = value.fetch(&quot;slug&quot;, &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="93">
            <span class="hits">210</span>
            

            

            <code class="ruby">    title = value.fetch(&quot;title&quot;, find_facet_title_by_slug(slug, facet_key))</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="94">
            <span class="hits">210</span>
            

            

            <code class="ruby">    label = generate_label(value, title)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="97">
            <span class="hits">210</span>
            

            

            <code class="ruby">      &quot;label&quot; =&gt; label,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">      &quot;value&quot; =&gt; slug,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="102">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def generate_label(value, title)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="103">
            <span class="hits">210</span>
            

            

            <code class="ruby">    acronym = value.fetch(&quot;acronym&quot;, &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="104">
            <span class="hits">210</span>
            

            

            <code class="ruby">    return title if acronym.blank? || acronym == title</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="50" data-linenumber="106">
            <span class="hits">50</span>
            

            

            <code class="ruby">    title + &quot; (&quot; + acronym + &quot;)&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="107">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="108">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="109">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def find_facet_title_by_slug(slug, facet_key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="110">
            <span class="hits">210</span>
            

            

            <code class="ruby">    registry = registries.all[facet_key]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="111">
            <span class="hits">210</span>
            

            

            <code class="ruby">    return &quot;&quot; if registry.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="113">
            <span class="hits">210</span>
            

            

            <code class="ruby">    item = registry[slug] || {}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="210" data-linenumber="114">
            <span class="hits">210</span>
            

            

            <code class="ruby">    item.fetch(&quot;title&quot;, &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="115">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="117">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="501" data-linenumber="118">
            <span class="hits">501</span>
            

            

            <code class="ruby">    @registries ||= Registries::BaseRegistries.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="119">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="120">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="5d066880dc75a4f11eb72d4aa4400faeaa8cdcc2">
  <div class="header">
    <h3>app/lib/filters/checkbox_filter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>5</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class CheckboxFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">      # &#39;params&#39; for a checkbox should be true or false. the value</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">      # we send to rummager can be params or a static value provided in</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">      # the finder content item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="22" data-linenumber="9">
            <span class="hits">22</span>
            

            

            <code class="ruby">      @value ||= params.nil? ? nil : facet[&quot;filter_value&quot;] || params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="28c8e8e509f9f72053048b3efeb0bb8ead701050">
  <div class="header">
    <h3>app/lib/filters/content_id_filter.rb</h3>
    <h4>
      <span class="red">
  63.64%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>11</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class ContentIdFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="6">
            
            

            

            <code class="ruby">      @value ||= Array(params).map(&amp;method(:content_id_for))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def content_id_for(value)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="10">
            
            

            

            <code class="ruby">      content_id_map[value]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def content_id_map</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="14">
            
            

            

            <code class="ruby">      @content_id_map = allowed_values.to_h { |v| [v[&quot;value&quot;], v[&quot;content_id&quot;]] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def allowed_values</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">      facet[&quot;allowed_values&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="fefe491dbd0f7a81dbc54ffcdf60737660367a5f">
  <div class="header">
    <h3>app/lib/filters/date_filter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>18</b> relevant lines.
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class DateFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="37" data-linenumber="6">
            <span class="hits">37</span>
            

            

            <code class="ruby">      @value ||= serialized_values.join(&quot;,&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def serialized_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="10">
            <span class="hits">35</span>
            

            

            <code class="ruby">      present_values.map do |key, date|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="11">
            <span class="hits">2</span>
            

            

            <code class="ruby">        &quot;#{key}:#{date.iso8601}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def present_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="16">
            <span class="hits">35</span>
            

            

            <code class="ruby">      parsed_values.select do |_, date|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="17">
            <span class="hits">18</span>
            

            

            <code class="ruby">        date.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def parsed_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="22">
            <span class="hits">35</span>
            

            

            <code class="ruby">      user_values.reduce({}) do |values, (key, date_string)|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="23">
            <span class="hits">18</span>
            

            

            <code class="ruby">        values.merge(key =&gt; DateParser.new.parse(date_string))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def user_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="28">
            <span class="hits">35</span>
            

            

            <code class="ruby">      if params.is_a?(Hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="29">
            <span class="hits">9</span>
            

            

            <code class="ruby">        params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="26" data-linenumber="31">
            <span class="hits">26</span>
            

            

            <code class="ruby">        {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="5e46c09ebb3620113f123e7fd3556bff3e6994d9">
  <div class="header">
    <h3>app/lib/filters/dropdown_select_filter.rb</h3>
    <h4>
      <span class="red">
  55.56%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>9</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class DropdownSelectFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="6">
            
            

            

            <code class="ruby">      @value ||= Array(parsed_value)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def parsed_value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="10">
            
            

            

            <code class="ruby">      return if params.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            
            

            

            <code class="ruby">      JSON.parse params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    rescue JSON::ParserError</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="14">
            
            

            

            <code class="ruby">      params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="b30131afbc50e65d1939c8fa0fa395fecd181d12">
  <div class="header">
    <h3>app/lib/filters/filter.rb</h3>
    <h4>
      <span class="yellow">
  87.5%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>24</b> relevant lines.
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def initialize(facet, params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="243" data-linenumber="4">
            <span class="hits">243</span>
            

            

            <code class="ruby">      @facet = facet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="243" data-linenumber="5">
            <span class="hits">243</span>
            

            

            <code class="ruby">      @params = params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="34" data-linenumber="9">
            <span class="hits">34</span>
            

            

            <code class="ruby">      facet[&quot;filter_key&quot;] || facet[&quot;key&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def active?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="243" data-linenumber="13">
            <span class="hits">243</span>
            

            

            <code class="ruby">      value.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def query_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="34" data-linenumber="17">
            <span class="hits">34</span>
            

            

            <code class="ruby">      { key =&gt; value }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">    attr_reader :facet, :params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            
            

            

            <code class="ruby">      raise NotImplementedError</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def parsed_value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="145" data-linenumber="29">
            <span class="hits">145</span>
            

            

            <code class="ruby">      return [] if params.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="31">
            <span class="hits">4</span>
            

            

            <code class="ruby">      if multi_value?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">        option_lookup.select { |key, _| params.include? key }.values.flatten</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="34">
            <span class="hits">4</span>
            

            

            <code class="ruby">        Array(params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def multi_value?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="39">
            <span class="hits">4</span>
            

            

            <code class="ruby">      facet.key?(&quot;option_lookup&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def option_lookup</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="43">
            
            

            

            <code class="ruby">      @option_lookup ||= facet[&quot;option_lookup&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f306be89311661549335fa7536a134b9555d0c6a">
  <div class="header">
    <h3>app/lib/filters/hidden_clearable_filter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>5</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class HiddenClearableFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="6">
            <span class="hits">2</span>
            

            

            <code class="ruby">      params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f3485fbbfc15e74555ca6966b3949feed1eca07c">
  <div class="header">
    <h3>app/lib/filters/hidden_filter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>5</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class HiddenFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="6">
            <span class="hits">14</span>
            

            

            <code class="ruby">      params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="b381ee46fb2975bbdee33bd2cc1b9e0c170ebbf8">
  <div class="header">
    <h3>app/lib/filters/official_documents_filter.rb</h3>
    <h4>
      <span class="red">
  75.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>4</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class OfficialDocumentsFilter &lt; RadioFilterForMultipleFields</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def filter_hashes</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            
            

            

            <code class="ruby">      Filters::OfficialDocumentsHashes.new.call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="3abe6516b9f13a1a82367e6c82d0ba47c68899c6">
  <div class="header">
    <h3>app/lib/filters/radio_filter.rb</h3>
    <h4>
      <span class="red">
  40.91%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>22</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class RadioFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="6">
            
            

            

            <code class="ruby">      @value ||= if !acceptable_param?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="7">
            
            

            

            <code class="ruby">                   default_value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="8">
            
            

            

            <code class="ruby">                 elsif multi_value?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            
            

            

            <code class="ruby">                   option_lookup_values(params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">                 else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">                   Array(params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">                 end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def default_value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">      return [] if default_allowed_value.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">      return option_lookup_values(default_allowed_value) if multi_value?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="20">
            
            

            

            <code class="ruby">      Array(default_allowed_value)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def option_lookup_values(val)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="24">
            
            

            

            <code class="ruby">      option_lookup.select { |key, _| val.include? key }.values.flatten</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def default_allowed_value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="28">
            
            

            

            <code class="ruby">      @default_allowed_value ||= facet[&quot;allowed_values&quot;].find(proc { {} }) { |option| option[&quot;default&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="29">
            
            

            

            <code class="ruby">      @default_allowed_value[&quot;value&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def acceptable_param?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="33">
            
            

            

            <code class="ruby">      params.present? &amp;&amp; params.is_a?(String) &amp;&amp; param_is_part_of_allowed_values</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def param_is_part_of_allowed_values</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="37">
            
            

            

            <code class="ruby">      facet[&quot;allowed_values&quot;].any? { |option| option[&quot;value&quot;] == params }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="1f4780ca86cb4af2c72c7fc9fa5eaa44d03a17c8">
  <div class="header">
    <h3>app/lib/filters/radio_filter_for_multiple_fields.rb</h3>
    <h4>
      <span class="green">
  93.33%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>15</b> relevant lines.
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class RadioFilterForMultipleFields &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def query_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="7" data-linenumber="4">
            <span class="hits">7</span>
            

            

            <code class="ruby">      find_filter(value)[&quot;filter&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def filter_hashes</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="8">
            
            

            

            <code class="ruby">      raise NotImplementedError</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="14">
            <span class="hits">14</span>
            

            

            <code class="ruby">      validated_value(params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def default_value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="18">
            <span class="hits">16</span>
            

            

            <code class="ruby">      filter_hashes.find { |filter| filter[&quot;default&quot;] }.fetch(&quot;value&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def validated_value(value)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="70" data-linenumber="22">
            <span class="hits">70</span>
            

            

            <code class="ruby">      filter_hashes.map { |filter| filter[&quot;value&quot;] }.include?(value) ? value : default_value</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def find_filter(value)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="26">
            <span class="hits">15</span>
            

            

            <code class="ruby">      filter_hashes.find { |filter| filter[&quot;value&quot;] == value }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="4ff409b48f96d95d6600bdf298b8ff8c1542ecf3">
  <div class="header">
    <h3>app/lib/filters/research_and_statistics_filter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>4</b> relevant lines.
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class ResearchAndStatisticsFilter &lt; RadioFilterForMultipleFields</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def filter_hashes</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="29" data-linenumber="4">
            <span class="hits">29</span>
            

            

            <code class="ruby">      Filters::ResearchAndStatsHashes.new.call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="77e47b21a40220df942447308e460cc8749b719a">
  <div class="header">
    <h3>app/lib/filters/taxon_filter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>8</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class TaxonFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="50" data-linenumber="6">
            <span class="hits">50</span>
            

            

            <code class="ruby">      @value ||= begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="7">
            <span class="hits">25</span>
            

            

            <code class="ruby">        topic = params[&quot;level_one_taxon&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="8">
            <span class="hits">25</span>
            

            

            <code class="ruby">        subtopic = params[&quot;level_two_taxon&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">        # we send a conjunctive query to rummager for part_of_taxonomy_tree</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="11">
            <span class="hits">25</span>
            

            

            <code class="ruby">        [topic, subtopic]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="975b2c148d26ecd9c1055a7d7c18a8674fece4eb">
  <div class="header">
    <h3>app/lib/filters/text_filter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>5</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class TextFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="145" data-linenumber="6">
            <span class="hits">145</span>
            

            

            <code class="ruby">      parsed_value</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ffbcac1f61b4acefd89896312800a62db976b17f">
  <div class="header">
    <h3>app/lib/filters/topical_filter.rb</h3>
    <h4>
      <span class="red">
  42.86%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>21</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class TopicalFilter &lt; Filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="6">
            
            

            

            <code class="ruby">      @value ||= fetch_value</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="10">
            
            

            

            <code class="ruby">      return nil if params.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            
            

            

            <code class="ruby">      user_has_selected_open = params.include?(facet[&quot;open_value&quot;][&quot;value&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="13">
            
            

            

            <code class="ruby">      user_has_selected_closed = params.include?(facet[&quot;closed_value&quot;][&quot;value&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">      # with both or neither selected, the filter is not used</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">      if user_has_selected_open &amp;&amp; !user_has_selected_closed</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="17">
            
            

            

            <code class="ruby">        open_value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">      elsif user_has_selected_closed &amp;&amp; !user_has_selected_open</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="19">
            
            

            

            <code class="ruby">        closed_value</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    # A thing is open when it ends on a future day</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def open_value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            
            

            

            <code class="ruby">      &quot;from:#{later_than_midnight_today}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">    # A thing becomes closed when it ends today or before</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def closed_value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            
            

            

            <code class="ruby">      &quot;to:#{midnight_today}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def midnight_today</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            
            

            

            <code class="ruby">      Time.zone.now.beginning_of_day.utc</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def later_than_midnight_today</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="38">
            
            

            

            <code class="ruby">      Time.zone.now.beginning_of_day.change(sec: 1).utc</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="d05d24f4805249bdb0a1543e8659fb3966f41681">
  <div class="header">
    <h3>app/lib/healthchecks/registries_cache.rb</h3>
    <h4>
      <span class="red">
  45.45%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>22</b> relevant lines.
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Healthchecks</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class RegistriesCache</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def name</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            
            

            

            <code class="ruby">      :registries_have_data</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def status</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="8">
            
            

            

            <code class="ruby">      if in_warning_state?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            
            

            

            <code class="ruby">        :warning</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">        :ok</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    # Optional</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def message</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="17">
            
            

            

            <code class="ruby">      if in_warning_state?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">        &quot;The following registry caches are empty: #{empty_registries.keys.join(&#39;, &#39;)}.&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="20">
            
            

            

            <code class="ruby">        &quot;OK&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">    # Optional</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def enabled?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">      true # false if the check is not relevant at this time</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def in_warning_state?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">      empty_registries.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def empty_registries</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="36">
            
            

            

            <code class="ruby">      @empty_registries ||= registries.select do |_key, registry|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="37">
            
            

            

            <code class="ruby">        Rails.cache.fetch(registry.cache_key).nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def registries</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="42">
            
            

            

            <code class="ruby">      Registries::BaseRegistries.new.all</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="524ab8f3c226bc8edf9e6dcc56a8bf7ec3036e26">
  <div class="header">
    <h3>app/lib/parameter_parser/email_alert_parameter_parser.rb</h3>
    <h4>
      <span class="yellow">
  83.33%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>48</b> relevant lines.
      <span class="green"><b>40</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Ensures that email alert filter keys and values provided by users</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># and that Finder Frontend sends to Email Alert API are within the</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># set of permitted keys and values provided in the content item or</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># registries of people, organisations, taxons, and world locations.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">module ParameterParser</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class EmailAlertParameterParser</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include ActiveModel::Validations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    validates :applied_filters, email_alert_params: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def initialize(content_item, filter_params, params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="12">
            <span class="hits">2</span>
            

            

            <code class="ruby">      @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="13">
            <span class="hits">2</span>
            

            

            <code class="ruby">      @filter_params = parsed_params(filter_params, params).deep_stringify_keys</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def applied_filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="17">
            <span class="hits">4</span>
            

            

            <code class="ruby">      @applied_filters ||= begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="18">
            <span class="hits">4</span>
            

            

            <code class="ruby">        permitted_filter_keys.index_with { |key| permitted_values_for_filter_key(key) }.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def required_facets_selected?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="23">
            <span class="hits">4</span>
            

            

            <code class="ruby">      required_facets.all? { |facet| applied_filters.key?(key_for_facet(facet)) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">    attr_reader :filter_params, :content_item</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def required_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="31">
            <span class="hits">6</span>
            

            

            <code class="ruby">      permitted_facets.select { |facet| facet.dig(&quot;required&quot;) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def permitted_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="35">
            <span class="hits">6</span>
            

            

            <code class="ruby">      content_item.dig(&quot;details&quot;, &quot;email_filter_facets&quot;) || []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def permitted_filter_keys</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="39">
            <span class="hits">6</span>
            

            

            <code class="ruby">      allowed = permitted_facets.map { |facet| key_for_facet(facet) }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="40">
            <span class="hits">2</span>
            

            

            <code class="ruby">      given = filter_params.keys</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="41">
            <span class="hits">2</span>
            

            

            <code class="ruby">      allowed &amp; given</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def permitted_values_for_filter_key(key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="45">
            <span class="hits">2</span>
            

            

            <code class="ruby">      facet = find_facet_by_key(key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="46">
            <span class="hits">2</span>
            

            

            <code class="ruby">      given_values = Array(filter_params[key])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="47">
            <span class="hits">2</span>
            

            

            <code class="ruby">      allowed_values = allowed_values_for_facet(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="48">
            <span class="hits">2</span>
            

            

            <code class="ruby">      permitted = allowed_values &amp; given_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="49">
            <span class="hits">2</span>
            

            

            <code class="ruby">      permitted if permitted.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="52">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def find_facet_by_key(key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="53">
            <span class="hits">6</span>
            

            

            <code class="ruby">      permitted_facets.find { |facet| key_for_facet(facet) == key }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="56">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def key_for_facet(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="57">
            <span class="hits">10</span>
            

            

            <code class="ruby">      facet[&quot;filter_key&quot;] || facet[&quot;facet_id&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">    # TODO: this could be improved upon</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="61">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def allowed_values_for_facet(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">      # Facet choices used by /cma-cases/email-signup</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="63">
            <span class="hits">2</span>
            

            

            <code class="ruby">      facet_choices = facet.fetch(&quot;facet_choices&quot;, [])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="64">
            <span class="hits">2</span>
            

            

            <code class="ruby">      facet_choice_values = facet_choices</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="65">
            <span class="hits">4</span>
            

            

            <code class="ruby">        .map { |choice| choice[&quot;content_id&quot;] || choice[&quot;key&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">        .uniq</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">        .compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="69">
            <span class="hits">2</span>
            

            

            <code class="ruby">      return facet_choice_values if facet_choice_values.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">      # Option lookup used by /search/policy-papers-and-consultations/email-signup</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby">      # TODO: remove option_lookup and make it consistent with other finders.</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="73">
            
            

            

            <code class="ruby">      option_lookup = facet.dig(&quot;option_lookup&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="74">
            
            

            

            <code class="ruby">      return option_lookup.values.flatten if option_lookup.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">      # Dynamic facets, such as people or organisations, used by</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">      # /search/news-and-communications/email-signup</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby">      # TODO: Put is_a_dynamic_facet: bool into the content item schema</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="79">
            
            

            

            <code class="ruby">      key = key_for_facet(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="80">
            
            

            

            <code class="ruby">      if facet_choices.none? &amp;&amp; could_be_a_dynamic_facet?(key)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="81">
            
            

            

            <code class="ruby">        registry = Registries::BaseRegistries.new.all[key]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="82">
            
            

            

            <code class="ruby">        return registry.values.keys if registry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="85">
            
            

            

            <code class="ruby">      []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="88">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def could_be_a_dynamic_facet?(key)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="89">
            
            

            

            <code class="ruby">      %w[organisations people roles world_locations all_part_of_taxonomy_tree part_of_taxonomy_tree].include? key</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="92">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def parsed_params(filter_params, params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">      # TODO: There are 3 params hashes here for the email-alert-api tags/links</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="94">
            <span class="hits">2</span>
            

            

            <code class="ruby">      filter_params.fetch(&quot;subscriber_list_params&quot;, {}).merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">        params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby">          .permit(&quot;filter&quot; =&gt; {})</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">          .dig(&quot;filter&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">          .to_h,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="dcf9cc821d9544d1b86257b583a50e477673efc8">
  <div class="header">
    <h3>app/lib/params_cleaner.rb</h3>
    <h4>
      <span class="yellow">
  85.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>20</b> relevant lines.
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># In some cases requests come in to this app with a mangled query string in</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># this form:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">#   foo[0]=bar&amp;foo[1]=baz</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"># Which translates in Rails as:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">#   foo: { 0: &quot;bar&quot;, 1: &quot;baz&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"># While we want:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">#   foo: [&quot;bar&quot;, &quot;baz&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"># We also sometimes get parameters with leading or trailing whitespace</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"># in facet values (trailing whitespace in the last facet is common for</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"># the business readiness finder), strip those so that searches work.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">class ParamsCleaner</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :cleaned</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="22">
            <span class="hits">60</span>
            

            

            <code class="ruby">    @cleaned = cleanup(params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def fetch(key, default)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">    value = cleaned[key]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="27">
            
            

            

            <code class="ruby">    value.is_a?(default.class) ? value : default</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def cleanup(params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="33">
            <span class="hits">60</span>
            

            

            <code class="ruby">    param_pairs = params.to_unsafe_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="83" data-linenumber="34">
            <span class="hits">83</span>
            

            

            <code class="ruby">      .map { |k, v| [k, cleanup_value(v)] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="36">
            <span class="hits">60</span>
            

            

            <code class="ruby">    Hash[param_pairs]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="83" data-linenumber="37">
            <span class="hits">83</span>
            

            

            <code class="ruby">      .delete_if { |_, value| value.blank? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">      .with_indifferent_access</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def cleanup_value(value)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="83" data-linenumber="42">
            <span class="hits">83</span>
            

            

            <code class="ruby">    return value.strip if value.is_a?(String)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="44">
            <span class="hits">15</span>
            

            

            <code class="ruby">    if value.is_a? Array</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="45">
            <span class="hits">2</span>
            

            

            <code class="ruby">      return value.map { |x| x.is_a?(String) ? x.strip : x }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="28" data-linenumber="48">
            <span class="hits">28</span>
            

            

            <code class="ruby">    if value.respond_to?(:keys) &amp;&amp; value.keys.all? { |d| d.match(/\A\d+\Z/) }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="49">
            
            

            

            <code class="ruby">      return value.values</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="52">
            <span class="hits">14</span>
            

            

            <code class="ruby">    value</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="600a840e983f41aa1d688f2f80c16e94199cba68">
  <div class="header">
    <h3>app/lib/registries/base_registries.rb</h3>
    <h4>
      <span class="red">
  80.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>30</b> relevant lines.
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  NAMESPACE = &quot;registries&quot;.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class BaseRegistries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def all</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="683" data-linenumber="6">
            <span class="hits">683</span>
            

            

            <code class="ruby">      @all ||= {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">        &quot;world_locations&quot; =&gt; world_locations,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">        &quot;all_part_of_taxonomy_tree&quot; =&gt; full_topic_taxonomy,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">        &quot;part_of_taxonomy_tree&quot; =&gt; topic_taxonomy,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">        &quot;people&quot; =&gt; people,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">        &quot;roles&quot; =&gt; roles,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">        &quot;organisations&quot; =&gt; organisations,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">        &quot;manual&quot; =&gt; manuals,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">        &quot;full_topic_taxonomy&quot; =&gt; full_topic_taxonomy,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">        # this isn&#39;t called &quot;topical_events&quot; because we don&#39;t want the</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">        # facet tag to appear automatically</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">        &quot;full_topical_events&quot; =&gt; full_topical_events,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def ensure_warm_cache</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">      all.each_value do |registry|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">        if registry.can_refresh_cache?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="24">
            
            

            

            <code class="ruby">          registry.fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def refresh_cache</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            
            

            

            <code class="ruby">      all.each_value do |registry|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="31">
            
            

            

            <code class="ruby">        if registry.can_refresh_cache?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">          registry.refresh_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def full_topic_taxonomy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="472" data-linenumber="40">
            <span class="hits">472</span>
            

            

            <code class="ruby">      @full_topic_taxonomy ||= FullTopicTaxonomyRegistry.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def world_locations</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="236" data-linenumber="44">
            <span class="hits">236</span>
            

            

            <code class="ruby">      @world_locations ||= WorldLocationsRegistry.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def topic_taxonomy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="236" data-linenumber="48">
            <span class="hits">236</span>
            

            

            <code class="ruby">      @topic_taxonomy ||= TopicTaxonomyRegistry.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="51">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def people</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="236" data-linenumber="52">
            <span class="hits">236</span>
            

            

            <code class="ruby">      @people ||= PeopleRegistry.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def roles</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="236" data-linenumber="56">
            <span class="hits">236</span>
            

            

            <code class="ruby">      @roles ||= RolesRegistry.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="59">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def organisations</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="236" data-linenumber="60">
            <span class="hits">236</span>
            

            

            <code class="ruby">      @organisations ||= OrganisationsRegistry.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def manuals</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="236" data-linenumber="64">
            <span class="hits">236</span>
            

            

            <code class="ruby">      @manuals ||= ManualsRegistry.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="67">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def full_topical_events</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="236" data-linenumber="68">
            <span class="hits">236</span>
            

            

            <code class="ruby">      @full_topical_events ||= TopicalEventsRegistry.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="cd3af41a8183ea0d8b8113e65d8eba227a1f49c2">
  <div class="header">
    <h3>app/lib/registries/cacheable_registry.rb</h3>
    <h4>
      <span class="red">
  52.63%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>19</b> relevant lines.
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>9</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  module CacheableRegistry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def can_refresh_cache?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            
            

            

            <code class="ruby">      true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def refresh_cache</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="8">
            
            

            

            <code class="ruby">      Rails.cache.write(cache_key, cacheable_data)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    rescue GdsApi::HTTPServerError, GdsApi::HTTPBadGateway</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="10">
            
            

            

            <code class="ruby">      report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">      false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="182" data-linenumber="15">
            <span class="hits">182</span>
            

            

            <code class="ruby">      Rails.cache.fetch(cache_key) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="97" data-linenumber="16">
            <span class="hits">97</span>
            

            

            <code class="ruby">        cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">    rescue GdsApi::HTTPServerError, GdsApi::HTTPBadGateway</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="19">
            
            

            

            <code class="ruby">      report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="20">
            
            

            

            <code class="ruby">      {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="24">
            
            

            

            <code class="ruby">      raise NotImplementedError, &quot;Please supply a cacheable_data method&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="28">
            
            

            

            <code class="ruby">      raise NotImplementedError, &quot;Please supply a cache_key method&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">      raise NotImplementedError, &quot;Please supply a report_error method&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="8793ab3c1e82abf139ce499c4aea654303797bc6">
  <div class="header">
    <h3>app/lib/registries/full_topic_taxonomy_registry.rb</h3>
    <h4>
      <span class="green">
  94.12%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>34</b> relevant lines.
      <span class="green"><b>32</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class FullTopicTaxonomyRegistry &lt; Registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include CacheableRegistry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    delegate :[], to: :taxonomy</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def taxonomy</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="94" data-linenumber="8">
            <span class="hits">94</span>
            

            

            <code class="ruby">      @taxonomy ||= fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="94" data-linenumber="12">
            <span class="hits">94</span>
            

            

            <code class="ruby">      &quot;registries/full_topic_taxonomy&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def values</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">      taxonomy</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="37" data-linenumber="22">
            <span class="hits">37</span>
            

            

            <code class="ruby">      taxonomy_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">      GovukStatsd.increment(&quot;registries.full_topic_taxonomy_api_errors&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def format_taxon(taxon)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="31">
            <span class="hits">56</span>
            

            

            <code class="ruby">        taxon[&quot;content_id&quot;] =&gt;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">          &quot;title&quot; =&gt; taxon[&quot;title&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">          &quot;base_path&quot; =&gt; taxon[&quot;base_path&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def level_one_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="37" data-linenumber="40">
            <span class="hits">37</span>
            

            

            <code class="ruby">      @level_one_taxons ||= fetch_level_one_taxons_from_api</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def flatten_taxonomy(taxons)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="93" data-linenumber="44">
            <span class="hits">93</span>
            

            

            <code class="ruby">      return {} if taxons.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="29" data-linenumber="46">
            <span class="hits">29</span>
            

            

            <code class="ruby">      taxons.inject({}) do |result, taxon|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="47">
            <span class="hits">56</span>
            

            

            <code class="ruby">        child_taxons = taxon.dig(&quot;links&quot;, &quot;child_taxons&quot;) || []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="49">
            <span class="hits">56</span>
            

            

            <code class="ruby">        taxon_hash = format_taxon(taxon)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="50">
            <span class="hits">56</span>
            

            

            <code class="ruby">        child_taxon_hashes = flatten_taxonomy(child_taxons)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="52">
            <span class="hits">56</span>
            

            

            <code class="ruby">        result.merge(taxon_hash).merge(child_taxon_hashes)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="56">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def taxonomy_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="37" data-linenumber="57">
            <span class="hits">37</span>
            

            

            <code class="ruby">      GovukStatsd.time(&quot;registries.full_topic_taxonomy.request_time&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="37" data-linenumber="58">
            <span class="hits">37</span>
            

            

            <code class="ruby">        flatten_taxonomy(level_one_taxons)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="62">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_level_one_taxons_from_api</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="37" data-linenumber="63">
            <span class="hits">37</span>
            

            

            <code class="ruby">      taxons = fetch_taxon.dig(&quot;links&quot;, &quot;level_one_taxons&quot;) || []</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="57" data-linenumber="64">
            <span class="hits">57</span>
            

            

            <code class="ruby">      taxons.map { |taxon| fetch_taxon(taxon[&quot;base_path&quot;]) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="67">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_taxon(base_path = &quot;/&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="57" data-linenumber="68">
            <span class="hits">57</span>
            

            

            <code class="ruby">      Services.cached_content_item(base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="6e134b9b54335845507657374583c966f3c8b33d">
  <div class="header">
    <h3>app/lib/registries/manuals_registry.rb</h3>
    <h4>
      <span class="green">
  95.65%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>23</b> relevant lines.
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class ManualsRegistry &lt; Registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include CacheableRegistry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    delegate :[], to: :manuals</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">      manuals</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            <span class="hits">1</span>
            

            

            <code class="ruby">      &quot;registries/manuals&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">      manuals_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def manuals</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="22">
            <span class="hits">4</span>
            

            

            <code class="ruby">      @manuals ||= fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">      GovukStatsd.increment(&quot;registries.manuals_api_errors&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def manuals_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">      GovukStatsd.time(&quot;registries.manuals.request_time&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">        fetch_manuals_from_rummager</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="32">
            <span class="hits">3</span>
            

            

            <code class="ruby">          .reject { |manual| manual[&quot;_id&quot;].empty? || manual[&quot;title&quot;].empty? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">          .each_with_object({}) do |manual, manuals|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="34">
            <span class="hits">3</span>
            

            

            <code class="ruby">            manuals[manual[&quot;_id&quot;]] = { &quot;title&quot; =&gt; manual[&quot;title&quot;], &quot;slug&quot; =&gt; manual[&quot;_id&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">          end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_manuals_from_rummager</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">      params = {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">        filter_document_type: %w[manual service_manual_homepage service_manual_guide],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">        fields: %w[title],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">        count: 1500,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            <span class="hits">1</span>
            

            

            <code class="ruby">      Services.rummager.search(params)[&quot;results&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c8cc3e2ef1926de6973bce99693776c300b2ca91">
  <div class="header">
    <h3>app/lib/registries/organisations_registry.rb</h3>
    <h4>
      <span class="green">
  96.15%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>26</b> relevant lines.
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class OrganisationsRegistry &lt; Registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include CacheableRegistry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    delegate :[], to: :organisations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def organisations</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="128" data-linenumber="8">
            <span class="hits">128</span>
            

            

            <code class="ruby">      @organisations ||= fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="12">
            <span class="hits">25</span>
            

            

            <code class="ruby">      organisations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="28" data-linenumber="16">
            <span class="hits">28</span>
            

            

            <code class="ruby">      &quot;registries/organisations&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">      GovukStatsd.increment(&quot;registries.organisations_api_errors&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="26">
            <span class="hits">18</span>
            

            

            <code class="ruby">      organisations_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def organisations_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="30">
            <span class="hits">18</span>
            

            

            <code class="ruby">      GovukStatsd.time(&quot;registries.organisations.request_time&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="31">
            <span class="hits">18</span>
            

            

            <code class="ruby">        fetch_organisations_from_rummager</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="72" data-linenumber="32">
            <span class="hits">72</span>
            

            

            <code class="ruby">          .reject { |result| result[&quot;slug&quot;].empty? || result[&quot;title&quot;].empty? }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="72" data-linenumber="33">
            <span class="hits">72</span>
            

            

            <code class="ruby">          .sort_by { |result| result[&quot;title&quot;].sub(&quot;Closed organisation: &quot;, &quot;ZZ&quot;).upcase }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">          .each_with_object({}) do |result, orgs|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="72" data-linenumber="35">
            <span class="hits">72</span>
            

            

            <code class="ruby">            slug = result[&quot;slug&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="72" data-linenumber="36">
            <span class="hits">72</span>
            

            

            <code class="ruby">            orgs[slug] = result.slice(&quot;title&quot;, &quot;slug&quot;, &quot;acronym&quot;, &quot;content_id&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">          end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_organisations_from_rummager</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">      params = {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="43">
            <span class="hits">18</span>
            

            

            <code class="ruby">        filter_format: &quot;organisation&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">        fields: %w[title slug acronym content_id],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">        count: 1500,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">        order: &quot;title&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="48">
            <span class="hits">18</span>
            

            

            <code class="ruby">      response = Services.rummager.search(params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="49">
            <span class="hits">18</span>
            

            

            <code class="ruby">      response[&quot;results&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="d8029bdac666700e37f602fdfc203fffacc7e7bb">
  <div class="header">
    <h3>app/lib/registries/people_registry.rb</h3>
    <h4>
      <span class="green">
  95.83%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>24</b> relevant lines.
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class PeopleRegistry &lt; Registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include CacheableRegistry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    delegate :[], to: :people</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def people</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="78" data-linenumber="8">
            <span class="hits">78</span>
            

            

            <code class="ruby">      @people ||= fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="13" data-linenumber="12">
            <span class="hits">13</span>
            

            

            <code class="ruby">      people</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="13" data-linenumber="16">
            <span class="hits">13</span>
            

            

            <code class="ruby">      &quot;#{NAMESPACE}/people&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">      GovukStatsd.increment(&quot;registries.people_api_errors&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="26">
            <span class="hits">10</span>
            

            

            <code class="ruby">      people_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def people_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="30">
            <span class="hits">10</span>
            

            

            <code class="ruby">      GovukStatsd.time(&quot;registries.people.request_time&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="31">
            <span class="hits">10</span>
            

            

            <code class="ruby">        people = fetch_people_from_rummager || {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="33">
            <span class="hits">60</span>
            

            

            <code class="ruby">        people.reject { |result| result.dig(&quot;value&quot;, &quot;slug&quot;).blank? || result.dig(&quot;value&quot;, &quot;title&quot;).blank? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">          .each_with_object({}) do |result, orgs|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="50" data-linenumber="35">
            <span class="hits">50</span>
            

            

            <code class="ruby">            slug = result[&quot;value&quot;][&quot;slug&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="50" data-linenumber="36">
            <span class="hits">50</span>
            

            

            <code class="ruby">            orgs[slug] = result[&quot;value&quot;].slice(&quot;title&quot;, &quot;slug&quot;, &quot;content_id&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">          end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_people_from_rummager</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">      params = {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="43">
            <span class="hits">10</span>
            

            

            <code class="ruby">        facet_people: &quot;1500,examples:0,order:value.title&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">        count: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="46">
            <span class="hits">10</span>
            

            

            <code class="ruby">      Services.rummager.search(params).dig(&quot;facets&quot;, &quot;people&quot;, &quot;options&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c5bf18235a9d903b8d64e099814eabc98f4c3468">
  <div class="header">
    <h3>app/lib/registries/registry.rb</h3>
    <h4>
      <span class="red">
  75.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>4</b> relevant lines.
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class Registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def can_refresh_cache?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            
            

            

            <code class="ruby">      false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="16f6fc12f26969aa49799de895d14c5db40025a3">
  <div class="header">
    <h3>app/lib/registries/roles_registry.rb</h3>
    <h4>
      <span class="red">
  50.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>24</b> relevant lines.
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class RolesRegistry &lt; Registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include CacheableRegistry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    delegate :[], to: :roles</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def roles</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="8">
            
            

            

            <code class="ruby">      @roles ||= fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def values</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            
            

            

            <code class="ruby">      roles</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">      &quot;#{NAMESPACE}/roles&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">      GovukStatsd.increment(&quot;registries.roles_api_errors&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">      roles_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def roles_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            
            

            

            <code class="ruby">      GovukStatsd.time(&quot;registries.roles.request_time&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="31">
            
            

            

            <code class="ruby">        (fetch_roles_from_rummager || {})</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">          .reject { |result| result.dig(&quot;value&quot;, &quot;slug&quot;).blank? || result.dig(&quot;value&quot;, &quot;title&quot;).blank? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">          .each_with_object({}) do |result, roles|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            
            

            

            <code class="ruby">            slug = result[&quot;value&quot;][&quot;slug&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="35">
            
            

            

            <code class="ruby">            roles[slug] = result[&quot;value&quot;].slice(&quot;title&quot;, &quot;slug&quot;, &quot;content_id&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">          end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_roles_from_rummager</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">      params = {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="42">
            
            

            

            <code class="ruby">        facet_roles: &quot;1500,examples:0,order:value.title&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">        count: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="45">
            
            

            

            <code class="ruby">      Services.rummager.search(params).dig(&quot;facets&quot;, &quot;roles&quot;, &quot;options&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c6e9b056aabcbce5c9c7006d2cc086cc419dba4a">
  <div class="header">
    <h3>app/lib/registries/topic_taxonomy_registry.rb</h3>
    <h4>
      <span class="green">
  94.29%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>35</b> relevant lines.
      <span class="green"><b>33</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class TopicTaxonomyRegistry &lt; Registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include CacheableRegistry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    delegate :[], to: :taxonomy_tree</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def taxonomy_tree</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="8">
            <span class="hits">25</span>
            

            

            <code class="ruby">      @taxonomy_tree ||= fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def values</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            
            

            

            <code class="ruby">      taxonomy_tree</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="16">
            <span class="hits">25</span>
            

            

            <code class="ruby">      &quot;#{NAMESPACE}/topic_taxonomy&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">      GovukStatsd.increment(&quot;registries.topic_taxonomy_api_errors&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="26">
            <span class="hits">16</span>
            

            

            <code class="ruby">      taxonomy_tree_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def taxonomy_tree_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="30">
            <span class="hits">16</span>
            

            

            <code class="ruby">      GovukStatsd.time(&quot;registries.topic_taxonomy.request_time&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="31">
            <span class="hits">16</span>
            

            

            <code class="ruby">        fetch_level_one_taxons_from_api.each_with_object({}) do |taxon, taxonomy|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="19" data-linenumber="32">
            <span class="hits">19</span>
            

            

            <code class="ruby">          taxonomy[taxon[&quot;content_id&quot;]] = format_taxon(taxon)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def format_taxon(taxon, parent_id = nil)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="39">
            <span class="hits">55</span>
            

            

            <code class="ruby">        &quot;title&quot; =&gt; taxon[&quot;title&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">        &quot;content_id&quot; =&gt; taxon[&quot;content_id&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">        &quot;children&quot; =&gt; format_child_taxons(taxon),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">        &quot;parent&quot; =&gt; parent_id,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def format_child_taxons(taxon)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="47">
            <span class="hits">55</span>
            

            

            <code class="ruby">      children = taxon.dig(&quot;links&quot;, &quot;child_taxons&quot;) || []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="49">
            <span class="hits">55</span>
            

            

            <code class="ruby">      children</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="36" data-linenumber="50">
            <span class="hits">36</span>
            

            

            <code class="ruby">        .reject { |child_taxon| child_taxon[&quot;phase&quot;] == &quot;alpha&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="36" data-linenumber="51">
            <span class="hits">36</span>
            

            

            <code class="ruby">        .map { |child_taxon| format_taxon(child_taxon, taxon[&quot;content_id&quot;]) }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="36" data-linenumber="52">
            <span class="hits">36</span>
            

            

            <code class="ruby">        .sort_by { |child_taxon| child_taxon[&quot;title&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_level_one_taxons_from_api</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="56">
            <span class="hits">16</span>
            

            

            <code class="ruby">      taxons = fetch_taxon.dig(&quot;links&quot;, &quot;level_one_taxons&quot;) || []</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="57">
            <span class="hits">16</span>
            

            

            <code class="ruby">      taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="19" data-linenumber="58">
            <span class="hits">19</span>
            

            

            <code class="ruby">        .reject { |taxon| taxon[&quot;phase&quot;] == &quot;alpha&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="19" data-linenumber="59">
            <span class="hits">19</span>
            

            

            <code class="ruby">        .sort_by { |taxon| taxon[&quot;title&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="19" data-linenumber="60">
            <span class="hits">19</span>
            

            

            <code class="ruby">        .map { |taxon| fetch_taxon(taxon[&quot;base_path&quot;]) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_taxon(base_path = &quot;/&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="64">
            <span class="hits">35</span>
            

            

            <code class="ruby">      Services.cached_content_item(base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="55df5e93d48064ae99b1c54fc93a9b4f8235a4c8">
  <div class="header">
    <h3>app/lib/registries/topical_events_registry.rb</h3>
    <h4>
      <span class="red">
  52.17%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>23</b> relevant lines.
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class TopicalEventsRegistry &lt; Registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include CacheableRegistry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    delegate :[], to: :topical_events</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def values</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="8">
            
            

            

            <code class="ruby">      topical_events</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            
            

            

            <code class="ruby">      &quot;registries/topical_events&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">      topical_events_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def topical_events</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">      @topical_events ||= fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">      GovukStatsd.increment(&quot;registries.topical_events_api_errors&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def topical_events_as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            
            

            

            <code class="ruby">      GovukStatsd.time(&quot;registries.topical_events.request_time&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="31">
            
            

            

            <code class="ruby">        fetch_topical_events_from_rummager</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">          .reject { |topical_event| topical_event[&quot;slug&quot;].empty? || topical_event[&quot;title&quot;].empty? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">          .each_with_object({}) do |topical_event, topical_events|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            
            

            

            <code class="ruby">            topical_events[topical_event[&quot;slug&quot;]] = { &quot;title&quot; =&gt; topical_event[&quot;title&quot;], &quot;slug&quot; =&gt; topical_event[&quot;slug&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">          end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_topical_events_from_rummager</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">      params = {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="41">
            
            

            

            <code class="ruby">        filter_format: &quot;topical_event&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">        fields: %w[title slug],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">        count: 1500,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">        order: &quot;title&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="46">
            
            

            

            <code class="ruby">      Services.rummager.search(params)[&quot;results&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="cb6b06d36235215b31e98c89b4cd8417726381ca">
  <div class="header">
    <h3>app/lib/registries/world_locations_registry.rb</h3>
    <h4>
      <span class="green">
  95.65%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>23</b> relevant lines.
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class WorldLocationsRegistry &lt; Registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include CacheableRegistry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    delegate :[], to: :cached_locations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="21" data-linenumber="8">
            <span class="hits">21</span>
            

            

            <code class="ruby">      cached_locations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="21" data-linenumber="12">
            <span class="hits">21</span>
            

            

            <code class="ruby">      &quot;#{NAMESPACE}/world_locations&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cacheable_data</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="18">
            <span class="hits">15</span>
            

            

            <code class="ruby">      locations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def report_error</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">      GovukStatsd.increment(&quot;#{NAMESPACE}.world_location_api_errors&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def cached_locations</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="63" data-linenumber="26">
            <span class="hits">63</span>
            

            

            <code class="ruby">      @cached_locations ||= fetch_from_cache</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def locations</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="30">
            <span class="hits">15</span>
            

            

            <code class="ruby">      GovukStatsd.time(&quot;registries.world_locations.request_time&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="45" data-linenumber="31">
            <span class="hits">45</span>
            

            

            <code class="ruby">        fetch_locations.index_by { |hash| hash[&quot;slug&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_locations</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="36">
            <span class="hits">15</span>
            

            

            <code class="ruby">      fetch_locations_from_worldwide_api.map do |result|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="38">
            <span class="hits">30</span>
            

            

            <code class="ruby">          &quot;title&quot; =&gt; result[&quot;title&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">          &quot;slug&quot; =&gt; result.dig(&quot;details&quot;, &quot;slug&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">          &quot;content_id&quot; =&gt; result[&quot;content_id&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_locations_from_worldwide_api</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="46">
            <span class="hits">15</span>
            

            

            <code class="ruby">      Services.worldwide_api.world_locations.with_subsequent_pages.to_a</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ca9a7aa1b87ded74d76a234a486fa77f30dc1876">
  <div class="header">
    <h3>app/lib/search/facet_query_builder.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>16</b> relevant lines.
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Used by Search::QueryBuilder to build the `facet` part of the Rummager</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># search query. This will determine the &quot;facets&quot; Rummager returns.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># For more on facetting, see the Rummager docs:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">#   https://github.com/alphagov/rummager/blob/master/docs/search-api.md</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Search</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class FacetQueryBuilder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def initialize(facets:)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="10">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @facets = facets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def call</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="14">
            <span class="hits">56</span>
            

            

            <code class="ruby">      dynamic_facets.reduce({}) do |query, facet|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">        # TODO: title will only work for Orgs, this key will need changed for</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">        # other dynamic facets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">        #</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">        # &quot;1500,order:value.title&quot; is specifying that we want 1500 results back</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">        # which are ordered by the title attribute of each value (option)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">        # that is returned</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="21">
            <span class="hits">60</span>
            

            

            <code class="ruby">        key = (facet[&quot;filter_key&quot;] || facet[&quot;key&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="22">
            <span class="hits">60</span>
            

            

            <code class="ruby">        query.merge(key =&gt; &quot;1500,order:value.title&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">    attr_reader :facets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def dynamic_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="200" data-linenumber="31">
            <span class="hits">200</span>
            

            

            <code class="ruby">      facets_that_could_be_dynamic.select { |f| f[&quot;allowed_values&quot;].blank? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def facets_that_could_be_dynamic</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="299" data-linenumber="35">
            <span class="hits">299</span>
            

            

            <code class="ruby">      filterable_facets.select { |f| %w[text hidden_clearable].include? f[&quot;type&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def filterable_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="374" data-linenumber="39">
            <span class="hits">374</span>
            

            

            <code class="ruby">      facets.select { |f| f[&quot;filterable&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="12e373d5cd501c31bb691c8ad3c6bc1f4ac7f347">
  <div class="header">
    <h3>app/lib/search/filter_query_builder.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>21</b> relevant lines.
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Used by by Search::QueryBuilder to build the `filter` part of the Rummager</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># search query. This will determine the documents that are returned from rummager.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Search</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class FilterQueryBuilder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def initialize(facets:, user_params:)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="6">
            <span class="hits">112</span>
            

            

            <code class="ruby">      @facets = facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="7">
            <span class="hits">112</span>
            

            

            <code class="ruby">      @user_params = user_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def call</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="11">
            <span class="hits">112</span>
            

            

            <code class="ruby">      filters.select(&amp;:active?).map(&amp;:query_hash).inject({}) do |query, filter_hash|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="42" data-linenumber="12">
            <span class="hits">42</span>
            

            

            <code class="ruby">        query.merge(filter_hash) { |_, v1, v2| Array(v1) + Array(v2) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">    attr_reader :facets, :user_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="673" data-linenumber="21">
            <span class="hits">673</span>
            

            

            <code class="ruby">      facets.select { |f| f[&quot;filterable&quot;] }.map { |f| build_filter(f) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def build_filter(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">      filter_class = {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="243" data-linenumber="26">
            <span class="hits">243</span>
            

            

            <code class="ruby">        &quot;checkbox&quot; =&gt; Filters::CheckboxFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">        &quot;date&quot; =&gt; Filters::DateFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">        &quot;hidden&quot; =&gt; Filters::HiddenFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">        &quot;text&quot; =&gt; Filters::TextFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">        &quot;dropdown_select&quot; =&gt; Filters::DropdownSelectFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">        &quot;topical&quot; =&gt; Filters::TopicalFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">        &quot;taxon&quot; =&gt; Filters::TaxonFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">        &quot;radio&quot; =&gt; Filters::RadioFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">        &quot;content_id&quot; =&gt; Filters::ContentIdFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">        &quot;hidden_clearable&quot; =&gt; Filters::HiddenClearableFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">        &quot;research_and_statistics&quot; =&gt; Filters::ResearchAndStatisticsFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">        &quot;official_documents&quot; =&gt; Filters::OfficialDocumentsFilter,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">      }.fetch(facet[&quot;type&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="243" data-linenumber="40">
            <span class="hits">243</span>
            

            

            <code class="ruby">      filter_class.new(facet, params(facet))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def params(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="243" data-linenumber="44">
            <span class="hits">243</span>
            

            

            <code class="ruby">      facet_key = facet[&quot;key&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="243" data-linenumber="45">
            <span class="hits">243</span>
            

            

            <code class="ruby">      facet_keys = facet[&quot;keys&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="243" data-linenumber="47">
            <span class="hits">243</span>
            

            

            <code class="ruby">      if facet_keys</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="75" data-linenumber="48">
            <span class="hits">75</span>
            

            

            <code class="ruby">        return facet_keys.index_with { |key| user_params.fetch(key, nil) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="218" data-linenumber="51">
            <span class="hits">218</span>
            

            

            <code class="ruby">      user_params.fetch(facet_key, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="aff2e7df3b9ede76cd3808d92540af8397481953">
  <div class="header">
    <h3>app/lib/search/order_query_builder.rb</h3>
    <h4>
      <span class="green">
  96.08%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>51</b> relevant lines.
      <span class="green"><b>49</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Search</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class OrderQueryBuilder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def initialize(content_item, keywords, params, override_sort_for_feed: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="4">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="5">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @params = params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="6">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @keywords = keywords</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="7">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @override_sort_for_feed = override_sort_for_feed</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def call</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="11">
            <span class="hits">56</span>
            

            

            <code class="ruby">      return order_by_release_timestamp if sort_option.present? &amp;&amp; order_by_release_timestamp?(sort_option)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="13">
            <span class="hits">56</span>
            

            

            <code class="ruby">      return order_by_public_timestamp if override_sort_for_feed</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="14">
            <span class="hits">55</span>
            

            

            <code class="ruby">      return order_by_public_timestamp if sort_option.present? &amp;&amp; order_by_public_timestamp?(sort_option)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="16">
            <span class="hits">55</span>
            

            

            <code class="ruby">      return order_by_relevance_query if sort_option.present? &amp;&amp; order_by_relevance?(sort_option)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="52" data-linenumber="18">
            <span class="hits">52</span>
            

            

            <code class="ruby">      return order_by_relevance_query if keywords.present? &amp;&amp; sort_option.present? &amp;&amp; order_by_popularity?(sort_option)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="52" data-linenumber="20">
            <span class="hits">52</span>
            

            

            <code class="ruby">      return order_by_sort_option_query if sort_option.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="22">
            <span class="hits">14</span>
            

            

            <code class="ruby">      return order_by_relevance_query if keywords.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="24">
            <span class="hits">14</span>
            

            

            <code class="ruby">      order_by_default_order_query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    attr_reader :content_item, :params, :keywords, :override_sort_for_feed</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_by_relevance?(sort_option)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="41" data-linenumber="32">
            <span class="hits">41</span>
            

            

            <code class="ruby">      %w[relevance -relevance topic -topic].include?(sort_option.dig(&quot;key&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_by_popularity?(sort_option)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="36">
            <span class="hits">4</span>
            

            

            <code class="ruby">      %w[popularity -popularity].include?(sort_option.dig(&quot;key&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def public_timestamp_unsupported</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="40">
            <span class="hits">32</span>
            

            

            <code class="ruby">      %w[upcoming_statistics cancelled_statistics].include?(params[&quot;content_store_document_type&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def release_timestamp_unsupported</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">      %w[published_statistics research].include?(params[&quot;content_store_document_type&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_by_release_timestamp?(sort_option)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="42" data-linenumber="48">
            <span class="hits">42</span>
            

            

            <code class="ruby">      public_timestamp_chosen = %w[-public_timestamp public_timestamp].include?(sort_option.dig(&quot;key&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="42" data-linenumber="49">
            <span class="hits">42</span>
            

            

            <code class="ruby">      public_timestamp_chosen &amp;&amp; public_timestamp_unsupported</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="52">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_by_public_timestamp?(sort_option)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="41" data-linenumber="53">
            <span class="hits">41</span>
            

            

            <code class="ruby">      release_timestamp_chosen = %w[-release_timestamp release_timestamp].include?(sort_option.dig(&quot;key&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="41" data-linenumber="54">
            <span class="hits">41</span>
            

            

            <code class="ruby">      release_timestamp_chosen &amp;&amp; release_timestamp_unsupported</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_by_public_timestamp</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="58">
            <span class="hits">1</span>
            

            

            <code class="ruby">      { &quot;order&quot; =&gt; &quot;-public_timestamp&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="61">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_by_release_timestamp</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="62">
            
            

            

            <code class="ruby">      { &quot;order&quot; =&gt; &quot;-release_timestamp&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="65">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_by_relevance_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="66">
            <span class="hits">3</span>
            

            

            <code class="ruby">      {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="69">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_by_default_order_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="70">
            <span class="hits">14</span>
            

            

            <code class="ruby">      { &quot;order&quot; =&gt; default_order }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="73">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_by_sort_option_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="38" data-linenumber="74">
            <span class="hits">38</span>
            

            

            <code class="ruby">      { &quot;order&quot; =&gt; sort_option[&quot;key&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="77">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="734" data-linenumber="78">
            <span class="hits">734</span>
            

            

            <code class="ruby">      @order_presenter ||= content_item.sorter_class.new(content_item, params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="81">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def sort_option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="388" data-linenumber="82">
            <span class="hits">388</span>
            

            

            <code class="ruby">      return if order_presenter.sort_options.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="332" data-linenumber="84">
            <span class="hits">332</span>
            

            

            <code class="ruby">      order_presenter.selected_option</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="87">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def default_order</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="88">
            <span class="hits">14</span>
            

            

            <code class="ruby">      if order_presenter.default_option</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="89">
            
            

            

            <code class="ruby">        order_presenter.default_option[&quot;key&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="91">
            <span class="hits">14</span>
            

            

            <code class="ruby">        content_item.default_order</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="1c8f1a021533609a72fac3157d5f5b7f2ac6659d">
  <div class="header">
    <h3>app/lib/search/query.rb</h3>
    <h4>
      <span class="red">
  62.22%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>45</b> relevant lines.
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>17</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Facade that speaks to rummager. Combines a content item with</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># search results from rummager.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Search</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class Query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include ActiveModel::Validations</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    attr_reader :filter_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    validate do |query|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="10">
            <span class="hits">68</span>
            

            

            <code class="ruby">      ParamValidator.new(query).validate</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def initialize(content_item, filter_params, ab_params: {}, override_sort_for_feed: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="14">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="15">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @filter_params = filter_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="16">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @ab_params = ab_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="17">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @override_sort_for_feed = override_sort_for_feed</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">      @order =</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="19">
            <span class="hits">56</span>
            

            

            <code class="ruby">        if override_sort_for_feed</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">          &quot;most-recent&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">        else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="22">
            <span class="hits">55</span>
            

            

            <code class="ruby">          filter_params[&quot;order&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def search_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="273" data-linenumber="27">
            <span class="hits">273</span>
            

            

            <code class="ruby">      @search_results ||= fetch_search_response(content_item)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def errors_hash</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="31">
            
            

            

            <code class="ruby">      ParamValidator.new(self).errors_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">    attr_reader :ab_params, :override_sort_for_feed, :content_item</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def merge_and_deduplicate(search_response)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            
            

            

            <code class="ruby">      results = search_response.fetch(&quot;results&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="41">
            
            

            

            <code class="ruby">      return results[0] if results.count == 1</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">      # This currently doesn&#39;t handle more complex features such as pagination.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">      # The only finder where the facets work as an OR filter</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">      # doesn&#39;t use pagination and there aren&#39;t enough documents it to be</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">      # important. The results are sorted here because they are only</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">      # sorted by Rummager within the results of each query.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="49">
            
            

            

            <code class="ruby">      all_unique_results = results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="50">
            
            

            

            <code class="ruby">        .flat_map { |hash| hash[&quot;results&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="51">
            
            

            

            <code class="ruby">        .uniq { |hash| hash[&quot;_id&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="53">
            
            

            

            <code class="ruby">        &quot;results&quot; =&gt; sort_batch_results(all_unique_results),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">        &quot;total&quot; =&gt; all_unique_results.count,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">        &quot;start&quot; =&gt; 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="59">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def sort_batch_results(raw_results)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="60">
            
            

            

            <code class="ruby">      case @order</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">      when &quot;most-viewed&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="62">
            
            

            

            <code class="ruby">        raw_results.sort_by { |hash| hash[&quot;popularity&quot;] }.reverse</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">      when &quot;most-recent&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="64">
            
            

            

            <code class="ruby">        raw_results.sort_by { |hash| hash[&quot;public_timestamp&quot;] }.reverse</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">      when &quot;a-to-z&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="66">
            
            

            

            <code class="ruby">        raw_results.sort_by { |hash| hash[&quot;title&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="68">
            
            

            

            <code class="ruby">        sort_by_relevance(raw_results)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="72">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def sort_by_relevance(raw_results)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="73">
            
            

            

            <code class="ruby">      return raw_results unless relevance_scores_exist?(raw_results)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="75">
            
            

            

            <code class="ruby">      raw_results.sort_by { |hash| hash[&quot;combined_score&quot;] || hash[&quot;es_score&quot;] }.reverse</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="78">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def relevance_scores_exist?(results)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="79">
            
            

            

            <code class="ruby">      results.all? { |result| (result[&quot;combined_score&quot;] || result[&quot;es_score&quot;]).present? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="82">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def fetch_search_response(content_item)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="83">
            <span class="hits">56</span>
            

            

            <code class="ruby">      queries = QueryBuilder.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">        finder_content_item: content_item,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby">        params: filter_params,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">        ab_params: ab_params,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">        override_sort_for_feed: override_sort_for_feed,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby">      ).call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="90">
            <span class="hits">56</span>
            

            

            <code class="ruby">      if queries.one?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="91">
            <span class="hits">56</span>
            

            

            <code class="ruby">        GovukStatsd.time(&quot;rummager.finder_search&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="92">
            <span class="hits">56</span>
            

            

            <code class="ruby">          Services.rummager.search(queries.first).to_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="95">
            
            

            

            <code class="ruby">        GovukStatsd.time(&quot;rummager.finder_batch_search&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="96">
            
            

            

            <code class="ruby">          merge_and_deduplicate(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">            Services.rummager.batch_search(queries).to_hash,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">          )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="103">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ab0d1b9eaa2fd10f00ef2028ba84120415a9887e">
  <div class="header">
    <h3>app/lib/search/query_builder.rb</h3>
    <h4>
      <span class="yellow">
  89.9%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>99</b> relevant lines.
      <span class="green"><b>89</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Search::QueryBuilder takes the content item for the finder and the query params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># from the URL to generate a query for Search API.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Search</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class QueryBuilder</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    # search-api rejects queries which are longer than this, but an</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">    # error page isn&#39;t a good experience for users.  There are some</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">    # legitimate queries over this length (people typing a length</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">    # question into the search box), so rather than give them an error</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    # page just give them (probably unhelpful) results.  At some point</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    # we shall do UI work to direct people who enter a long query to the</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">    # contact form, as even an untruncated long query isn&#39;t going to</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">    # find anything useful, too much noise.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">    MAX_QUERY_LENGTH = 512</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def initialize(finder_content_item:, params: {}, ab_params: {}, override_sort_for_feed: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="16">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @finder_content_item = finder_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="17">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @params = params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="18">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @ab_params = ab_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="19">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @override_sort_for_feed = override_sort_for_feed</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">      base_query = [</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="24">
            <span class="hits">56</span>
            

            

            <code class="ruby">        pagination_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">        return_fields_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">        keyword_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">        base_filter_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">        reject_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">        order_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">        facet_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">        debug_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">        ab_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">        suggest_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">      ].reduce(&amp;:merge)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="36">
            <span class="hits">56</span>
            

            

            <code class="ruby">      return [base_query] if filter_queries.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="38">
            <span class="hits">30</span>
            

            

            <code class="ruby">      filter_queries.map do |query|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="39">
            <span class="hits">30</span>
            

            

            <code class="ruby">        base_query.clone.merge(query)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">  private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            <span class="hits">1</span>
            

            

            <code class="ruby">    attr_reader :finder_content_item, :params, :ab_params, :override_sort_for_feed</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def pagination_query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="49">
            <span class="hits">56</span>
            

            

            <code class="ruby">        &quot;count&quot; =&gt; documents_per_page,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">        &quot;start&quot; =&gt; pagination_start,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def pagination_start</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="55">
            <span class="hits">56</span>
            

            

            <code class="ruby">      documents_per_page * (current_page - 1) || 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="58">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def current_page</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="59">
            <span class="hits">56</span>
            

            

            <code class="ruby">      [params[&quot;page&quot;].to_i, 1].max</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="62">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def documents_per_page</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="63">
            <span class="hits">112</span>
            

            

            <code class="ruby">      finder_content_item.default_documents_per_page</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="66">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def return_fields_query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="68">
            <span class="hits">56</span>
            

            

            <code class="ruby">        &quot;fields&quot; =&gt; return_fields.join(&quot;,&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="72">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def return_fields</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="73">
            <span class="hits">56</span>
            

            

            <code class="ruby">      (base_return_fields + metadata_fields).uniq</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="76">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def base_return_fields</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">      %w[</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="78">
            <span class="hits">56</span>
            

            

            <code class="ruby">        title</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">        link</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">        description_with_highlighting</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">        public_timestamp</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby">        popularity</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby">        content_purpose_supergroup</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">        content_store_document_type</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby">        format</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">        is_historic</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">        government_name</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby">        content_id</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">        parts</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">      ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="93">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def metadata_fields</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="94">
            <span class="hits">56</span>
            

            

            <code class="ruby">      raw_facets.map do |f|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="318" data-linenumber="95">
            <span class="hits">318</span>
            

            

            <code class="ruby">        unfilterise(f[&quot;filter_key&quot;] || f[&quot;key&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="99">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def raw_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="224" data-linenumber="100">
            <span class="hits">224</span>
            

            

            <code class="ruby">      finder_content_item.raw_facets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="103">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def unfilterise(field = &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">      # Removes filter-y prefixes from facet keys.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby">      # For example, filter_x or filter_all_x will become x.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="318" data-linenumber="106">
            <span class="hits">318</span>
            

            

            <code class="ruby">      field.gsub(/^(?&#39;full_name&#39;(?&#39;operation&#39;filter|reject|any|all)_(?:(?&#39;multivalue_query&#39;any|all)_)?(?&#39;name&#39;.*))$/, &#39;\k&lt;name&gt;&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="107">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="108">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="109">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def order_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="110">
            <span class="hits">56</span>
            

            

            <code class="ruby">      OrderQueryBuilder.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            
            

            

            <code class="ruby">        finder_content_item,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            
            

            

            <code class="ruby">        keywords,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="113">
            
            

            

            <code class="ruby">        params,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="114">
            
            

            

            <code class="ruby">        override_sort_for_feed: override_sort_for_feed,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="115">
            
            

            

            <code class="ruby">      ).call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="117">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="118">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def keyword_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="119">
            <span class="hits">56</span>
            

            

            <code class="ruby">      keywords ? { &quot;q&quot; =&gt; keywords[0, MAX_QUERY_LENGTH] } : {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="120">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="121">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="122">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def keywords</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="116" data-linenumber="123">
            <span class="hits">116</span>
            

            

            <code class="ruby">      return remove_stopwords if remove_stopwords?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="124">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="116" data-linenumber="125">
            <span class="hits">116</span>
            

            

            <code class="ruby">      params[&quot;keywords&quot;].presence</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="126">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="127">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="128">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def remove_stopwords?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="116" data-linenumber="129">
            <span class="hits">116</span>
            

            

            <code class="ruby">      params[&quot;keywords&quot;].present? &amp;&amp; [&quot;/find-eu-exit-guidance-business&quot;].include?(finder_content_item.base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="130">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="131">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="132">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def remove_stopwords</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="133">
            
            

            

            <code class="ruby">      keywords = params[&quot;keywords&quot;].split(&quot; &quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="134">
            
            

            

            <code class="ruby">      keywords.delete_if do |keyword|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="135">
            
            

            

            <code class="ruby">        stopwords.include?(keyword.downcase.gsub(/\W/, &quot;&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="136">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="137">
            
            

            

            <code class="ruby">      keywords.join(&quot; &quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="138">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="139">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="140">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def base_filter_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="141">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @base_filter_query ||= base_filter.each_with_object({}) do |(k, v), query|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="48" data-linenumber="142">
            <span class="hits">48</span>
            

            

            <code class="ruby">        query[&quot;filter_#{k}&quot;] = v</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="143">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="144">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="145">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="146">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def and_filter_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="146" data-linenumber="147">
            <span class="hits">146</span>
            

            

            <code class="ruby">      @and_filter_query ||= and_filter_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="148">
            
            

            

            <code class="ruby">        .each_with_object({}) do |(k, v), query|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="41" data-linenumber="149">
            <span class="hits">41</span>
            

            

            <code class="ruby">          query[&quot;filter_#{k}&quot;] = v</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="150">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="151">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="152">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="153">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def and_filter_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="154">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @and_filter_params ||= FilterQueryBuilder.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="155">
            
            

            

            <code class="ruby">        facets: and_facets,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="156">
            
            

            

            <code class="ruby">        user_params: params,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="157">
            
            

            

            <code class="ruby">      ).call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="158">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="159">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="160">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def and_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="161">
            <span class="hits">56</span>
            

            

            <code class="ruby">      raw_facets.select do |facet|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="318" data-linenumber="162">
            <span class="hits">318</span>
            

            

            <code class="ruby">        facet.fetch(&quot;combine_mode&quot;, &quot;and&quot;) == &quot;and&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="163">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="164">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="165">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="166">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def or_filter_queries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="86" data-linenumber="167">
            <span class="hits">86</span>
            

            

            <code class="ruby">      @or_filter_queries ||= or_filter_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="168">
            
            

            

            <code class="ruby">        .map do |k, v|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="169">
            
            

            

            <code class="ruby">          { &quot;filter_#{k}&quot; =&gt; v }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="170">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="171">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="172">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="173">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def or_filter_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="174">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @or_filter_params ||= FilterQueryBuilder.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="175">
            
            

            

            <code class="ruby">        facets: or_facets,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="176">
            
            

            

            <code class="ruby">        user_params: params,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="177">
            
            

            

            <code class="ruby">      ).call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="178">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="179">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="180">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def or_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="181">
            <span class="hits">56</span>
            

            

            <code class="ruby">      raw_facets.select do |facet|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="318" data-linenumber="182">
            <span class="hits">318</span>
            

            

            <code class="ruby">        facet.fetch(&quot;combine_mode&quot;, &quot;and&quot;) == &quot;or&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="183">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="184">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="185">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="186">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def filter_queries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="86" data-linenumber="187">
            <span class="hits">86</span>
            

            

            <code class="ruby">      (and_filter_query.empty? ? [] : [and_filter_query]) + or_filter_queries</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="188">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="189">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="190">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def reject_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="191">
            <span class="hits">56</span>
            

            

            <code class="ruby">      base_reject.reduce({}) do |query, (k, v)|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="192">
            
            

            

            <code class="ruby">        query.merge(&quot;reject_#{k}&quot; =&gt; v)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="193">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="194">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="195">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="196">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def base_filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="197">
            <span class="hits">56</span>
            

            

            <code class="ruby">      finder_content_item.filter</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="198">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="199">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="200">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def base_reject</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="201">
            <span class="hits">56</span>
            

            

            <code class="ruby">      finder_content_item.reject</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="202">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="203">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="204">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def facet_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="205">
            <span class="hits">56</span>
            

            

            <code class="ruby">      dynamic_facet_params = facets_not_overridden_by_registries(facet_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="206">
            <span class="hits">56</span>
            

            

            <code class="ruby">      count_dynamic_facets(dynamic_facet_params.keys)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="207">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="208">
            <span class="hits">56</span>
            

            

            <code class="ruby">      dynamic_facet_params.reduce({}) { |query, (k, v)| query.merge(&quot;facet_#{k}&quot; =&gt; v) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="209">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="210">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="211">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def facets_not_overridden_by_registries(facet_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="116" data-linenumber="212">
            <span class="hits">116</span>
            

            

            <code class="ruby">      facet_params.reject { |k, _v| Services.registries.all.key?(k) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="213">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="214">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="215">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def count_dynamic_facets(facet_names)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="216">
            <span class="hits">56</span>
            

            

            <code class="ruby">      facet_names.each do |name|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="217">
            
            

            

            <code class="ruby">        GovukStatsd.increment &quot;search_with_#{name}_facet&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="218">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="219">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="220">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="221">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def facet_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="222">
            <span class="hits">56</span>
            

            

            <code class="ruby">      @facet_params ||= FacetQueryBuilder.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="223">
            
            

            

            <code class="ruby">        facets: raw_facets,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="224">
            
            

            

            <code class="ruby">      ).call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="225">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="226">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="227">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def debug_query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="228">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="229">
            <span class="hits">56</span>
            

            

            <code class="ruby">        &quot;debug&quot; =&gt; params[&quot;debug&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="230">
            
            

            

            <code class="ruby">      }.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="231">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="232">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="233">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def ab_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="234">
            <span class="hits">56</span>
            

            

            <code class="ruby">      ab_params.any? ? { &quot;ab_tests&quot; =&gt; ab_params.map { |k, v| &quot;#{k}:#{v}&quot; }.join(&quot;,&quot;) } : {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="235">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="236">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="237">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def suggest_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="238">
            <span class="hits">56</span>
            

            

            <code class="ruby">      { &quot;suggest&quot; =&gt; &quot;spelling_with_highlighting&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="239">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="240">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="241">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def stopwords</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="242">
            
            

            

            <code class="ruby">      generic_stopwords = %w[</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="243">
            
            

            

            <code class="ruby">        a</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="244">
            
            

            

            <code class="ruby">        about</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="245">
            
            

            

            <code class="ruby">        above</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="246">
            
            

            

            <code class="ruby">        after</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="247">
            
            

            

            <code class="ruby">        again</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="248">
            
            

            

            <code class="ruby">        against</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="249">
            
            

            

            <code class="ruby">        all</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="250">
            
            

            

            <code class="ruby">        am</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="251">
            
            

            

            <code class="ruby">        an</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="252">
            
            

            

            <code class="ruby">        and</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="253">
            
            

            

            <code class="ruby">        any</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="254">
            
            

            

            <code class="ruby">        are</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="255">
            
            

            

            <code class="ruby">        arent</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="256">
            
            

            

            <code class="ruby">        as</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="257">
            
            

            

            <code class="ruby">        at</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="258">
            
            

            

            <code class="ruby">        be</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="259">
            
            

            

            <code class="ruby">        because</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="260">
            
            

            

            <code class="ruby">        been</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="261">
            
            

            

            <code class="ruby">        before</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="262">
            
            

            

            <code class="ruby">        being</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="263">
            
            

            

            <code class="ruby">        below</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="264">
            
            

            

            <code class="ruby">        between</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="265">
            
            

            

            <code class="ruby">        both</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="266">
            
            

            

            <code class="ruby">        but</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="267">
            
            

            

            <code class="ruby">        by</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="268">
            
            

            

            <code class="ruby">        cant</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="269">
            
            

            

            <code class="ruby">        cannot</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="270">
            
            

            

            <code class="ruby">        could</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="271">
            
            

            

            <code class="ruby">        couldnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="272">
            
            

            

            <code class="ruby">        did</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="273">
            
            

            

            <code class="ruby">        didnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="274">
            
            

            

            <code class="ruby">        do</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="275">
            
            

            

            <code class="ruby">        does</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="276">
            
            

            

            <code class="ruby">        doesnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="277">
            
            

            

            <code class="ruby">        doing</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="278">
            
            

            

            <code class="ruby">        dont</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="279">
            
            

            

            <code class="ruby">        down</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="280">
            
            

            

            <code class="ruby">        during</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="281">
            
            

            

            <code class="ruby">        each</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="282">
            
            

            

            <code class="ruby">        few</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="283">
            
            

            

            <code class="ruby">        for</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="284">
            
            

            

            <code class="ruby">        from</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="285">
            
            

            

            <code class="ruby">        further</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="286">
            
            

            

            <code class="ruby">        had</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="287">
            
            

            

            <code class="ruby">        hadnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="288">
            
            

            

            <code class="ruby">        has</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="289">
            
            

            

            <code class="ruby">        hasnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="290">
            
            

            

            <code class="ruby">        have</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="291">
            
            

            

            <code class="ruby">        havent</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="292">
            
            

            

            <code class="ruby">        having</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="293">
            
            

            

            <code class="ruby">        he</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="294">
            
            

            

            <code class="ruby">        hed</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="295">
            
            

            

            <code class="ruby">        hell</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="296">
            
            

            

            <code class="ruby">        hes</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="297">
            
            

            

            <code class="ruby">        her</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="298">
            
            

            

            <code class="ruby">        here</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="299">
            
            

            

            <code class="ruby">        heres</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="300">
            
            

            

            <code class="ruby">        hers</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="301">
            
            

            

            <code class="ruby">        herself</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="302">
            
            

            

            <code class="ruby">        him</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="303">
            
            

            

            <code class="ruby">        himself</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="304">
            
            

            

            <code class="ruby">        his</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="305">
            
            

            

            <code class="ruby">        how</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="306">
            
            

            

            <code class="ruby">        hows</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="307">
            
            

            

            <code class="ruby">        i</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="308">
            
            

            

            <code class="ruby">        id</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="309">
            
            

            

            <code class="ruby">        ill</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="310">
            
            

            

            <code class="ruby">        im</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="311">
            
            

            

            <code class="ruby">        ive</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="312">
            
            

            

            <code class="ruby">        if</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="313">
            
            

            

            <code class="ruby">        in</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="314">
            
            

            

            <code class="ruby">        into</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="315">
            
            

            

            <code class="ruby">        is</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="316">
            
            

            

            <code class="ruby">        isnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="317">
            
            

            

            <code class="ruby">        it</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="318">
            
            

            

            <code class="ruby">        its</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="319">
            
            

            

            <code class="ruby">        itself</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="320">
            
            

            

            <code class="ruby">        lets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="321">
            
            

            

            <code class="ruby">        me</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="322">
            
            

            

            <code class="ruby">        more</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="323">
            
            

            

            <code class="ruby">        most</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="324">
            
            

            

            <code class="ruby">        mustnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="325">
            
            

            

            <code class="ruby">        my</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="326">
            
            

            

            <code class="ruby">        myself</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="327">
            
            

            

            <code class="ruby">        no</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="328">
            
            

            

            <code class="ruby">        nor</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="329">
            
            

            

            <code class="ruby">        not</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="330">
            
            

            

            <code class="ruby">        of</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="331">
            
            

            

            <code class="ruby">        off</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="332">
            
            

            

            <code class="ruby">        on</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="333">
            
            

            

            <code class="ruby">        once</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="334">
            
            

            

            <code class="ruby">        only</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="335">
            
            

            

            <code class="ruby">        or</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="336">
            
            

            

            <code class="ruby">        other</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="337">
            
            

            

            <code class="ruby">        ought</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="338">
            
            

            

            <code class="ruby">        our</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="339">
            
            

            

            <code class="ruby">        ours</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="340">
            
            

            

            <code class="ruby">        ourselves</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="341">
            
            

            

            <code class="ruby">        out</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="342">
            
            

            

            <code class="ruby">        over</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="343">
            
            

            

            <code class="ruby">        own</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="344">
            
            

            

            <code class="ruby">        same</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="345">
            
            

            

            <code class="ruby">        shant</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="346">
            
            

            

            <code class="ruby">        she</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="347">
            
            

            

            <code class="ruby">        shed</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="348">
            
            

            

            <code class="ruby">        shell</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="349">
            
            

            

            <code class="ruby">        shes</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="350">
            
            

            

            <code class="ruby">        should</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="351">
            
            

            

            <code class="ruby">        shouldnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="352">
            
            

            

            <code class="ruby">        so</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="353">
            
            

            

            <code class="ruby">        some</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="354">
            
            

            

            <code class="ruby">        such</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="355">
            
            

            

            <code class="ruby">        than</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="356">
            
            

            

            <code class="ruby">        that</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="357">
            
            

            

            <code class="ruby">        thats</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="358">
            
            

            

            <code class="ruby">        the</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="359">
            
            

            

            <code class="ruby">        their</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="360">
            
            

            

            <code class="ruby">        theirs</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="361">
            
            

            

            <code class="ruby">        them</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="362">
            
            

            

            <code class="ruby">        themselves</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="363">
            
            

            

            <code class="ruby">        then</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="364">
            
            

            

            <code class="ruby">        there</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="365">
            
            

            

            <code class="ruby">        theres</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="366">
            
            

            

            <code class="ruby">        these</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="367">
            
            

            

            <code class="ruby">        they</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="368">
            
            

            

            <code class="ruby">        theyd</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="369">
            
            

            

            <code class="ruby">        theyll</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="370">
            
            

            

            <code class="ruby">        theyre</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="371">
            
            

            

            <code class="ruby">        theyve</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="372">
            
            

            

            <code class="ruby">        this</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="373">
            
            

            

            <code class="ruby">        those</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="374">
            
            

            

            <code class="ruby">        through</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="375">
            
            

            

            <code class="ruby">        to</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="376">
            
            

            

            <code class="ruby">        too</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="377">
            
            

            

            <code class="ruby">        under</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="378">
            
            

            

            <code class="ruby">        until</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="379">
            
            

            

            <code class="ruby">        up</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="380">
            
            

            

            <code class="ruby">        very</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="381">
            
            

            

            <code class="ruby">        was</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="382">
            
            

            

            <code class="ruby">        wasnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="383">
            
            

            

            <code class="ruby">        we</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="384">
            
            

            

            <code class="ruby">        wed</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="385">
            
            

            

            <code class="ruby">        well</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="386">
            
            

            

            <code class="ruby">        were</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="387">
            
            

            

            <code class="ruby">        werent</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="388">
            
            

            

            <code class="ruby">        weve</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="389">
            
            

            

            <code class="ruby">        what</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="390">
            
            

            

            <code class="ruby">        whats</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="391">
            
            

            

            <code class="ruby">        when</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="392">
            
            

            

            <code class="ruby">        whens</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="393">
            
            

            

            <code class="ruby">        where</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="394">
            
            

            

            <code class="ruby">        wheres</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="395">
            
            

            

            <code class="ruby">        which</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="396">
            
            

            

            <code class="ruby">        while</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="397">
            
            

            

            <code class="ruby">        who</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="398">
            
            

            

            <code class="ruby">        whos</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="399">
            
            

            

            <code class="ruby">        whom</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="400">
            
            

            

            <code class="ruby">        why</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="401">
            
            

            

            <code class="ruby">        whys</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="402">
            
            

            

            <code class="ruby">        with</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="403">
            
            

            

            <code class="ruby">        wont</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="404">
            
            

            

            <code class="ruby">        would</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="405">
            
            

            

            <code class="ruby">        wouldnt</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="406">
            
            

            

            <code class="ruby">        you</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="407">
            
            

            

            <code class="ruby">        youd</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="408">
            
            

            

            <code class="ruby">        youll</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="409">
            
            

            

            <code class="ruby">        youre</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="410">
            
            

            

            <code class="ruby">        youve</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="411">
            
            

            

            <code class="ruby">        your</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="412">
            
            

            

            <code class="ruby">        yours</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="413">
            
            

            

            <code class="ruby">        yourself</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="414">
            
            

            

            <code class="ruby">        yourselves</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="415">
            
            

            

            <code class="ruby">      ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="416">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="417">
            
            

            

            <code class="ruby">      brexit_stopwords = %w[abroad brexit eu europe european exit leave union]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="418">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="419">
            
            

            

            <code class="ruby">      (generic_stopwords + brexit_stopwords).uniq</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="420">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="421">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="422">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="d6ced3fabb6cda63c64ce8ea3d8294b600e63c26">
  <div class="header">
    <h3>app/lib/services.rb</h3>
    <h4>
      <span class="yellow">
  86.36%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>22</b> relevant lines.
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;gds_api/content_store&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;gds_api/search&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;gds_api/email_alert_api&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Services</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.content_store</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="98" data-linenumber="7">
            <span class="hits">98</span>
            

            

            <code class="ruby">    GdsApi::ContentStore.new(Plek.find(&quot;content-store&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.cached_content_item(base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="152" data-linenumber="11">
            <span class="hits">152</span>
            

            

            <code class="ruby">    Rails.cache.fetch(&quot;finder-frontend_content_items#{base_path}&quot;, expires_in: 5.minutes) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="98" data-linenumber="12">
            <span class="hits">98</span>
            

            

            <code class="ruby">      GovukStatsd.time(&quot;content_store.fetch_request_time&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="98" data-linenumber="13">
            <span class="hits">98</span>
            

            

            <code class="ruby">        content_store.content_item(base_path).to_h</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.rummager</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="85" data-linenumber="19">
            <span class="hits">85</span>
            

            

            <code class="ruby">    GdsApi::Search.new(Plek.find(&quot;search&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.email_alert_api</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">    Services::EmailAlertApi.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.worldwide_api</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="27">
            <span class="hits">15</span>
            

            

            <code class="ruby">    GdsApi.worldwide</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.registries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="31">
            <span class="hits">157</span>
            

            

            <code class="ruby">    Registries::BaseRegistries.new</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.accounts_api</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="35">
            
            

            

            <code class="ruby">    Plek.find(&quot;account-manager&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.oidc</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            
            

            

            <code class="ruby">    @oidc ||= OidcClient.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">      accounts_api,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">      ENV.fetch(&quot;GOVUK_ACCOUNT_OAUTH_CLIENT_ID&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">      ENV.fetch(&quot;GOVUK_ACCOUNT_OAUTH_CLIENT_SECRET&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="65b6df5db53621bed6bd96487fcac74306b33cec">
  <div class="header">
    <h3>app/lib/url_builder.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>8</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># The UrlBuilder class is responsible for creating URLs to be rendered as</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># HTML links.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">class UrlBuilder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(path, query_params = {})</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="108" data-linenumber="5">
            <span class="hits">108</span>
            

            

            <code class="ruby">    @path = path</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="108" data-linenumber="6">
            <span class="hits">108</span>
            

            

            <code class="ruby">    @query_params = query_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def url(additional_params = {})</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    [</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="11">
            <span class="hits">60</span>
            

            

            <code class="ruby">      path,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">      query_params.merge(additional_params).to_query,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">    ].reject(&amp;:blank?).join(&quot;?&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :path, :query_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="23a34640937c6e84fe75ba6d87658ac17fe09386">
  <div class="header">
    <h3>app/models/checkbox_facet.rb</h3>
    <h4>
      <span class="green">
  95.24%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>21</b> relevant lines.
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class CheckboxFacet &lt; FilterableFacet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(facet, checked)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="3">
            <span class="hits">18</span>
            

            

            <code class="ruby">    @checked = checked</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="4">
            <span class="hits">18</span>
            

            

            <code class="ruby">    super(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sentence_fragment</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="8">
            <span class="hits">12</span>
            

            

            <code class="ruby">    return nil unless is_checked?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="11">
            <span class="hits">12</span>
            

            

            <code class="ruby">      &quot;key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">      &quot;preposition&quot; =&gt; preposition,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">      &quot;values&quot; =&gt; [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">        &quot;label&quot; =&gt; short_name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">        &quot;parameter_key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">        &quot;value&quot; =&gt; value,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">      }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">      &quot;word_connectors&quot; =&gt; and_word_connectors,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="94" data-linenumber="23">
            <span class="hits">94</span>
            

            

            <code class="ruby">    is_checked?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="27">
            <span class="hits">54</span>
            

            

            <code class="ruby">    facet[&quot;filter_value&quot;] || true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def is_checked?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="124" data-linenumber="31">
            <span class="hits">124</span>
            

            

            <code class="ruby">    @checked.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def checkbox_label</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="35">
            
            

            

            <code class="ruby">    facet[&quot;name&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def id</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="39">
            <span class="hits">18</span>
            

            

            <code class="ruby">    &quot;checkbox_facet-#{key}_#{value}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def data</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="18" data-linenumber="44">
            <span class="hits">18</span>
            

            

            <code class="ruby">      track_category: &quot;filterClicked&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">      uncheck_track_category: &quot;filterRemoved&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">      track_action: &quot;checkboxFacet&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">      track_label: name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="51">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def query_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="52">
            <span class="hits">6</span>
            

            

            <code class="ruby">    @checked ? { key =&gt; value } : {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2a3eddd65d416f5785c39e0a83a14a63325930d9">
  <div class="header">
    <h3>app/models/content_item.rb</h3>
    <h4>
      <span class="green">
  97.5%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>80</b> relevant lines.
      <span class="green"><b>78</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class ContentItem</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  BREXIT_CONTENT_ID = &quot;d6c2de5d-ef90-45d1-82d4-5f2438369eea&quot;.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(content_item_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="5">
            <span class="hits">60</span>
            

            

            <code class="ruby">    @content_item_hash = content_item_hash.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.from_content_store(base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="9">
            <span class="hits">60</span>
            

            

            <code class="ruby">    content_item_hash = Services.cached_content_item(base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="10">
            <span class="hits">60</span>
            

            

            <code class="ruby">    new(content_item_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def as_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="218" data-linenumber="14">
            <span class="hits">218</span>
            

            

            <code class="ruby">    content_item_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def is_search?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">    document_type == &quot;search&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def is_finder?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="22">
            <span class="hits">55</span>
            

            

            <code class="ruby">    document_type == &quot;finder&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def is_redirect?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">    document_type == &quot;redirect&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def description</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="108" data-linenumber="30">
            <span class="hits">108</span>
            

            

            <code class="ruby">    content_item_hash[&quot;description&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def links</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="34">
            <span class="hits">54</span>
            

            

            <code class="ruby">    content_item_hash[&quot;links&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def title</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="643" data-linenumber="38">
            <span class="hits">643</span>
            

            

            <code class="ruby">    content_item_hash[&quot;title&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def logo_path</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="42">
            <span class="hits">54</span>
            

            

            <code class="ruby">    content_item_hash[&quot;details&quot;][&quot;logo_path&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="46">
            <span class="hits">56</span>
            

            

            <code class="ruby">    content_item_hash.dig(&quot;details&quot;, &quot;filter&quot;) || {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def reject</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="50">
            <span class="hits">56</span>
            

            

            <code class="ruby">    content_item_hash.dig(&quot;details&quot;, &quot;reject&quot;) || {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sort_options</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="54">
            <span class="hits">112</span>
            

            

            <code class="ruby">    content_item_hash.dig(&quot;details&quot;, &quot;sort&quot;) || []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def default_order</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="58">
            <span class="hits">14</span>
            

            

            <code class="ruby">    content_item_hash[&quot;details&quot;][&quot;default_order&quot;] || &quot;-public_timestamp&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="61">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def phase_message</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="23" data-linenumber="62">
            <span class="hits">23</span>
            

            

            <code class="ruby">    content_item_hash[&quot;details&quot;][&quot;beta_message&quot;] || content_item_hash[&quot;details&quot;][&quot;alpha_message&quot;] || &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="65">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def phase</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="23" data-linenumber="66">
            <span class="hits">23</span>
            

            

            <code class="ruby">    content_item_hash[&quot;phase&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="69">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def no_index?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="70">
            <span class="hits">54</span>
            

            

            <code class="ruby">    content_item_hash[&quot;details&quot;][&quot;no_index&quot;].present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="73">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_content_finder?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="74">
            <span class="hits">112</span>
            

            

            <code class="ruby">    content_item_hash[&quot;content_id&quot;] == &quot;dd395436-9b40-41f3-8157-740a453ac972&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="77">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def related</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="78">
            <span class="hits">55</span>
            

            

            <code class="ruby">    related = content_item_hash[&quot;links&quot;][&quot;related&quot;] || []</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="57" data-linenumber="79">
            <span class="hits">57</span>
            

            

            <code class="ruby">    related.sort_by { |link| link[&quot;title&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="82">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def show_phase_banner?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="83">
            <span class="hits">54</span>
            

            

            <code class="ruby">    content_item_hash[&quot;phase&quot;].in?(%w[alpha beta])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="86">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def document_noun</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="87">
            <span class="hits">54</span>
            

            

            <code class="ruby">    content_item_hash[&quot;details&quot;][&quot;document_noun&quot;] || &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="90">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def show_summaries?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="166" data-linenumber="91">
            <span class="hits">166</span>
            

            

            <code class="ruby">    content_item_hash[&quot;details&quot;][&quot;show_summaries&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="94">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def summary</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="70" data-linenumber="95">
            <span class="hits">70</span>
            

            

            <code class="ruby">    content_item_hash[&quot;details&quot;][&quot;summary&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="98">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def email_alert_signup</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="101" data-linenumber="99">
            <span class="hits">101</span>
            

            

            <code class="ruby">    content_item_hash.dig(&quot;links&quot;, &quot;email_alert_signup&quot;, 0)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="102">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def signup_link</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="103">
            <span class="hits">54</span>
            

            

            <code class="ruby">    content_item_hash[&quot;details&quot;][&quot;signup_link&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="106">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sorter_class</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="107">
            <span class="hits">112</span>
            

            

            <code class="ruby">    return StatisticsSortPresenter if is_research_and_statistics?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="108">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="98" data-linenumber="109">
            <span class="hits">98</span>
            

            

            <code class="ruby">    SortPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="112">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def metadata_class</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="113">
            <span class="hits">54</span>
            

            

            <code class="ruby">    return StatisticsMetadataPresenter if is_research_and_statistics?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="114">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="48" data-linenumber="115">
            <span class="hits">48</span>
            

            

            <code class="ruby">    MetadataPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="117">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="118">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def default_documents_per_page</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="167" data-linenumber="119">
            <span class="hits">167</span>
            

            

            <code class="ruby">    content_item_hash.dig(&quot;details&quot;, &quot;default_documents_per_page&quot;) || 1500</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="120">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="121">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="122">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def base_path</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="510" data-linenumber="123">
            <span class="hits">510</span>
            

            

            <code class="ruby">    content_item_hash.dig(&quot;base_path&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="124">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="125">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="126">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def raw_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="279" data-linenumber="127">
            <span class="hits">279</span>
            

            

            <code class="ruby">    @raw_facets ||= content_item_hash.dig(&quot;details&quot;, &quot;facets&quot;) || []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="128">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="129">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="130">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def redirect</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="131">
            
            

            

            <code class="ruby">    content_item_hash.dig(&quot;redirects&quot;, 0, &quot;destination&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="132">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="133">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="134">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def organisations</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="135">
            <span class="hits">54</span>
            

            

            <code class="ruby">    links.fetch(&quot;organisations&quot;, [])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="136">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="137">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="138">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def government?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="139">
            <span class="hits">54</span>
            

            

            <code class="ruby">    base_path.starts_with?(&quot;/government&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="140">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="141">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="142">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def government_content_section</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="143">
            <span class="hits">8</span>
            

            

            <code class="ruby">    base_path.split(&quot;/&quot;)[2]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="144">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="145">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="146">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="147">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="148">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :content_item_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="149">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="150">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def is_research_and_statistics?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="166" data-linenumber="151">
            <span class="hits">166</span>
            

            

            <code class="ruby">    base_path == &quot;/search/research-and-statistics&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="152">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="153">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="154">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def document_type</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="155">
            <span class="hits">56</span>
            

            

            <code class="ruby">    content_item_hash[&quot;document_type&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="156">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="157">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="cd82b79c4f528c4749b1f14603c1628a9455bdcb">
  <div class="header">
    <h3>app/models/date_facet.rb</h3>
    <h4>
      <span class="yellow">
  88.46%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>52</b> relevant lines.
      <span class="green"><b>46</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class DateFacet &lt; FilterableFacet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :date_values</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(facet, value_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="5">
            <span class="hits">35</span>
            

            

            <code class="ruby">    @date_values = value_hash || {}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="6">
            <span class="hits">35</span>
            

            

            <code class="ruby">    super(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def user_supplied_from_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="34" data-linenumber="10">
            <span class="hits">34</span>
            

            

            <code class="ruby">    date_values[&quot;from&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def user_supplied_to_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="34" data-linenumber="14">
            <span class="hits">34</span>
            

            

            <code class="ruby">    date_values[&quot;to&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def error_message_to(search_query)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="34" data-linenumber="18">
            <span class="hits">34</span>
            

            

            <code class="ruby">    if search_query.invalid?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="19">
            
            

            

            <code class="ruby">      search_query.errors[:to_date].first</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def error_message_from(search_query)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="34" data-linenumber="24">
            <span class="hits">34</span>
            

            

            <code class="ruby">    if search_query.invalid?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            
            

            

            <code class="ruby">      search_query.errors[:from_date].first</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sentence_fragment</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="30">
            <span class="hits">8</span>
            

            

            <code class="ruby">    return nil unless has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="33">
            <span class="hits">8</span>
            

            

            <code class="ruby">      &quot;key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">      &quot;preposition&quot; =&gt; [preposition, additional_preposition].compact.join(&quot; &quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">      &quot;values&quot; =&gt; value_fragments,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      &quot;word_connectors&quot; =&gt; and_word_connectors,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="182" data-linenumber="41">
            <span class="hits">182</span>
            

            

            <code class="ruby">    present_values.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def query_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="45">
            <span class="hits">4</span>
            

            

            <code class="ruby">    { key =&gt; date_values }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="50">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def value_fragments</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="51">
            <span class="hits">8</span>
            

            

            <code class="ruby">    present_values.map do |name, date|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="53">
            <span class="hits">8</span>
            

            

            <code class="ruby">        &quot;label&quot; =&gt; date.date.strftime(&quot;%e %B %Y&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">        &quot;parameter_key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">        &quot;value&quot; =&gt; date.original_input,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">        &quot;name&quot; =&gt; &quot;#{key}[#{name}]&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="61">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def present_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="206" data-linenumber="62">
            <span class="hits">206</span>
            

            

            <code class="ruby">    parsed_values.select do |_, date|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="164" data-linenumber="63">
            <span class="hits">164</span>
            

            

            <code class="ruby">      date.date.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="67">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def parsed_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="206" data-linenumber="68">
            <span class="hits">206</span>
            

            

            <code class="ruby">    (date_values || {}).reduce({}) do |h, (k, v)|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="164" data-linenumber="69">
            <span class="hits">164</span>
            

            

            <code class="ruby">      h.merge(k =&gt; safe_date_parse(v))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="73">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def safe_date_parse(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="164" data-linenumber="74">
            <span class="hits">164</span>
            

            

            <code class="ruby">    DateInput.new(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">  rescue StandardError</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="76">
            
            

            

            <code class="ruby">    nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="79">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def additional_preposition</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="80">
            <span class="hits">8</span>
            

            

            <code class="ruby">    if present_values.length == 2</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="81">
            
            

            

            <code class="ruby">      &quot;between&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="83">
            <span class="hits">8</span>
            

            

            <code class="ruby">      present_values.map { |k, _|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="84">
            <span class="hits">8</span>
            

            

            <code class="ruby">        preposition_mappings[k]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby">      }.first</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="89">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def preposition_mappings</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="91">
            <span class="hits">8</span>
            

            

            <code class="ruby">      &quot;from&quot; =&gt; &quot;after&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">      &quot;to&quot; =&gt; &quot;before&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">    }.with_indifferent_access</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="96">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class DateInput</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="97">
            <span class="hits">1</span>
            

            

            <code class="ruby">    attr_reader :original_input</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="99">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def initialize(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="164" data-linenumber="100">
            <span class="hits">164</span>
            

            

            <code class="ruby">      @original_input = date_string</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="103">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def to_iso8601</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="104">
            
            

            

            <code class="ruby">      date.iso8601</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="107">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="172" data-linenumber="108">
            <span class="hits">172</span>
            

            

            <code class="ruby">      @date ||= DateParser.new.parse(original_input)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="109">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="111">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def to_param</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="112">
            
            

            

            <code class="ruby">      original_input</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="113">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="114">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="115">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2f6689f2561c5cbbafdbc2256118157e6fd9e523">
  <div class="header">
    <h3>app/models/document.rb</h3>
    <h4>
      <span class="green">
  98.73%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>79</b> relevant lines.
      <span class="green"><b>78</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class Document</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby">              :public_timestamp,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">              :is_historic,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">              :government_name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">              :content_purpose_supergroup,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">              :document_type,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">              :organisations,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">              :release_timestamp,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">              :es_score,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">              :format,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">              :content_id,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">              :index,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">              :description,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">              :score,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">              :original_rank,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">              :parts</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(document_hash, index)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="20">
            <span class="hits">160</span>
            

            

            <code class="ruby">    document_hash = document_hash.with_indifferent_access</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="21">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @title = document_hash.fetch(:title)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="22">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @link = document_hash.fetch(:link)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="23">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @content_id = document_hash.fetch(:content_id, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="24">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @description = document_hash.fetch(:description_with_highlighting, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="25">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @public_timestamp = document_hash.fetch(:public_timestamp, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="26">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @release_timestamp = document_hash.fetch(:release_timestamp, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="27">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @document_type = document_hash.fetch(:content_store_document_type, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="28">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @organisations = document_hash.fetch(:organisations, [])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="29">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @content_purpose_supergroup = document_hash.fetch(:content_purpose_supergroup, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="30">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @is_historic = document_hash.fetch(:is_historic, false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="31">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @government_name = document_hash.fetch(:government_name, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="32">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @es_score = document_hash.fetch(:es_score, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="33">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @score = document_hash.fetch(:combined_score, nil) || @es_score</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="34">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @original_rank = document_hash.fetch(:original_rank, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="35">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @format = document_hash.fetch(:format, nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="36">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @document_hash = document_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="37">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @parts = document_hash.fetch(:parts, [])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="160" data-linenumber="38">
            <span class="hits">160</span>
            

            

            <code class="ruby">    @index = index</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def metadata(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="384" data-linenumber="42">
            <span class="hits">384</span>
            

            

            <code class="ruby">    all_metadata(facets).map { |metadata| humanize_metadata_name(facets, metadata) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def path</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="320" data-linenumber="46">
            <span class="hits">320</span>
            

            

            <code class="ruby">    link</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def truncated_description</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">    # This truncates the description at the end of the first sentence</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="138" data-linenumber="51">
            <span class="hits">138</span>
            

            

            <code class="ruby">    description.gsub(/\.\s[A-Z].*/, &quot;.&quot;) if description.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="56">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :link, :document_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="58">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def is_mainstream_content?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="53" data-linenumber="59">
            <span class="hits">53</span>
            

            

            <code class="ruby">    %w[completed_transaction</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">       local_transaction</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">       calculator</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">       smart_answer</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">       simple_smart_answer</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">       place</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">       licence</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">       step_by_step</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">       transaction</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">       answer</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">       guide].include?(@document_type)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="72">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def date_metadata_keys(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="731" data-linenumber="73">
            <span class="hits">731</span>
            

            

            <code class="ruby">    metadata_facets(facets).select { |f| f.type == &quot;date&quot; }.map(&amp;:key)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="76">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def text_metadata_keys(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="731" data-linenumber="77">
            <span class="hits">731</span>
            

            

            <code class="ruby">    keys = metadata_facets(facets).select { |f| f.type == &quot;text&quot; }.map(&amp;:key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="78">
            <span class="hits">157</span>
            

            

            <code class="ruby">    keys.reject do |key|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="387" data-linenumber="79">
            <span class="hits">387</span>
            

            

            <code class="ruby">      key == &quot;organisations&quot; &amp;&amp; is_mainstream_content?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="83">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def metadata_facets(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="541" data-linenumber="84">
            <span class="hits">541</span>
            

            

            <code class="ruby">    facets.select(&amp;:metadata?)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="87">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_metadata(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="88">
            <span class="hits">157</span>
            

            

            <code class="ruby">    text_metadata(facets) + date_metadata(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="91">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def date_metadata(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="92">
            <span class="hits">157</span>
            

            

            <code class="ruby">    return [] if @content_purpose_supergroup == &quot;services&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="94">
            <span class="hits">157</span>
            

            

            <code class="ruby">    date_metadata_keys(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">      .map(&amp;method(:build_date_metadata))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby">      .select(&amp;method(:metadata_value_present?))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="99">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def build_date_metadata(key)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="187" data-linenumber="101">
            <span class="hits">187</span>
            

            

            <code class="ruby">      name: key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby">      value: document_hash[key],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="103">
            
            

            

            <code class="ruby">      type: &quot;date&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="107">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def text_metadata(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="108">
            <span class="hits">157</span>
            

            

            <code class="ruby">    text_metadata_keys(facets)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="109">
            
            

            

            <code class="ruby">      .map(&amp;method(:build_text_metadata))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            
            

            

            <code class="ruby">      .select(&amp;method(:metadata_value_present?))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="113">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def text_labels_for(key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="387" data-linenumber="114">
            <span class="hits">387</span>
            

            

            <code class="ruby">    labels = Array(document_hash.fetch(key, []))</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="132" data-linenumber="115">
            <span class="hits">132</span>
            

            

            <code class="ruby">               .map { |label| get_metadata_label(key, label) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            
            

            

            <code class="ruby">               .select(&amp;:present?)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="117">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="387" data-linenumber="118">
            <span class="hits">387</span>
            

            

            <code class="ruby">    if key == &quot;organisations&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="53" data-linenumber="119">
            <span class="hits">53</span>
            

            

            <code class="ruby">      labels = labels.sort_by do |label|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="53" data-linenumber="120">
            <span class="hits">53</span>
            

            

            <code class="ruby">        label.sub(&quot;Closed organisation: &quot;, &quot;ZZ&quot;).upcase</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="121">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="122">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="123">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="387" data-linenumber="124">
            <span class="hits">387</span>
            

            

            <code class="ruby">    labels</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="125">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="126">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="127">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def build_text_metadata(key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="387" data-linenumber="128">
            <span class="hits">387</span>
            

            

            <code class="ruby">    labels = text_labels_for(key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="387" data-linenumber="129">
            <span class="hits">387</span>
            

            

            <code class="ruby">    value = format_value(labels)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="130">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="131">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="387" data-linenumber="132">
            <span class="hits">387</span>
            

            

            <code class="ruby">      id: key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="133">
            
            

            

            <code class="ruby">      name: key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="134">
            
            

            

            <code class="ruby">      value: value,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="135">
            
            

            

            <code class="ruby">      labels: labels,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="136">
            
            

            

            <code class="ruby">      type: &quot;text&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="137">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="138">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="139">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="140">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def format_value(labels)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="387" data-linenumber="141">
            <span class="hits">387</span>
            

            

            <code class="ruby">    if labels.count &gt; 1</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="142">
            
            

            

            <code class="ruby">      &quot;#{labels.first} and #{labels.count - 1} others&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="143">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="387" data-linenumber="144">
            <span class="hits">387</span>
            

            

            <code class="ruby">      labels.first</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="145">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="146">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="147">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="148">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def metadata_value_present?(metadata_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="574" data-linenumber="149">
            <span class="hits">574</span>
            

            

            <code class="ruby">    metadata_hash.fetch(:value).present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="150">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="151">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="152">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def humanize_metadata_name(facets, metadata_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="227" data-linenumber="153">
            <span class="hits">227</span>
            

            

            <code class="ruby">    metadata_hash.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="154">
            
            

            

            <code class="ruby">      name: label_for_metadata_key(facets, metadata_hash.fetch(:name)),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="155">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="156">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="157">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="158">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def label_for_metadata_key(facets, key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="910" data-linenumber="159">
            <span class="hits">910</span>
            

            

            <code class="ruby">    facet = metadata_facets(facets).find { |f| f.key == key }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="160">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="227" data-linenumber="161">
            <span class="hits">227</span>
            

            

            <code class="ruby">    facet.short_name || facet.key.humanize</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="162">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="163">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="164">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def get_metadata_label(key, tag)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="132" data-linenumber="165">
            <span class="hits">132</span>
            

            

            <code class="ruby">    if tag.respond_to? :fetch</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="130" data-linenumber="166">
            <span class="hits">130</span>
            

            

            <code class="ruby">      tag.fetch(display_key_for_metadata_key(key), &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="167">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="168">
            <span class="hits">2</span>
            

            

            <code class="ruby">      tag</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="169">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="170">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="171">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="172">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def display_key_for_metadata_key(key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="130" data-linenumber="173">
            <span class="hits">130</span>
            

            

            <code class="ruby">    if %w[organisations document_collections].include?(key)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="53" data-linenumber="174">
            <span class="hits">53</span>
            

            

            <code class="ruby">      &quot;title&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="175">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="77" data-linenumber="176">
            <span class="hits">77</span>
            

            

            <code class="ruby">      &quot;label&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="177">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="178">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="179">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f244b5bab3bb165edcb5728aea44995cc99ec777">
  <div class="header">
    <h3>app/models/facet.rb</h3>
    <h4>
      <span class="green">
  91.43%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>35</b> relevant lines.
      <span class="green"><b>32</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class Facet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="313" data-linenumber="3">
            <span class="hits">313</span>
            

            

            <code class="ruby">    @facet = facet</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1958" data-linenumber="7">
            <span class="hits">1958</span>
            

            

            <code class="ruby">    facet[&quot;key&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def keys</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">    facet[&quot;keys&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def name</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1417" data-linenumber="15">
            <span class="hits">1417</span>
            

            

            <code class="ruby">    facet[&quot;name&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def type</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1148" data-linenumber="19">
            <span class="hits">1148</span>
            

            

            <code class="ruby">    facet[&quot;type&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def show_option_select_filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="139" data-linenumber="23">
            <span class="hits">139</span>
            

            

            <code class="ruby">    facet[&quot;show_option_select_filter&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def short_name</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="239" data-linenumber="27">
            <span class="hits">239</span>
            

            

            <code class="ruby">    facet[&quot;short_name&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def hide_facet_tag?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="522" data-linenumber="31">
            <span class="hits">522</span>
            

            

            <code class="ruby">    facet[&quot;hide_facet_tag&quot;] || false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filterable?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1216" data-linenumber="35">
            <span class="hits">1216</span>
            

            

            <code class="ruby">    facet[&quot;filterable&quot;] || false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="135" data-linenumber="39">
            <span class="hits">135</span>
            

            

            <code class="ruby">    false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def metadata?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3042" data-linenumber="43">
            <span class="hits">3042</span>
            

            

            <code class="ruby">    facet[&quot;display_as_result_metadata&quot;] || false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def allowed_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="469" data-linenumber="47">
            <span class="hits">469</span>
            

            

            <code class="ruby">    facet[&quot;allowed_values&quot;] || []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="50">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def query_params</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="51">
            
            

            

            <code class="ruby">    {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="56">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def and_word_connectors</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="57">
            <span class="hits">20</span>
            

            

            <code class="ruby">    { words_connector: &quot; and &quot;, two_words_connector: &quot; and &quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="60">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def or_word_connectors</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="61">
            <span class="hits">15</span>
            

            

            <code class="ruby">    { words_connector: &quot; or &quot;, last_word_connector: &quot; or &quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="64">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def value_fragments</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="65">
            
            

            

            <code class="ruby">    raise NotImplementedError</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="68">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :facet</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="aaad658630e1a89ac4bc46c7509e2f50f3136948">
  <div class="header">
    <h3>app/models/filterable_facet.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>6</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class FilterableFacet &lt; Facet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  DEFAULT_PREPOSITION = &quot;related to&quot;.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def preposition</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="47" data-linenumber="5">
            <span class="hits">47</span>
            

            

            <code class="ruby">    facet[&quot;preposition&quot;] || DEFAULT_PREPOSITION</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def to_partial_path</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="228" data-linenumber="9">
            <span class="hits">228</span>
            

            

            <code class="ruby">    self.class.name.underscore</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="97f2c104c6cbee9249b40ceb89c4c911002419d5">
  <div class="header">
    <h3>app/models/filters.rb</h3>
    <h4>
      <span class="yellow">
  85.71%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>7</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module Filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class ResearchAndStatsHashes</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">      [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="36" data-linenumber="6">
            <span class="hits">36</span>
            

            

            <code class="ruby">          &quot;value&quot; =&gt; &quot;statistics_published&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">          &quot;label&quot; =&gt; &quot;Statistics (published)&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">          &quot;filter&quot; =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">            &quot;content_store_document_type&quot; =&gt; %w[statistics national_statistics statistical_data_set official_statistics],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">          &quot;default&quot; =&gt; true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">          &quot;value&quot; =&gt; &quot;upcoming_statistics&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">          &quot;label&quot; =&gt; &quot;Statistics (upcoming)&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">          &quot;filter&quot; =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">            &quot;release_timestamp&quot; =&gt; &quot;from:#{Time.zone.today}&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">            &quot;format&quot; =&gt; %w[statistics_announcement],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">          &quot;value&quot; =&gt; &quot;cancelled_statistics&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">          &quot;label&quot; =&gt; &quot;Statistics (cancelled)&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">          &quot;filter&quot; =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">            &quot;statistics_announcement_state&quot; =&gt; &quot;cancelled&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">          &quot;value&quot; =&gt; &quot;research&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">          &quot;label&quot; =&gt; &quot;Research&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">          &quot;filter&quot; =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">            &quot;content_store_document_type&quot; =&gt; %w[research_for_development_output independent_report research],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">      ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class OfficialDocumentsHashes</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">      [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="43">
            
            

            

            <code class="ruby">          &quot;value&quot; =&gt; &quot;command_or_act_papers&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">          &quot;label&quot; =&gt; &quot;Command or act papers&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">          &quot;filter&quot; =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">            &quot;has_official_document&quot; =&gt; true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">          &quot;default&quot; =&gt; true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">          &quot;value&quot; =&gt; &quot;command_papers&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">          &quot;label&quot; =&gt; &quot;Command papers only&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">          &quot;filter&quot; =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">            &quot;has_command_paper&quot; =&gt; true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">            &quot;has_act_paper&quot; =&gt; false,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">          &quot;value&quot; =&gt; &quot;act_papers&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">          &quot;label&quot; =&gt; &quot;Act papers only&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">          &quot;filter&quot; =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">            &quot;has_act_paper&quot; =&gt; true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">            &quot;has_command_paper&quot; =&gt; false,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">      ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="af6a18d198539d11a17cf531ec02f715b8e7725f">
  <div class="header">
    <h3>app/models/hidden_clearable_facet.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>20</b> relevant lines.
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class HiddenClearableFacet &lt; FilterableFacet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(facet, value_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    @value = Array(value_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    super(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sentence_fragment</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="8">
            <span class="hits">4</span>
            

            

            <code class="ruby">    return nil unless selected_values.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="11">
            <span class="hits">4</span>
            

            

            <code class="ruby">      &quot;key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">      &quot;preposition&quot; =&gt; preposition,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">      &quot;values&quot; =&gt; value_fragments,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">      &quot;word_connectors&quot; =&gt; or_word_connectors,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="19">
            <span class="hits">5</span>
            

            

            <code class="ruby">    selected_values.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def query_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="23">
            <span class="hits">2</span>
            

            

            <code class="ruby">    { key =&gt; selected_values.map { |value| value[&quot;value&quot;] } }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def value_fragments</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="29">
            <span class="hits">4</span>
            

            

            <code class="ruby">    selected_values.map do |value|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="31">
            <span class="hits">4</span>
            

            

            <code class="ruby">        &quot;label&quot; =&gt; value[&quot;label&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">        &quot;value&quot; =&gt; value[&quot;value&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">        &quot;parameter_key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="39">
            <span class="hits">14</span>
            

            

            <code class="ruby">    @selected_values ||= begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">      return [] if @value.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">      allowed_values.select do |option|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="43">
            <span class="hits">3</span>
            

            

            <code class="ruby">        @value.include?(option[&quot;value&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ef3002e867dfb75b2603307367d0196c2ce96a70">
  <div class="header">
    <h3>app/models/hidden_facet.rb</h3>
    <h4>
      <span class="yellow">
  90.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>20</b> relevant lines.
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class HiddenFacet &lt; FilterableFacet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(facet, value)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="13" data-linenumber="3">
            <span class="hits">13</span>
            

            

            <code class="ruby">    @value = Array(value)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="13" data-linenumber="4">
            <span class="hits">13</span>
            

            

            <code class="ruby">    super(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sentence_fragment</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="8">
            <span class="hits">3</span>
            

            

            <code class="ruby">    return nil unless has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="11">
            <span class="hits">3</span>
            

            

            <code class="ruby">      &quot;key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">      &quot;preposition&quot; =&gt; preposition,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">      &quot;values&quot; =&gt; value_fragments,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">      &quot;word_connectors&quot; =&gt; or_word_connectors,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="19">
            <span class="hits">60</span>
            

            

            <code class="ruby">    @value.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def query_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="23">
            <span class="hits">2</span>
            

            

            <code class="ruby">    values = allowed_values.empty? ? @value : selected_values.map { |value| value[&quot;value&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="24">
            <span class="hits">2</span>
            

            

            <code class="ruby">    { key =&gt; values }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def value_fragments</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="30">
            <span class="hits">3</span>
            

            

            <code class="ruby">    selected_values.map do |value|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">        &quot;label&quot; =&gt; value[&quot;label&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">        &quot;parameter_key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="39">
            <span class="hits">3</span>
            

            

            <code class="ruby">    return [] if @value.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="41">
            <span class="hits">3</span>
            

            

            <code class="ruby">    allowed_values.select do |option|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="42">
            
            

            

            <code class="ruby">      @value.include?(option[&quot;value&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="7e52ae4c2e5b8052573e6c85d50d1e2556874c46">
  <div class="header">
    <h3>app/models/option_select_facet.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>30</b> relevant lines.
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class OptionSelectFacet &lt; FilterableFacet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :value</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(facet, values)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="141" data-linenumber="5">
            <span class="hits">141</span>
            

            

            <code class="ruby">    @value = Array(values)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="141" data-linenumber="6">
            <span class="hits">141</span>
            

            

            <code class="ruby">    super(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def options(controls, key)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    # NOTE: We use a symbol-based hash here unlike all our other hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">    # data-structures because we pass this to a govuk_component partial</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">    # that expects symbol keys, not strings</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="139" data-linenumber="13">
            <span class="hits">139</span>
            

            

            <code class="ruby">    @options ||= allowed_values.map do |allowed_value|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1208" data-linenumber="15">
            <span class="hits">1208</span>
            

            

            <code class="ruby">        value: allowed_value[&quot;value&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">        label: allowed_value[&quot;label&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">        id: &quot;#{key}-#{allowed_value[&#39;value&#39;]}&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">        data_attributes: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">          track_category: &quot;filterClicked&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">          uncheck_track_category: &quot;filterRemoved&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">          track_action: name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">          track_label: allowed_value[&quot;label&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">        checked: selected_values.include?(allowed_value),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">        controls: controls || nil,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sentence_fragment</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="31">
            <span class="hits">8</span>
            

            

            <code class="ruby">    return nil unless selected_values.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="34">
            <span class="hits">8</span>
            

            

            <code class="ruby">      &quot;key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">      &quot;preposition&quot; =&gt; preposition,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      &quot;values&quot; =&gt; value_fragments,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">      &quot;word_connectors&quot; =&gt; or_word_connectors,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="701" data-linenumber="42">
            <span class="hits">701</span>
            

            

            <code class="ruby">    selected_values.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def unselected?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="249" data-linenumber="46">
            <span class="hits">249</span>
            

            

            <code class="ruby">    selected_values.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def cacheable?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="139" data-linenumber="50">
            <span class="hits">139</span>
            

            

            <code class="ruby">    unselected? || selected_values.one?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def cache_key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="139" data-linenumber="54">
            <span class="hits">139</span>
            

            

            <code class="ruby">    { selected: selected_values, allowed: allowed_values }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def query_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="58">
            <span class="hits">8</span>
            

            

            <code class="ruby">    { key =&gt; selected_values.map { |value| value[&quot;value&quot;] } }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="61">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def value_fragments</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="64">
            <span class="hits">8</span>
            

            

            <code class="ruby">    @value_fragments ||= selected_values.map do |value|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="66">
            <span class="hits">2</span>
            

            

            <code class="ruby">        &quot;label&quot; =&gt; value[&quot;label&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">        &quot;value&quot; =&gt; value[&quot;value&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">        &quot;parameter_key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="73">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2313" data-linenumber="74">
            <span class="hits">2313</span>
            

            

            <code class="ruby">    @selected_values ||= begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="141" data-linenumber="75">
            <span class="hits">141</span>
            

            

            <code class="ruby">      return [] if @value.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="141" data-linenumber="77">
            <span class="hits">141</span>
            

            

            <code class="ruby">      allowed_values.select do |option|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1214" data-linenumber="78">
            <span class="hits">1214</span>
            

            

            <code class="ruby">        @value.include?(option[&quot;value&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="864175e2af47b83151a900d686de802cc99469b7">
  <div class="header">
    <h3>app/models/radio_facet_for_multiple_filters.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>24</b> relevant lines.
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class RadioFacetForMultipleFilters &lt; FilterableFacet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(facet, value, filter_hashes)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="7" data-linenumber="4">
            <span class="hits">7</span>
            

            

            <code class="ruby">    @filter_hashes = filter_hashes</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="7" data-linenumber="5">
            <span class="hits">7</span>
            

            

            <code class="ruby">    @value = validated_value(value, @filter_hashes)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="7" data-linenumber="6">
            <span class="hits">7</span>
            

            

            <code class="ruby">    super(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def options</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="10">
            <span class="hits">6</span>
            

            

            <code class="ruby">    @filter_hashes.map do |filter_hash|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="24" data-linenumber="12">
            <span class="hits">24</span>
            

            

            <code class="ruby">        value: filter_hash[&quot;value&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">        text: filter_hash[&quot;label&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">        checked: @value == filter_hash[&quot;value&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="31" data-linenumber="20">
            <span class="hits">31</span>
            

            

            <code class="ruby">    true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sentence_fragment</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">    nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def query_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="28">
            <span class="hits">12</span>
            

            

            <code class="ruby">    { key =&gt; @value }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def to_partial_path</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="32">
            <span class="hits">6</span>
            

            

            <code class="ruby">    &quot;radio_facet&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def allowed_values</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="36">
            <span class="hits">12</span>
            

            

            <code class="ruby">    @filter_hashes</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :filter_hashes</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def validated_value(value, filter_hashes)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="44">
            <span class="hits">35</span>
            

            

            <code class="ruby">    filter_hashes.map { |f| f[&quot;value&quot;] }.include?(value) ? value : default_value</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def default_value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="48">
            <span class="hits">8</span>
            

            

            <code class="ruby">    @filter_hashes.find { |hash_hash| hash_hash[&quot;default&quot;] }.fetch(&quot;value&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="73ecc5807db4ba8fd707df60df716b250db50f7b">
  <div class="header">
    <h3>app/models/result_set.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>6</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class ResultSet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :documents, :start, :total</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(documents, start, total)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="5">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @documents = documents</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="6">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @start = start</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="7">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @total = total</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="5a504829663488e8d1514239affc8288555fcd55">
  <div class="header">
    <h3>app/models/taxon_facet.rb</h3>
    <h4>
      <span class="red">
  78.26%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>46</b> relevant lines.
      <span class="green"><b>36</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class TaxonFacet &lt; FilterableFacet</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  LEVEL_ONE_TAXON_KEY = &quot;level_one_taxon&quot;.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  LEVEL_TWO_TAXON_KEY = &quot;level_two_taxon&quot;.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(facet, value_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="6">
            <span class="hits">25</span>
            

            

            <code class="ruby">    @value_hash = value_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="7">
            <span class="hits">25</span>
            

            

            <code class="ruby">    super(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def name</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">    facet[&quot;name&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def topics</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="23" data-linenumber="15">
            <span class="hits">23</span>
            

            

            <code class="ruby">    level_one_taxons.unshift(default_topic_value)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sub_topics</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="23" data-linenumber="19">
            <span class="hits">23</span>
            

            

            <code class="ruby">    return [default_sub_topic_value] unless level_two_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="23" data-linenumber="21">
            <span class="hits">23</span>
            

            

            <code class="ruby">    level_two_taxons.unshift(default_sub_topic_value)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sentence_fragment</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            
            

            

            <code class="ruby">    return nil if selected_level_one_value.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="28">
            
            

            

            <code class="ruby">      &quot;type&quot; =&gt; &quot;taxon&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">      &quot;preposition&quot; =&gt; preposition,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">      &quot;values&quot; =&gt; value_fragments,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">      &quot;word_connectors&quot; =&gt; and_word_connectors,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_filters?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="118" data-linenumber="36">
            <span class="hits">118</span>
            

            

            <code class="ruby">    selected_level_one_value.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def query_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="41">
            
            

            

            <code class="ruby">      LEVEL_ONE_TAXON_KEY =&gt; (selected_level_one_value || {})[:value],</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="42">
            
            

            

            <code class="ruby">      LEVEL_TWO_TAXON_KEY =&gt; (selected_level_two_value || {})[:value],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def value_fragments</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">    [</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="50">
            
            

            

            <code class="ruby">      value_fragment(selected_level_one_value, LEVEL_ONE_TAXON_KEY),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">      value_fragment(selected_level_two_value, LEVEL_TWO_TAXON_KEY),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">    ].compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def value_fragment(value, key)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="56">
            
            

            

            <code class="ruby">    return nil if value.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="59">
            
            

            

            <code class="ruby">      &quot;label&quot; =&gt; value[:text],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">      &quot;parameter_key&quot; =&gt; key,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">      &quot;value&quot; =&gt; value[:value],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="65">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def level_one_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="164" data-linenumber="66">
            <span class="hits">164</span>
            

            

            <code class="ruby">    @level_one_taxons ||= registry.taxonomy_tree.values.map do |v|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="33" data-linenumber="68">
            <span class="hits">33</span>
            

            

            <code class="ruby">        value: v[&quot;content_id&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">        text: v[&quot;title&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">        sub_topics: v[&quot;children&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">        data_attributes: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby">          track_category: &quot;filterClicked&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            
            

            

            <code class="ruby">          track_action: &quot;level_one_taxon&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby">          track_label: v[&quot;title&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">        selected: v[&quot;content_id&quot;] == @value_hash[LEVEL_ONE_TAXON_KEY],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="81">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def level_two_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="46" data-linenumber="82">
            <span class="hits">46</span>
            

            

            <code class="ruby">    @level_two_taxons ||= level_one_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="53" data-linenumber="83">
            <span class="hits">53</span>
            

            

            <code class="ruby">      .map { |v| v[:sub_topics] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">      .compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby">      .flatten</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">      .map do |v|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="88">
            <span class="hits">60</span>
            

            

            <code class="ruby">          text: v[&quot;title&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">          value: v[&quot;content_id&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">          data_attributes: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby">            track_category: &quot;filterClicked&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">            track_action: &quot;level_two_taxon&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">            track_label: v[&quot;title&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">            topic_parent: v[&quot;parent&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby">          selected: v[&quot;content_id&quot;] == @value_hash[LEVEL_TWO_TAXON_KEY],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="101">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_level_two_value</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="102">
            
            

            

            <code class="ruby">    @selected_level_two_value ||= level_two_taxons.find do |v|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="103">
            
            

            

            <code class="ruby">      v[:value] == @value_hash[LEVEL_TWO_TAXON_KEY]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="107">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_level_one_value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="118" data-linenumber="108">
            <span class="hits">118</span>
            

            

            <code class="ruby">    @selected_level_one_value ||= level_one_taxons.find do |v|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="195" data-linenumber="109">
            <span class="hits">195</span>
            

            

            <code class="ruby">      v[:value] == @value_hash[LEVEL_ONE_TAXON_KEY]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="113">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def default_sub_topic_value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="23" data-linenumber="114">
            <span class="hits">23</span>
            

            

            <code class="ruby">    { text: &quot;All sub-topics&quot;, value: &quot;&quot;, parent: &quot;&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="115">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="117">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def default_topic_value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="23" data-linenumber="118">
            <span class="hits">23</span>
            

            

            <code class="ruby">    { text: &quot;All topics&quot;, value: &quot;&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="119">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="120">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="121">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def registry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="122">
            <span class="hits">25</span>
            

            

            <code class="ruby">    @registry ||= Registries::BaseRegistries.new.all[&quot;part_of_taxonomy_tree&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="123">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="124">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="4d9102f356cbb4ed1fea3ee73c9886be0f118e75">
  <div class="header">
    <h3>app/parsers/date_parser.rb</h3>
    <h4>
      <span class="red">
  72.97%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>37</b> relevant lines.
      <span class="green"><b>27</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class DateParser</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def parse(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="182" data-linenumber="3">
            <span class="hits">182</span>
            

            

            <code class="ruby">    date_string = date_string.to_s.strip</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="182" data-linenumber="5">
            <span class="hits">182</span>
            

            

            <code class="ruby">    if date_string.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">      date_string =</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="46" data-linenumber="7">
            <span class="hits">46</span>
            

            

            <code class="ruby">        contains_invalid_characters?(date_string) ? &quot; &quot; : date_string</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">      date_string =</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="46" data-linenumber="10">
            <span class="hits">46</span>
            

            

            <code class="ruby">        numbers_only?(date_string) ? process_number_only_inputs(date_string) : date_string</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">      date_string =</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="46" data-linenumber="13">
            <span class="hits">46</span>
            

            

            <code class="ruby">        delimited_date?(date_string) ? process_delimited_dates(date_string) : date_string</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="182" data-linenumber="16">
            <span class="hits">182</span>
            

            

            <code class="ruby">    if could_be_month_name?(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="17">
            <span class="hits">136</span>
            

            

            <code class="ruby">      date = process_month_name_inputs(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="182" data-linenumber="19">
            <span class="hits">182</span>
            

            

            <code class="ruby">    date ||=</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">      begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="182" data-linenumber="21">
            <span class="hits">182</span>
            

            

            <code class="ruby">        Chronic.parse(date_string, guess: :begin, endian_precedence: :little)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">      rescue StandardError</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">        nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="182" data-linenumber="25">
            <span class="hits">182</span>
            

            

            <code class="ruby">    Date.new(date.year, date.month, date.day) if date</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def contains_invalid_characters?(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">    chars =</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="46" data-linenumber="32">
            <span class="hits">46</span>
            

            

            <code class="ruby">      date_string.split(&quot;&quot;) &amp; %w[! @  $ % ^ &amp; *]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="46" data-linenumber="33">
            <span class="hits">46</span>
            

            

            <code class="ruby">    chars.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def numbers_only?(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="46" data-linenumber="37">
            <span class="hits">46</span>
            

            

            <code class="ruby">    date_string.match?(/^\d+$/)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def could_be_month_name?(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="182" data-linenumber="41">
            <span class="hits">182</span>
            

            

            <code class="ruby">    date_string.match?(/^[a-zA-Z]*$/)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def delimited_date?(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="46" data-linenumber="45">
            <span class="hits">46</span>
            

            

            <code class="ruby">    date_string.match?(/(\d+)[. ](\d+)[. ]/)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">  # Converts spaces or dots with slashes, eg 01.01.2001 to 01/01/2001</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def process_delimited_dates(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="50">
            
            

            

            <code class="ruby">    date_string.gsub(/(\d+)[. ](\d+)[. ]/, &#39;\1/\2/&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def process_number_only_inputs(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="54">
            
            

            

            <code class="ruby">    case date_string.length</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">    when 4</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">      # Catches if user inputs just year which Chronic would parse as a time. e.g. &quot;2008&quot; as &quot;8:08pm&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="57">
            
            

            

            <code class="ruby">      &quot;01/01/#{date_string}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">    when 8</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">      # Catches fully padded dates without delimiters, eg 01012001</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="60">
            
            

            

            <code class="ruby">      date_string.gsub(/(\d{2})(\d{2})(\d{4})/, &#39;\1/\2/\3&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">    when 6</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">      # Catches fully padded dates without delimiters with abreviated year, eg 010101</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="63">
            
            

            

            <code class="ruby">      date_string.gsub(/(\d{2})(\d{2})(\d{2})/, &#39;\1/\2/\3&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">      # Catches if user inputs an incorrect number of digits, which Chronic would parse as a time. e.g</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">      # &quot;100&quot; as todays&#39;s date at 13:00, or &quot;10011&quot; as today&#39;s date at 13:00:11</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="67">
            
            

            

            <code class="ruby">      date_string.replace(&quot; &quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">  # Catches if user input could be a month name which chronic would parse as this year</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby">  # for months prior to now, and next year for months ahead of now</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="73">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def process_month_name_inputs(date_string)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="74">
            <span class="hits">136</span>
            

            

            <code class="ruby">    guessed_date = Chronic.parse(date_string, guess: :begin)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="75">
            <span class="hits">136</span>
            

            

            <code class="ruby">    if guessed_date</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="76">
            
            

            

            <code class="ruby">      guessed_year = guessed_date.year</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="77">
            
            

            

            <code class="ruby">      this_year = Time.zone.now.year</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="78">
            
            

            

            <code class="ruby">      guessed_year != this_year ? guessed_date - 1.year : guessed_date</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="3a16219d1b7c4535ae15e8ec0e133b2913a3d8b6">
  <div class="header">
    <h3>app/parsers/result_set_parser.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>7</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module ResultSetParser</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.parse(search_results)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="3">
            <span class="hits">55</span>
            

            

            <code class="ruby">    results = search_results.fetch(&quot;results&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="4">
            <span class="hits">55</span>
            

            

            <code class="ruby">    start = search_results.fetch(&quot;start&quot;, 0)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="5">
            <span class="hits">55</span>
            

            

            <code class="ruby">    total = search_results.fetch(&quot;total&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="215" data-linenumber="6">
            <span class="hits">215</span>
            

            

            <code class="ruby">    documents = results.each_with_index.map { |document, index| Document.new(document, index + 1) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="8">
            <span class="hits">55</span>
            

            

            <code class="ruby">    ResultSet.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">      documents,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">      start,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">      total,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="0f11ddcd2c73c6b9a5e0173063aaad124955dc48">
  <div class="header">
    <h3>app/presenters/atom_presenter.rb</h3>
    <h4>
      <span class="green">
  94.74%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>19</b> relevant lines.
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class AtomPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(content_item, result_set, facet_tags)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    @filter_descriptions = facet_tags.selected_filter_descriptions</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    @result_set = result_set</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def title</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    return &quot;#{content_item.title} #{filters_applied.join(&#39; &#39;)}&quot; if filters_applied.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">    content_item.title</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filters_applied</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    @filters_applied ||= filter_descriptions.map { |filters|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">      filters.map { |filter| &quot;#{filter[:preposition].downcase} #{filter[:text]}&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    }.flatten</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def entries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="21">
            <span class="hits">3</span>
            

            

            <code class="ruby">    result_set.documents</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="22">
            <span class="hits">9</span>
            

            

            <code class="ruby">    .reject { |d| d.public_timestamp.blank? &amp;&amp; d.release_timestamp.blank? }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="23">
            <span class="hits">9</span>
            

            

            <code class="ruby">    .map { |d| EntryPresenter.new(d, content_item.show_summaries?) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def updated_at</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">    entries.first.updated_at</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :content_item, :result_set, :filter_descriptions</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="7e609695de9d79c3ffed5aea5f76a69dbd823995">
  <div class="header">
    <h3>app/presenters/entry_presenter.rb</h3>
    <h4>
      <span class="green">
  94.44%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>18</b> relevant lines.
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class EntryPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  delegate :title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby">           :path,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">           to: :entry</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  WEBSITE_ROOT = Plek.current.website_root.gsub(/https?:\/\//, &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(entry, show_summaries)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="9">
            <span class="hits">9</span>
            

            

            <code class="ruby">    @entry = entry</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="10">
            <span class="hits">9</span>
            

            

            <code class="ruby">    @show_summaries = show_summaries</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def summary</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="14">
            <span class="hits">3</span>
            

            

            <code class="ruby">    @entry.truncated_description if show_summaries</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def tag(schema)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="18">
            <span class="hits">3</span>
            

            

            <code class="ruby">    &quot;tag:#{WEBSITE_ROOT},#{self.class.schema_date(schema)}:#{entry.path}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def updated_at</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="22">
            <span class="hits">4</span>
            

            

            <code class="ruby">    Time.zone.parse(entry.public_timestamp || entry.release_timestamp)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.feed_ended_id(schema, base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">    &quot;tag:#{WEBSITE_ROOT},#{schema_date(schema)}:#{base_path}/feed-ended&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def self.schema_date(schema)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="30">
            <span class="hits">3</span>
            

            

            <code class="ruby">    schema.instance_variable_get(:@feed_options)[:schema_date]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :entry, :show_summaries</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="1360a8958c8e1a29b81cfdcd917a865bd0f0557c">
  <div class="header">
    <h3>app/presenters/facet_tag_presenter.rb</h3>
    <h4>
      <span class="green">
  94.12%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>17</b> relevant lines.
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class FacetTagPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ERB::Util</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(sentence_fragment, hide_facet_tag, i_am_a_topic_page_finder: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="5">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @hide_facet_tag = hide_facet_tag</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="6">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @i_am_a_topic_page_finder = i_am_a_topic_page_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="7">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @fragment = remove_taxonomy_facets(sentence_fragment)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def present</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="11">
            <span class="hits">54</span>
            

            

            <code class="ruby">    return {} if @fragment.nil? || @hide_facet_tag</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="13">
            <span class="hits">32</span>
            

            

            <code class="ruby">    @fragment[&quot;values&quot;].map.with_index do |value, i|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="64" data-linenumber="15">
            <span class="hits">64</span>
            

            

            <code class="ruby">        preposition: i.zero? ? @fragment[&quot;preposition&quot;].titlecase : @fragment[&quot;word_connectors&quot;][:words_connector],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">        text: html_escape(value[&quot;label&quot;]),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">        data_facet: value[&quot;parameter_key&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">        data_name: value[&quot;name&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">        data_value: value[&quot;value&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">        data_track_label: value[&quot;label&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def remove_taxonomy_facets(fragment)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="28">
            <span class="hits">54</span>
            

            

            <code class="ruby">    return nil if fragment.nil? || fragment[&quot;values&quot;].nil?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="29">
            <span class="hits">35</span>
            

            

            <code class="ruby">    return fragment unless @i_am_a_topic_page_finder</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="31">
            <span class="hits">3</span>
            

            

            <code class="ruby">    fragment[&quot;values&quot;] = fragment[&quot;values&quot;].reject do |value|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">      %w[level_one_taxon level_two_taxon].include? value[&quot;parameter_key&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="35">
            <span class="hits">3</span>
            

            

            <code class="ruby">    fragment[&quot;values&quot;].count.zero? ? nil : fragment</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="117d5b179f3544054e7250b307127a870c225e36">
  <div class="header">
    <h3>app/presenters/facet_tags_presenter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>19</b> relevant lines.
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class FacetTagsPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(filters, sort_presenter, i_am_a_topic_page_finder: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="3">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @filters = filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="4">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @sort_option = sort_presenter.selected_option || {}</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="5">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @i_am_a_topic_page_finder = i_am_a_topic_page_finder</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def present</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="107" data-linenumber="10">
            <span class="hits">107</span>
            

            

            <code class="ruby">      applied_filters: selected_filter_descriptions,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">      screen_reader_filter_description: ScreenReaderFilterDescriptionPresenter.new(filters, sort_option).present,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_filter_descriptions</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="168" data-linenumber="16">
            <span class="hits">168</span>
            

            

            <code class="ruby">    selected_filters.map { |filter|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="17">
            <span class="hits">54</span>
            

            

            <code class="ruby">      FacetTagPresenter.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">        filter.sentence_fragment,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">        filter.hide_facet_tag?,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">        i_am_a_topic_page_finder: i_am_a_topic_page_finder,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">      ).present</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">    }.reject(&amp;:empty?)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def display_total_selected_filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="53" data-linenumber="26">
            <span class="hits">53</span>
            

            

            <code class="ruby">    selected_facets_count.zero? ? nil : &quot;(#{selected_facets_count})&lt;span class=&#39;govuk-visually-hidden&#39;&gt; filters currently selected&lt;/span&gt;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :filters, :sort_option, :i_am_a_topic_page_finder</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_facets_count</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="60" data-linenumber="34">
            <span class="hits">60</span>
            

            

            <code class="ruby">    selected_filter_descriptions.flatten.reject { |facet|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="35">
            <span class="hits">16</span>
            

            

            <code class="ruby">      facet[:data_facet] == &quot;keywords&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">    }.count</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="168" data-linenumber="40">
            <span class="hits">168</span>
            

            

            <code class="ruby">    filters.select(&amp;:has_filters?)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="a8ba89d4555481c05077e28e986fd0a423834c21">
  <div class="header">
    <h3>app/presenters/finder_breadcrumbs_presenter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>15</b> relevant lines.
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class FinderBreadcrumbsPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :organisation, :finder_name</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(organisation, finder_content_item)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="5">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @organisation = organisation</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="6">
            <span class="hits">55</span>
            

            

            <code class="ruby">    @finder_name = finder_content_item.title</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def breadcrumbs</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="10">
            <span class="hits">56</span>
            

            

            <code class="ruby">    return nil if organisation.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="12">
            <span class="hits">4</span>
            

            

            <code class="ruby">    crumbs = [{ title: &quot;Home&quot;, url: &quot;/&quot; }]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="13">
            <span class="hits">4</span>
            

            

            <code class="ruby">    crumbs &lt;&lt; { title: &quot;Organisations&quot;, url: &quot;/government/organisations&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="15">
            <span class="hits">4</span>
            

            

            <code class="ruby">    if organisation_is_valid?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="16">
            <span class="hits">4</span>
            

            

            <code class="ruby">      crumbs &lt;&lt; { title: organisation[&quot;title&quot;], url: &quot;/government/organisations/#{organisation[&#39;slug&#39;]}&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="19">
            <span class="hits">4</span>
            

            

            <code class="ruby">    crumbs</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def organisation_is_valid?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="25">
            <span class="hits">12</span>
            

            

            <code class="ruby">    organisation.present? &amp;&amp; %w[title slug].all? { |key| organisation[key].present? }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="982aba2f2c3327c30139a168cfaa22b84590732f">
  <div class="header">
    <h3>app/presenters/metadata_presenter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>15</b> relevant lines.
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class MetadataPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(raw_metadata)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="3">
            <span class="hits">157</span>
            

            

            <code class="ruby">    @raw_metadata = raw_metadata</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def present</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="141" data-linenumber="7">
            <span class="hits">141</span>
            

            

            <code class="ruby">    raw_metadata.map do |datum|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="195" data-linenumber="8">
            <span class="hits">195</span>
            

            

            <code class="ruby">      case datum.fetch(:type)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">      when &quot;date&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="81" data-linenumber="10">
            <span class="hits">81</span>
            

            

            <code class="ruby">        build_date_metadata(datum)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">      when &quot;text&quot;, &quot;content_id&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="114" data-linenumber="12">
            <span class="hits">114</span>
            

            

            <code class="ruby">        build_text_metadata(datum)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :raw_metadata</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def build_text_metadata(data)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="130" data-linenumber="23">
            <span class="hits">130</span>
            

            

            <code class="ruby">      id: data[:id],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">      label: data.fetch(:name),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">      value: data.fetch(:value),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">      labels: data[:labels],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">      is_text: true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def build_date_metadata(data)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="97" data-linenumber="32">
            <span class="hits">97</span>
            

            

            <code class="ruby">    date = Date.parse(data.fetch(:value))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="97" data-linenumber="34">
            <span class="hits">97</span>
            

            

            <code class="ruby">      label: data.fetch(:name),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">      is_date: true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      machine_date: date.iso8601,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">      human_date: date.strftime(&quot;%-d %B %Y&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="1e45aeda816b245f28997d2de9d6e7e11ec1e314">
  <div class="header">
    <h3>app/presenters/pagination_presenter.rb</h3>
    <h4>
      <span class="green">
  96.55%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>29</b> relevant lines.
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># The PaginationPresenter class is responsible for creating the next and</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># previous links to be displayed on finders.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">class PaginationPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(per_page:, start_offset:, total_results:, url_builder:)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="5">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @per_page = per_page</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="6">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @start_offset = start_offset</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="7">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @total_results = total_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="8">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @url_builder = url_builder</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def next_and_prev_links</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="12">
            <span class="hits">54</span>
            

            

            <code class="ruby">    return unless can_paginate?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="14">
            <span class="hits">3</span>
            

            

            <code class="ruby">    { previous_page: previous_page, next_page: next_page }.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :per_page, :start_offset, :total_results, :url_builder</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def can_paginate?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="22">
            <span class="hits">54</span>
            

            

            <code class="ruby">    per_page.present? &amp;&amp; has_other_pages?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_other_pages?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="26">
            <span class="hits">54</span>
            

            

            <code class="ruby">    previous_page.present? || next_page.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def page_links</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            
            

            

            <code class="ruby">    { previous_page: previous_page, next_page: next_page }.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def current_page</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="119" data-linenumber="34">
            <span class="hits">119</span>
            

            

            <code class="ruby">    (start_offset / per_page) + 1</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def total_pages</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="62" data-linenumber="38">
            <span class="hits">62</span>
            

            

            <code class="ruby">    (total_results / per_page.to_f).ceil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def next_page</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="42">
            <span class="hits">56</span>
            

            

            <code class="ruby">    return unless current_page &lt; total_pages</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="44">
            <span class="hits">4</span>
            

            

            <code class="ruby">    build_page_link(&quot;Next page&quot;, current_page + 1)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def previous_page</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="57" data-linenumber="48">
            <span class="hits">57</span>
            

            

            <code class="ruby">    return unless current_page &gt; 1</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="50">
            <span class="hits">2</span>
            

            

            <code class="ruby">    build_page_link(&quot;Previous page&quot;, current_page - 1)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def build_page_link(page_label, page)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="55">
            <span class="hits">6</span>
            

            

            <code class="ruby">      title: page_label,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">      label: &quot;#{page} of #{total_pages}&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">      url: url_builder.url(page: page),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="e114bef4b7d11c3d94bddd8110ea11cd0a74c86a">
  <div class="header">
    <h3>app/presenters/result_set_presenter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>35</b> relevant lines.
      <span class="green"><b>35</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class ResultSetPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ERB::Util</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActionView::Helpers::NumberHelper</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :pluralised_document_noun, :debug_score, :start_offset</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  delegate :atom_url, to: :content_item</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(content_item, facets, results, filter_params, sort_presenter, metadata_presenter_class, show_top_result = false, debug_score = false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="10">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="11">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @facets = facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="12">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @documents = results.documents</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="13">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @total = results.total</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="14">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @start_offset = results.start + 1</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="15">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @pluralised_document_noun = content_item.document_noun.pluralize(total)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="16">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @filter_params = filter_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="17">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @sort_presenter = sort_presenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="18">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @show_top_result = show_top_result</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="19">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @metadata_presenter_class = metadata_presenter_class</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="20">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @debug_score = debug_score</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def displayed_total</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="214" data-linenumber="24">
            <span class="hits">214</span>
            

            

            <code class="ruby">    &quot;#{number_with_delimiter(total)} #{pluralised_document_noun}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def total_count</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="28">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @total</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def search_results_content</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="32">
            <span class="hits">54</span>
            

            

            <code class="ruby">    component_data = document_list_component_data(documents_to_convert: documents)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="34">
            <span class="hits">54</span>
            

            

            <code class="ruby">      document_list_component_data: component_data,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">      zero_results: total.zero?,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      page_count: component_data.count,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">      finder_name: content_item.title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">      debug_score: debug_score,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def user_supplied_keywords</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="167" data-linenumber="43">
            <span class="hits">167</span>
            

            

            <code class="ruby">    @filter_params.fetch(&quot;keywords&quot;, &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sort_option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="94" data-linenumber="47">
            <span class="hits">94</span>
            

            

            <code class="ruby">    presenter = sort_presenter.to_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="94" data-linenumber="48">
            <span class="hits">94</span>
            

            

            <code class="ruby">    return nil unless presenter</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="250" data-linenumber="50">
            <span class="hits">250</span>
            

            

            <code class="ruby">    presenter[:options].find { |o| o[:selected] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :metadata_presenter_class, :sort_presenter, :total, :documents, :facets, :content_item</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def document_list_component_data(documents_to_convert:)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="58">
            <span class="hits">54</span>
            

            

            <code class="ruby">    documents_to_convert.map.with_index do |document, index|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="59">
            <span class="hits">157</span>
            

            

            <code class="ruby">      SearchResultPresenter.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">        document: document,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">        rank: index + 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">        metadata_presenter_class: metadata_presenter_class,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">        doc_count: documents.count,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">        facets: facets,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">        content_item: content_item,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">        debug_score: debug_score,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">      ).document_list_component_data</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="6360357fe6ff9c8252fbac2cc1b5d87e1a2d56b0">
  <div class="header">
    <h3>app/presenters/screen_reader_filter_description_presenter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>18</b> relevant lines.
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class ScreenReaderFilterDescriptionPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(filters, sort_option)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="107" data-linenumber="3">
            <span class="hits">107</span>
            

            

            <code class="ruby">    @filters = filters</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="107" data-linenumber="4">
            <span class="hits">107</span>
            

            

            <code class="ruby">    @sort_options = sort_option.present? ? [&quot;sorted by #{sort_option[&#39;name&#39;]}&quot;] : []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def present</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="107" data-linenumber="8">
            <span class="hits">107</span>
            

            

            <code class="ruby">    (facets_without_tags + sort_options).join(&quot;, &quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :filters, :sort_options</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facets_without_tags</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="107" data-linenumber="16">
            <span class="hits">107</span>
            

            

            <code class="ruby">    description = filters.select(&amp;:hide_facet_tag?).each_with_object([]) do |filter, facets_description|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="34" data-linenumber="17">
            <span class="hits">34</span>
            

            

            <code class="ruby">      label = filter_label(filter)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="34" data-linenumber="18">
            <span class="hits">34</span>
            

            

            <code class="ruby">      facets_description &lt;&lt; &quot;#{filter.preposition} #{label}&quot; unless label.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="107" data-linenumber="21">
            <span class="hits">107</span>
            

            

            <code class="ruby">    description.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filter_label(filter)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="48" data-linenumber="25">
            <span class="hits">48</span>
            

            

            <code class="ruby">    selected_option = filter.allowed_values.find { |option| option[&quot;value&quot;] == filter.value }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="34" data-linenumber="26">
            <span class="hits">34</span>
            

            

            <code class="ruby">    return selected_option[&quot;label&quot;] unless selected_option.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="22" data-linenumber="28">
            <span class="hits">22</span>
            

            

            <code class="ruby">    default_option = filter.allowed_values.find { |option| option[&quot;default&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="22" data-linenumber="29">
            <span class="hits">22</span>
            

            

            <code class="ruby">    return default_option[&quot;label&quot;] unless default_option.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">    nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="8e22bd8968b405b262c27439a0d1c16640710622">
  <div class="header">
    <h3>app/presenters/search_result_presenter.rb</h3>
    <h4>
      <span class="red">
  75.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>44</b> relevant lines.
      <span class="green"><b>33</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class SearchResultPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActionView::Helpers::SanitizeHelper</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  delegate :title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">           :parts,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">           :is_historic,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">           :government_name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">           :format,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">           :score,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">           :es_score,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">           :original_rank,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">           to: :document</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(document:, rank:, metadata_presenter_class:, doc_count:, facets:, content_item:, debug_score:)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="15">
            <span class="hits">157</span>
            

            

            <code class="ruby">    @document = document</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="16">
            <span class="hits">157</span>
            

            

            <code class="ruby">    @rank = rank</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="17">
            <span class="hits">157</span>
            

            

            <code class="ruby">    @metadata = metadata_presenter_class.new(document.metadata(facets)).present</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="18">
            <span class="hits">157</span>
            

            

            <code class="ruby">    @count = doc_count</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="19">
            <span class="hits">157</span>
            

            

            <code class="ruby">    @debug_score = debug_score</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="20">
            <span class="hits">157</span>
            

            

            <code class="ruby">    @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def document_list_component_data</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="25">
            <span class="hits">157</span>
            

            

            <code class="ruby">      link: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">        text: title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">        path: link,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">        description: sanitize(summary_text),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">        data_attributes: ecommerce_data(link, title),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">      metadata: structure_metadata,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">      metadata_raw: metadata,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">      subtext: subtext,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">      parts: structure_parts,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class MalformedPartError &lt; StandardError; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def link</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="314" data-linenumber="43">
            <span class="hits">314</span>
            

            

            <code class="ruby">    document.path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def summary_text</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="47">
            <span class="hits">157</span>
            

            

            <code class="ruby">    document.truncated_description if content_item.show_summaries?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="50">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def subtext</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="51">
            <span class="hits">157</span>
            

            

            <code class="ruby">    published_text = &quot;&lt;span class=&#39;published-by&#39;&gt;#{I18n.t(&#39;finders.search_result_presenter.first_published_during&#39;)} #{government_name}&lt;/span&gt;&quot; if is_historic</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="52">
            <span class="hits">157</span>
            

            

            <code class="ruby">    if @debug_score</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="53">
            
            

            

            <code class="ruby">      debug_text = &quot;&lt;span class=&#39;debug-results debug-results--link&#39;&gt;#{link}&lt;/span&gt;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="54">
            
            

            

            <code class="ruby">      debug_text += if score</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="55">
            
            

            

            <code class="ruby">                      &quot;&lt;span class=&#39;debug-results debug-results--meta&#39;&gt;Score: #{score} (ranked ##{@rank})&lt;/span&gt;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">                    else</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="57">
            
            

            

            <code class="ruby">                      &quot;&lt;span class=&#39;debug-results debug-results--meta&#39;&gt;Ranked: ##{@rank}&lt;/span&gt;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">                    end</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="59">
            
            

            

            <code class="ruby">      debug_text += &quot;&lt;span class=&#39;debug-results debug-results--meta&#39;&gt;Original score: #{es_score} (ranked ##{original_rank})&lt;/span&gt;&quot; if es_score &amp;&amp; original_rank</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="60">
            
            

            

            <code class="ruby">      debug_text += &quot;&lt;span class=&#39;debug-results debug-results--meta&#39;&gt;Format: #{format}&lt;/span&gt;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="63">
            <span class="hits">157</span>
            

            

            <code class="ruby">    sanitize(&quot;#{published_text}#{debug_text}&quot;) if published_text || debug_text</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="66">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def structure_metadata</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="67">
            <span class="hits">157</span>
            

            

            <code class="ruby">    metadata.each_with_object({}) do |meta, component_metadata|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="227" data-linenumber="68">
            <span class="hits">227</span>
            

            

            <code class="ruby">      next if meta[:is_date] &amp;&amp; format == &quot;recommended-link&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="227" data-linenumber="70">
            <span class="hits">227</span>
            

            

            <code class="ruby">      value = meta[:is_date] ? &quot;&lt;time datetime=&#39;#{meta[:machine_date]}&#39;&gt;#{meta[:human_date]}&lt;/time&gt;&quot; : meta[:value]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="227" data-linenumber="71">
            <span class="hits">227</span>
            

            

            <code class="ruby">      component_metadata[meta[:label]] = sanitize(&quot;#{meta[:label]}: #{value}&quot;, tags: %w[time span])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="75">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def structure_parts</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="76">
            <span class="hits">157</span>
            

            

            <code class="ruby">    structured_parts = parts.map.with_index(1) do |part, index|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="77">
            
            

            

            <code class="ruby">      has_required_data = %i[title slug body].all? { |key| part.key? key }</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="78">
            
            

            

            <code class="ruby">      unless has_required_data</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="79">
            
            

            

            <code class="ruby">        GovukError.notify(MalformedPartError.new, extra: { part: part, link: link })</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="80">
            
            

            

            <code class="ruby">        next</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="83">
            
            

            

            <code class="ruby">        link: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">          text: part[:title],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby">          path: &quot;#{link}/#{part[:slug]}&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">          description: part[:body],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">          data_attributes: ecommerce_data(&quot;#{link}/#{part[:slug]}&quot;, part[:title], part_index: index),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="91">
            <span class="hits">157</span>
            

            

            <code class="ruby">    structured_parts.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="94">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def ecommerce_data(link, title, part_index: nil)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="157" data-linenumber="96">
            <span class="hits">157</span>
            

            

            <code class="ruby">      ecommerce_path: link,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">      ecommerce_row: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">      ecommerce_index: document.index,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">      track_category: &quot;navFinderLinkClicked&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">      track_action: [content_item.title, document.index, part_index].compact.join(&quot;.&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby">      track_label: link,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby">      track_options: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="103">
            
            

            

            <code class="ruby">        dimension22: part_index,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">        dimension28: @count,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby">        dimension29: title,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            
            

            

            <code class="ruby">      }.compact,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="107">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="108">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="109">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="110">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :document, :metadata, :content_item</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="6e49e4ecb28f03cf17631b562ce81bb9d6aa62be">
  <div class="header">
    <h3>app/presenters/signup_links_presenter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>22</b> relevant lines.
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class SignupLinksPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(content_item, facets, keywords)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="3">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="4">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @facets = facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="5">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @keywords = keywords</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def signup_links</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="10">
            <span class="hits">54</span>
            

            

            <code class="ruby">      feed_link: feed_link,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">      hide_heading: true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">      small_form: true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">      email_signup_link: email_signup_link.presence,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">    }.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :content_item, :facets, :keywords</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def email_signup_link</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="22">
            <span class="hits">54</span>
            

            

            <code class="ruby">    signup_link = content_item.signup_link</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="23">
            <span class="hits">54</span>
            

            

            <code class="ruby">    return signup_link if signup_link.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="25">
            <span class="hits">54</span>
            

            

            <code class="ruby">    &quot;#{content_item.email_alert_signup[&#39;base_path&#39;]}#{query_string(alert_query_params)}&quot; if content_item.email_alert_signup</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def feed_link</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="29">
            <span class="hits">54</span>
            

            

            <code class="ruby">    &quot;#{content_item.base_path}.atom#{query_string(alert_query_params.merge(keywords: keywords))}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def alert_query_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="101" data-linenumber="33">
            <span class="hits">101</span>
            

            

            <code class="ruby">    facets_with_filters = facets.select(&amp;:has_filters?)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="101" data-linenumber="34">
            <span class="hits">101</span>
            

            

            <code class="ruby">    query_params_array = facets_with_filters.map(&amp;:query_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="101" data-linenumber="35">
            <span class="hits">101</span>
            

            

            <code class="ruby">    query_params_array.inject({}, :merge)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def query_string(params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="101" data-linenumber="39">
            <span class="hits">101</span>
            

            

            <code class="ruby">    query_string = params.compact.to_query</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="101" data-linenumber="40">
            <span class="hits">101</span>
            

            

            <code class="ruby">    query_string.blank? ? query_string : &quot;?#{query_string}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="abfeafb3bcba9182e87d3b88dd3f8213b06bcdb4">
  <div class="header">
    <h3>app/presenters/signup_presenter.rb</h3>
    <h4>
      <span class="green">
  95.65%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>46</b> relevant lines.
      <span class="green"><b>44</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class SignupPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActionView::Helpers::UrlHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ActionView::Helpers::CaptureHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :content_item, :params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(content_item, params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="7">
            <span class="hits">4</span>
            

            

            <code class="ruby">    @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="8">
            <span class="hits">4</span>
            

            

            <code class="ruby">    @params = params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def page_title</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="12">
            <span class="hits">4</span>
            

            

            <code class="ruby">    &quot;#{name} emails&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def name</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="16">
            <span class="hits">12</span>
            

            

            <code class="ruby">    content_item[&quot;title&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def body</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="20">
            <span class="hits">12</span>
            

            

            <code class="ruby">    content_item[&quot;description&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def beta?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="24">
            <span class="hits">4</span>
            

            

            <code class="ruby">    content_item[&quot;details&quot;][&quot;beta&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def email_filter_by</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="28">
            <span class="hits">8</span>
            

            

            <code class="ruby">    content_item.dig(&quot;details&quot;, &quot;email_filter_by&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def can_modify_choices?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="32">
            <span class="hits">8</span>
            

            

            <code class="ruby">    choices? &amp;&amp; choices_formatted.any? &amp;&amp; email_filter_by != &quot;all_selected_facets&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def hidden_choices</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="36">
            <span class="hits">4</span>
            

            

            <code class="ruby">    hidden_choices = choices.map do |choice|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="37">
            <span class="hits">8</span>
            

            

            <code class="ruby">      next unless ignore_facet?(choice[&quot;facet_id&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            
            

            

            <code class="ruby">      choice[&quot;facet_choices&quot;].map do |facet_choice|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="41">
            
            

            

            <code class="ruby">          name: &quot;filter[#{choice[&#39;facet_id&#39;]}][]&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">          value: facet_choice[&quot;key&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="46">
            <span class="hits">4</span>
            

            

            <code class="ruby">    hidden_choices.flatten.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def choices?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="50">
            <span class="hits">8</span>
            

            

            <code class="ruby">    email_filter_facets.present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def choices</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="24" data-linenumber="54">
            <span class="hits">24</span>
            

            

            <code class="ruby">    email_filter_facets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def choices_formatted</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="58">
            <span class="hits">12</span>
            

            

            <code class="ruby">    @choices_formatted ||= facets_with_choices.map { |choice|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="60">
            <span class="hits">8</span>
            

            

            <code class="ruby">        label: choice[&quot;facet_name&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">        value: choice[&quot;facet_id&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">        checked: choice[&quot;prechecked&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">        items: choice[&quot;facet_choices&quot;].map do |facet_choice|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">          {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="65">
            <span class="hits">16</span>
            

            

            <code class="ruby">            name: &quot;filter[#{choice[&#39;facet_id&#39;]}][]&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">            label: facet_choice[&quot;radio_button_name&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">            value: facet_choice[&quot;key&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">            checked: facet_choice[&quot;prechecked&quot;] || selected_choices.fetch(choice[&quot;facet_id&quot;], []).include?(facet_choice[&quot;key&quot;]),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">          }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">        end,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby">    }.compact</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="75">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="77">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facets_with_choices</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="78">
            <span class="hits">4</span>
            

            

            <code class="ruby">    choices.select do |choice|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="79">
            <span class="hits">8</span>
            

            

            <code class="ruby">      choice[&quot;facet_choices&quot;] &amp;&amp; choice[&quot;facet_choices&quot;].any? &amp;&amp; !ignore_facet?(choice[&quot;facet_id&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="83">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_choices</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="84">
            <span class="hits">16</span>
            

            

            <code class="ruby">    choices.each_with_object({}) do |choice, hash|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="85">
            <span class="hits">32</span>
            

            

            <code class="ruby">      key = choice[&quot;facet_id&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="86">
            <span class="hits">32</span>
            

            

            <code class="ruby">      next unless params.key?(key)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="88">
            <span class="hits">8</span>
            

            

            <code class="ruby">      hash[choice[&quot;facet_id&quot;]] = Array(params[key])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="92">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def email_filter_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="93">
            <span class="hits">32</span>
            

            

            <code class="ruby">    content_item[&quot;details&quot;].fetch(&quot;email_filter_facets&quot;, [])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="96">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def ignore_facet?(facet_id)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="97">
            <span class="hits">16</span>
            

            

            <code class="ruby">    %w[facet_groups].include?(facet_id)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2eceedd192d8454ab94792d080713ea5794cc7c3">
  <div class="header">
    <h3>app/presenters/sort_option_presenter.rb</h3>
    <h4>
      <span class="green">
  94.12%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>17</b> relevant lines.
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class SortOptionPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :value, :key, :label</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(label:, value: nil, key:, default: false, disabled: false, selected: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="5">
            <span class="hits">136</span>
            

            

            <code class="ruby">    @label = label</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="6">
            <span class="hits">136</span>
            

            

            <code class="ruby">    @value = value || label.parameterize</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="7">
            <span class="hits">136</span>
            

            

            <code class="ruby">    @key = key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="8">
            <span class="hits">136</span>
            

            

            <code class="ruby">    @default = default</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="9">
            <span class="hits">136</span>
            

            

            <code class="ruby">    @disabled = disabled</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="10">
            <span class="hits">136</span>
            

            

            <code class="ruby">    @selected = selected</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def default?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="267" data-linenumber="14">
            <span class="hits">267</span>
            

            

            <code class="ruby">    default.present? &amp;&amp; default</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def to_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="408" data-linenumber="19">
            <span class="hits">408</span>
            

            

            <code class="ruby">      label: label,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">      value: value,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">      data_track_category: &quot;dropDownClicked&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">      data_track_action: &quot;clicked&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">      data_track_label: label,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">      selected: selected,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">      disabled: disabled,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :default, :selected, :disabled</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def tracking_attributes</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="35">
            
            

            

            <code class="ruby">      &quot;data-track-category&quot; =&gt; &quot;dropDownClicked&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      &quot;data-track-action&quot; =&gt; &quot;clicked&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">      &quot;data-track-label&quot; =&gt; label,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="86fb29e7e95bb5635e2a55ba0ec8536ae753190d">
  <div class="header">
    <h3>app/presenters/sort_presenter.rb</h3>
    <h4>
      <span class="green">
  95.83%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>48</b> relevant lines.
      <span class="green"><b>46</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class SortPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(content_item, filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="3">
            <span class="hits">112</span>
            

            

            <code class="ruby">    @user_selected_order = filter_params[&quot;order&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="4">
            <span class="hits">112</span>
            

            

            <code class="ruby">    @keywords = filter_params[&quot;keywords&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="112" data-linenumber="5">
            <span class="hits">112</span>
            

            

            <code class="ruby">    @content_item_sort_options = content_item.sort_options</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def to_hash</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="148" data-linenumber="9">
            <span class="hits">148</span>
            

            

            <code class="ruby">    return nil unless has_options?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="120" data-linenumber="12">
            <span class="hits">120</span>
            

            

            <code class="ruby">      options: options_as_hashes,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">      default_value: default_value,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">      relevance_value: option_value(relevance_option),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def default_option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="134" data-linenumber="19">
            <span class="hits">134</span>
            

            

            <code class="ruby">    presented_sort_options.find(&amp;:default?)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def default_value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="120" data-linenumber="23">
            <span class="hits">120</span>
            

            

            <code class="ruby">    default_option.try(:value)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def selected_option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="523" data-linenumber="27">
            <span class="hits">523</span>
            

            

            <code class="ruby">    user_selected_option || raw_default_option</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sort_options</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2620" data-linenumber="31">
            <span class="hits">2620</span>
            

            

            <code class="ruby">    content_item_sort_options</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :user_selected_order, :keywords, :content_item_sort_options</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  RELEVANCE_OPTION_TYPES = %w[relevance -relevance].freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  POPULARITY_OPTION_TYPES = %w[popularity -popularity].freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_options?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="148" data-linenumber="43">
            <span class="hits">148</span>
            

            

            <code class="ruby">    content_item_sort_options.any?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def presented_sort_options</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="254" data-linenumber="47">
            <span class="hits">254</span>
            

            

            <code class="ruby">    @presented_sort_options ||= sort_options.map do |option|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="48">
            <span class="hits">136</span>
            

            

            <code class="ruby">      SortOptionPresenter.new(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">        label: option[&quot;name&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">        value: option_value(option),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">        key: option[&quot;key&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">        default: option_value(option) == option_value(raw_default_option),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">        selected: option_value(option) == option_value(selected_option),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">        disabled: option_value(option) == disabled_option_value,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="59">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def options_as_hashes</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="120" data-linenumber="60">
            <span class="hits">120</span>
            

            

            <code class="ruby">    presented_sort_options.map(&amp;:to_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def user_selected_option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2121" data-linenumber="64">
            <span class="hits">2121</span>
            

            

            <code class="ruby">    selected = sort_options.find { |option| option_value(option) == user_selected_order }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="523" data-linenumber="65">
            <span class="hits">523</span>
            

            

            <code class="ruby">    if selected == popularity_option &amp;&amp; !relevance_option.nil? &amp;&amp; keywords.present?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="66">
            
            

            

            <code class="ruby">      relevance_option</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="523" data-linenumber="68">
            <span class="hits">523</span>
            

            

            <code class="ruby">      selected</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="72">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def disabled_option_value</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="73">
            <span class="hits">136</span>
            

            

            <code class="ruby">    if keywords.blank?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="122" data-linenumber="74">
            <span class="hits">122</span>
            

            

            <code class="ruby">      relevance_option.present? ? option_value(relevance_option) : &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="76">
            <span class="hits">14</span>
            

            

            <code class="ruby">      popularity_option.present? ? option_value(popularity_option) : &quot;&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="80">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def raw_default_option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1395" data-linenumber="81">
            <span class="hits">1395</span>
            

            

            <code class="ruby">    default = sort_options.find { |option| option[&quot;default&quot;] }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="462" data-linenumber="82">
            <span class="hits">462</span>
            

            

            <code class="ruby">    if default == popularity_option &amp;&amp; !relevance_option.nil? &amp;&amp; keywords.present?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="83">
            
            

            

            <code class="ruby">      relevance_option</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="462" data-linenumber="85">
            <span class="hits">462</span>
            

            

            <code class="ruby">      default</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="89">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def relevance_option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1516" data-linenumber="90">
            <span class="hits">1516</span>
            

            

            <code class="ruby">    sort_options.find { |option| RELEVANCE_OPTION_TYPES.include?(option[&quot;key&quot;]) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="93">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def popularity_option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2426" data-linenumber="94">
            <span class="hits">2426</span>
            

            

            <code class="ruby">    sort_options.find { |option| POPULARITY_OPTION_TYPES.include?(option[&quot;key&quot;]) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="97">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def option_value(option)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2670" data-linenumber="98">
            <span class="hits">2670</span>
            

            

            <code class="ruby">    return if option.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2670" data-linenumber="100">
            <span class="hits">2670</span>
            

            

            <code class="ruby">    option.fetch(&quot;value&quot;, option.fetch(&quot;name&quot;, &quot;&quot;).parameterize)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="80e70a4020126e9243dbf23f01caa93b32b42f35">
  <div class="header">
    <h3>app/presenters/spelling_suggestion_presenter.rb</h3>
    <h4>
      <span class="yellow">
  87.5%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>8</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class SpellingSuggestionPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(suggested_queries, url, content_item_path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="3">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @suggested_queries = suggested_queries</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="4">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @url = url</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="5">
            <span class="hits">54</span>
            

            

            <code class="ruby">    @content_item_path = content_item_path</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def suggestions</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    @suggested_queries.map do |suggestion|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">        keywords: suggestion[&quot;text&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">        highlighted: suggestion[&quot;highlighted&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">        link: @url,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">        data_attributes: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">          ecommerce_path: @content_item_path,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">          ecommerce_row: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">          track_options: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">            dimension81: suggestion[&quot;text&quot;],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="1b01d6d58815108dee7b27e0ad0aa83dfeede73a">
  <div class="header">
    <h3>app/presenters/statistics_metadata_presenter.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>12</b> relevant lines.
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class StatisticsMetadataPresenter &lt; MetadataPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def present</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby">    formatted_metadata =</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="4">
            <span class="hits">16</span>
            

            

            <code class="ruby">      raw_metadata.map do |datum|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="5">
            <span class="hits">32</span>
            

            

            <code class="ruby">        case datum.fetch(:type)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">        when &quot;date&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="7">
            <span class="hits">16</span>
            

            

            <code class="ruby">          build_date_metadata(datum)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">        when &quot;text&quot;, &quot;content_id&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="9">
            <span class="hits">16</span>
            

            

            <code class="ruby">          build_text_metadata(datum)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="12">
            <span class="hits">16</span>
            

            

            <code class="ruby">    select_date_key(formatted_metadata)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def select_date_key(metadata)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="18">
            <span class="hits">16</span>
            

            

            <code class="ruby">    multiple_date_fields? ? metadata.reject { |key| key[:label] == &quot;Updated&quot; } : metadata</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def multiple_date_fields?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="22">
            <span class="hits">16</span>
            

            

            <code class="ruby">    raw_metadata.pluck(:name).include?(&quot;Release date&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f0b242feff2583a6dca5a17403f6cd1edab63049">
  <div class="header">
    <h3>app/presenters/statistics_sort_presenter.rb</h3>
    <h4>
      <span class="green">
  93.55%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>31</b> relevant lines.
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class StatisticsSortPresenter &lt; SortPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(content_item, filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="3">
            <span class="hits">14</span>
            

            

            <code class="ruby">    @doc_type = filter_params[&quot;content_store_document_type&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="4">
            <span class="hits">14</span>
            

            

            <code class="ruby">    super(content_item, filter_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sort_options</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4279" data-linenumber="8">
            <span class="hits">4279</span>
            

            

            <code class="ruby">    content_item_sort_options.reject { |o| excluded? o }.map { |o| rename o }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :doc_type, :user_selected_order, :keywords, :content_item_sort_options</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  RELEVANCE_OPTION_TYPES = %w[relevance -relevance].freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  EXCLUDED_OPTIONS = {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">    any: [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">    public: %w[-release_timestamp release_timestamp],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    upcoming: %w[-public_timestamp public_timestamp],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  }.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  DEFAULT_KEY = {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">    any: &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    public: &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">    upcoming: &quot;release_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">  }.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">  RENAMED_OPTIONS = {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">    &quot;upcoming_statistics&quot; =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">      &quot;release_timestamp&quot; =&gt; &quot;Release date (soonest)&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">    },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">  }.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def default_key</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="332" data-linenumber="33">
            <span class="hits">332</span>
            

            

            <code class="ruby">    DEFAULT_KEY[sort_type]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def is_default?(option)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="37">
            
            

            

            <code class="ruby">    option[&quot;key&quot;] == default_key</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def raw_default_option</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="437" data-linenumber="41">
            <span class="hits">437</span>
            

            

            <code class="ruby">    sort_options.find { |option| option[&quot;key&quot;] == default_key }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def excluded?(option)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2334" data-linenumber="45">
            <span class="hits">2334</span>
            

            

            <code class="ruby">    EXCLUDED_OPTIONS[sort_type].include? option[&quot;key&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rename(option)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1556" data-linenumber="49">
            <span class="hits">1556</span>
            

            

            <code class="ruby">    name = RENAMED_OPTIONS.dig(doc_type, option[&quot;key&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1556" data-linenumber="50">
            <span class="hits">1556</span>
            

            

            <code class="ruby">    if name</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="63" data-linenumber="51">
            <span class="hits">63</span>
            

            

            <code class="ruby">      option.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">        &quot;name&quot; =&gt; name,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">        &quot;value&quot; =&gt; option[&quot;name&quot;].parameterize,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1493" data-linenumber="56">
            <span class="hits">1493</span>
            

            

            <code class="ruby">      option</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="60">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def sort_type</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2666" data-linenumber="61">
            <span class="hits">2666</span>
            

            

            <code class="ruby">    case doc_type</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">    when &quot;upcoming_statistics&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="446" data-linenumber="63">
            <span class="hits">446</span>
            

            

            <code class="ruby">      :upcoming</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">    when &quot;statistics_published&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="504" data-linenumber="65">
            <span class="hits">504</span>
            

            

            <code class="ruby">      :public</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">    when &quot;cancelled_statistics&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="67">
            
            

            

            <code class="ruby">      :any</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">    else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1716" data-linenumber="69">
            <span class="hits">1716</span>
            

            

            <code class="ruby">      :public</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="977c5f13daa592dee729a82e72c7e5421abbafd7">
  <div class="header">
    <h3>app/presenters/subscriber_list_params_presenter.rb</h3>
    <h4>
      <span class="green">
  94.44%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>36</b> relevant lines.
      <span class="green"><b>34</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class SubscriberListParamsPresenter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(content_item, params)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="3">
            <span class="hits">4</span>
            

            

            <code class="ruby">    @content_item = content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="4">
            <span class="hits">4</span>
            

            

            <code class="ruby">    @params = params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def subscriber_list_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="8">
            <span class="hits">4</span>
            

            

            <code class="ruby">    @subscriber_list_params ||= filtered_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :content_item, :params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filtered_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="16">
            <span class="hits">4</span>
            

            

            <code class="ruby">    used_facets.each_with_object(hash_with_default_as_array) do |facet, hash|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="17">
            <span class="hits">2</span>
            

            

            <code class="ruby">      key = facet_filter_key(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="18">
            <span class="hits">2</span>
            

            

            <code class="ruby">      value = facet_filter_value(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="20">
            <span class="hits">2</span>
            

            

            <code class="ruby">      hash[key].concat Array(value)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def used_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="25">
            <span class="hits">4</span>
            

            

            <code class="ruby">    facets.select do |facet|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="26">
            <span class="hits">8</span>
            

            

            <code class="ruby">      params[facet[&quot;facet_id&quot;]].present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="31">
            <span class="hits">4</span>
            

            

            <code class="ruby">    return allowed_facets if can_modify_choices?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="33">
            <span class="hits">4</span>
            

            

            <code class="ruby">    email_filter_facets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def can_modify_choices?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="37">
            <span class="hits">4</span>
            

            

            <code class="ruby">    !content_item[&quot;details&quot;][&quot;email_filter_by&quot;] == &quot;all_selected_facets&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def email_filter_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="41">
            <span class="hits">4</span>
            

            

            <code class="ruby">    content_item[&quot;details&quot;].fetch(&quot;email_filter_facets&quot;, [])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def allowed_facets</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="45">
            
            

            

            <code class="ruby">    email_filter_facets.reject { |facet| facet.key?(&quot;facet_choices&quot;) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def hash_with_default_as_array</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="49">
            <span class="hits">6</span>
            

            

            <code class="ruby">    Hash.new { |hash, key| hash[key] = []; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="52">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facet_filter_key(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="53">
            <span class="hits">2</span>
            

            

            <code class="ruby">    facet[&quot;filter_key&quot;] || facet[&quot;facet_id&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="56">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facet_filter_value(facet)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="57">
            <span class="hits">2</span>
            

            

            <code class="ruby">    return facet[&quot;filter_value&quot;] if facet[&quot;filter_value&quot;].present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="59">
            <span class="hits">2</span>
            

            

            <code class="ruby">    values = Array(params[facet[&quot;facet_id&quot;]])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="61">
            <span class="hits">2</span>
            

            

            <code class="ruby">    return facet_option_lookup_values(values, facet) if facet[&quot;option_lookup&quot;].present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="63">
            <span class="hits">2</span>
            

            

            <code class="ruby">    values</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="66">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facet_option_lookup_values(values, facet)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="67">
            
            

            

            <code class="ruby">    facet[&quot;option_lookup&quot;].select { |key, _| values.include? key }.values.flatten</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="274fa4b3c17f00fe969d308bd30c4cdd469f3985">
  <div class="header">
    <h3>app/validators/date_validator.rb</h3>
    <h4>
      <span class="green">
  90.48%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>21</b> relevant lines.
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class DateValidator</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(query)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="3">
            <span class="hits">136</span>
            

            

            <code class="ruby">    @query = query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def validate_to_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="7">
            <span class="hits">68</span>
            

            

            <code class="ruby">    query.errors.add(:to_date, error_message) if invalid_date?(to_date)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def validate_from_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="11">
            <span class="hits">68</span>
            

            

            <code class="ruby">    query.errors.add(:from_date, error_message) if invalid_date?(from_date)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def date_errors_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">      date_type =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">        from: invalid_date?(from_date),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">        to: invalid_date?(to_date),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def from_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="28">
            <span class="hits">68</span>
            

            

            <code class="ruby">    query.filter_params.dig(date_type, :from)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def to_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="32">
            <span class="hits">68</span>
            

            

            <code class="ruby">    query.filter_params.dig(date_type, :to)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">  # The date facet on search/all filters on public_timestamp, but the specialist</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  # finders use a variety of different types. Error messages are</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">  # currently only implemented on search/all.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def date_type</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="40">
            <span class="hits">136</span>
            

            

            <code class="ruby">    :public_timestamp</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def invalid_date?(user_input)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="44">
            <span class="hits">136</span>
            

            

            <code class="ruby">    user_input.present? &amp;&amp; DateParser.new.parse(user_input).nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def error_message</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="48">
            
            

            

            <code class="ruby">    &quot;Enter a real date&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ab1c7a025575331154d656851263b597013d5726">
  <div class="header">
    <h3>app/validators/email_alert_params_validator.rb</h3>
    <h4>
      <span class="red">
  69.23%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>13</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class EmailAlertParamsValidator &lt; ActiveModel::EachValidator</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def validate_each(record, attribute, filter)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="3">
            <span class="hits">2</span>
            

            

            <code class="ruby">    unless filter.is_a? Hash</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            
            

            

            <code class="ruby">      record.errors[attribute] &lt;&lt; &quot;is not a Hash&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="5">
            
            

            

            <code class="ruby">      return</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="8">
            <span class="hits">2</span>
            

            

            <code class="ruby">    if invalidly_formatted(filter.keys).any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            
            

            

            <code class="ruby">      record.errors[attribute] &lt;&lt; &quot;has some unprocessable filter keys&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="12">
            <span class="hits">2</span>
            

            

            <code class="ruby">    if invalidly_formatted(filter.values.flatten).any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="13">
            
            

            

            <code class="ruby">      record.errors[attribute] &lt;&lt; &quot;has some unprocessable filter values&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def invalidly_formatted(values)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">    # Allow alphanumerics, hyphens, and some legacy special characters.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="21">
            <span class="hits">4</span>
            

            

            <code class="ruby">    values.reject do |val|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="22">
            <span class="hits">4</span>
            

            

            <code class="ruby">      val.to_s.match?(/\A[a-zA-Z0-9\-_]*\z/)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="5d7944d3d1e247ebff430ec77e2e9bd4d8ac5909">
  <div class="header">
    <h3>app/validators/param_validator.rb</h3>
    <h4>
      <span class="yellow">
  88.89%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>18</b> relevant lines.
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">class ParamValidator &lt; ActiveModel::Validator</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def initialize(query)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="3">
            <span class="hits">68</span>
            

            

            <code class="ruby">    @query = query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def validate</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="7">
            <span class="hits">68</span>
            

            

            <code class="ruby">    validate_from_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="8">
            <span class="hits">68</span>
            

            

            <code class="ruby">    validate_to_date</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def errors_hash</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            
            

            

            <code class="ruby">    {}.merge(date_errors)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">  attr_reader :query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def date_errors</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="20">
            
            

            

            <code class="ruby">    date_validator.date_errors_hash</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def validate_from_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="24">
            <span class="hits">68</span>
            

            

            <code class="ruby">    date_validator.validate_from_date</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def validate_to_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="68" data-linenumber="28">
            <span class="hits">68</span>
            

            

            <code class="ruby">    date_validator.validate_to_date</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def date_validator</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="32">
            <span class="hits">136</span>
            

            

            <code class="ruby">    DateValidator.new(query)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="8d15eacfdf2955e0dc8227f9ecafbe4fb9383b37">
  <div class="header">
    <h3>config/application.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>21</b> relevant lines.
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">require_relative &quot;boot&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;rails&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># Pick the frameworks you want:</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;active_model/railtie&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;active_job/railtie&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"># require &quot;active_record/railtie&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"># require &quot;active_storage/engine&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;action_controller/railtie&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;action_mailer/railtie&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"># require &quot;action_mailbox/engine&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"># require &quot;action_text/engine&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;action_view/railtie&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"># require &quot;action_cable/engine&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;sprockets/railtie&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"># require &quot;rails/test_unit/railtie&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"># Require the gems listed in Gemfile, including any gems</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"># you&#39;ve limited to :test, :development, or :production.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">Bundler.require(*Rails.groups)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">if !Rails.env.production? || ENV[&quot;HEROKU_APP_NAME&quot;].present?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  require &quot;govuk_publishing_components&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">module FinderFrontend</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  class Application &lt; Rails::Application</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    # Set Time.zone default to the specified zone and make Active Record auto-convert to this zone.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">    # Run &quot;rake -D time&quot; for a list of tasks for finding time zone names. Default is UTC.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">    # config.time_zone = &#39;Central Time (US &amp; Canada)&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">    # config.i18n.default_locale = :de</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">    # Initialize configuration defaults for originally generated Rails version.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">    config.load_defaults 6.0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">    config.i18n.load_path += Dir[Rails.root.join(&quot;config/locales/**/*yml&quot;)]</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">    config.action_view.raise_on_missing_translations = true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">    # Override Rails 4 default which restricts framing to SAMEORIGIN.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">    config.action_dispatch.default_headers = {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">      &quot;X-Frame-Options&quot; =&gt; &quot;ALLOWALL&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">    # Path within public/ where assets are compiled to</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">    config.assets.prefix = &quot;/assets/finder-frontend&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">    # allow overriding the asset host with an enironment variable, useful for</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">    # when router is proxying to this app but asset proxying isn&#39;t set up.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">    config.asset_host = ENV[&quot;ASSET_HOST&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">    # Settings in config/environments/* take precedence over those specified here.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">    # Application configuration can go into files in config/initializers</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">    # -- all .rb files in that directory are automatically loaded after loading</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">    # the framework and any gems in your application.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">    # Using a sass css compressor causes a scss file to be processed twice</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">    # (once to build, once to compress) which breaks the usage of &quot;unquote&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">    # to use CSS that has same function names as SCSS such as max.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">    # https://github.com/alphagov/govuk-frontend/issues/1350</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="58">
            <span class="hits">1</span>
            

            

            <code class="ruby">    config.assets.css_compressor = nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">    # As part of the 2020 user discovery into GOV.UK accounts we want to deploy</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">    # a live prototype allowing Brexit/Transition checker users to persisit their</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">    # results page. We want to be able to toggle this feature on/off in the environment</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">    # so we can launch this seemlessly with finder-frontend&#39;s continuious deployment</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">    # and roll back if required.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="65">
            <span class="hits">1</span>
            

            

            <code class="ruby">    config.feature_flag_govuk_accounts = ENV[&quot;FEATURE_FLAG_ACCOUNTS&quot;] == &quot;enabled&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="18324319bd3293e6c6a2bc9ee953e2a634742486">
  <div class="header">
    <h3>config/boot.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">ENV[&quot;BUNDLE_GEMFILE&quot;] ||= File.expand_path(&quot;../Gemfile&quot;, __dir__)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;bundler/setup&quot; # Set up gems listed in the Gemfile.</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="80ccc3175e73b41c3a1a3271fc73302a57e1d533">
  <div class="header">
    <h3>config/environment.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Load the Rails application.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">require_relative &quot;application&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># Initialize the Rails application.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">Rails.application.initialize!</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="9ee2feff3300aeb2be2c6bf9006326d025fff116">
  <div class="header">
    <h3>config/environments/test.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>14</b> relevant lines.
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># The test environment is used exclusively to run your application&#39;s</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># test suite. You never need to work with it otherwise. Remember that</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># your test database is &quot;scratch space&quot; for the test suite and is wiped</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># and recreated between test runs. Don&#39;t rely on the data there!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">Rails.application.configure do</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  # Settings specified here will take precedence over those in config/application.rb.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  # We use the non-default in memory cache store for development purposes.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">  # It assumes memcached is running on localhost on the default port.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  #</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">  # More details:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  # https://guides.rubyonrails.org/caching_with_rails.html#activesupport-cache-memcachestore</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.cache_classes = true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.action_view.cache_template_loading = true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.cache_store = :memory_store</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">  # Do not eager load code on boot. This avoids loading your whole application</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">  # just for the purpose of running a single test. If you are using a tool that</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  # preloads Rails for running tests, you may have to set it to true.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.eager_load = false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  # Configure public file server for tests with Cache-Control for performance.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.public_file_server.enabled = true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.public_file_server.headers = {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">    &quot;Cache-Control&quot; =&gt; &quot;public, max-age=#{1.hour.to_i}&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">  }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">  # Show full error reports and disable caching.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.consider_all_requests_local       = true</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.action_controller.perform_caching = false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">  # Raise exceptions instead of rendering exception templates.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.action_dispatch.show_exceptions = false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  # Disable request forgery protection in test environment.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.action_controller.allow_forgery_protection = false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.action_mailer.perform_caching = false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">  # Tell Action Mailer not to deliver emails to the real world.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">  # The :test delivery method accumulates sent emails in the</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">  # ActionMailer::Base.deliveries array.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.action_mailer.delivery_method = :test</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">  # Print deprecation notices to the stderr.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.active_support.deprecation = :stderr</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">  # Raises error for missing translations.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">  # config.action_view.raise_on_missing_translations = true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="b5064653d0a4682a52281c99097fafffabc4a069">
  <div class="header">
    <h3>config/initializers/application_controller_renderer.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>0</b> relevant lines.
      <span class="green"><b>0</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># ActiveSupport::Reloader.to_prepare do</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">#   ApplicationController.renderer.defaults.merge!(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">#     http_host: &#39;example.org&#39;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">#     https: false</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">#   )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"># end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="629b3ac7dee70f24856bc2b32b8c21fcffd917e2">
  <div class="header">
    <h3>config/initializers/assets.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># Version of your assets, change this if you want to expire all your assets.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">Rails.application.config.assets.version = &quot;1.0&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"># Add additional assets to the asset load path.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"># Rails.application.config.assets.paths &lt;&lt; &quot;static&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"># Precompile additional assets.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"># application.js, application.css, and all non-JS/CSS in the app/assets</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"># folder are already added.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            <span class="hits">1</span>
            

            

            <code class="ruby">Rails.application.config.assets.precompile += %w[application.js print.css]</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2d021ded7bbbe5c9642d07dc2df7e0c6ccdf7023">
  <div class="header">
    <h3>config/initializers/backtrace_silencers.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>0</b> relevant lines.
      <span class="green"><b>0</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># You can add backtrace silencers for libraries that you&#39;re using but don&#39;t wish to see in your backtraces.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># Rails.backtrace_cleaner.add_silencer { |line| line =~ /my_noisy_library/ }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"># You can also remove all the silencers if you&#39;re trying to debug a problem that might stem from framework code.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"># Rails.backtrace_cleaner.remove_silencers!</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2f9d9a907aacccd60ea9abdb149dd4227bb02140">
  <div class="header">
    <h3>config/initializers/content_security_policy.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>0</b> relevant lines.
      <span class="green"><b>0</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># Define an application-wide content security policy</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># For further information see the following documentation</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"># https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"># Rails.application.config.content_security_policy do |policy|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">#   policy.default_src :self, :https</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">#   policy.font_src    :self, :https, :data</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">#   policy.img_src     :self, :https, :data</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">#   policy.object_src  :none</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">#   policy.script_src  :self, :https</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">#   policy.style_src   :self, :https</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">#   # Specify URI for violation reports</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">#   # policy.report_uri &quot;/csp-violation-report-endpoint&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"># end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"># If you are using UJS then enable automatic nonce generation</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"># Rails.application.config.content_security_policy_nonce_generator = -&gt; request { SecureRandom.base64(16) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"># Set the nonce only to specific directives</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"># Rails.application.config.content_security_policy_nonce_directives = %w(script-src)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"># Report CSP violations to a specified URI</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby"># For further information see the following documentation:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"># https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"># Rails.application.config.content_security_policy_report_only = true</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c0056af7a9f2b7d497009d908652ba61fded8ad7">
  <div class="header">
    <h3>config/initializers/cookies_serializer.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># Specify a serializer for the signed and encrypted cookie jars.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># Valid options are :json, :marshal, and :hybrid.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">Rails.application.config.action_dispatch.cookies_serializer = :json</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="011a4e61c5637fd822295094517db6f82151a83f">
  <div class="header">
    <h3>config/initializers/csp.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">GovukContentSecurityPolicy.configure</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="6db0ea846f5fd14b0fbf5bd26d4975565e0aaf1d">
  <div class="header">
    <h3>config/initializers/filter_parameter_logging.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># Configure sensitive parameters which will be filtered from the log file.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">Rails.application.config.filter_parameters += [:password]</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="4a7a45439f381aaad0a5531db16633bc2cb9c805">
  <div class="header">
    <h3>config/initializers/govuk_publishing_components.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">GovukPublishingComponents.configure do |c|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  c.component_guide_title = &quot;Finder Frontend Component Guide&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2115f35143208cb5938a283e2af1ba0f7ec4f93d">
  <div class="header">
    <h3>config/initializers/inflections.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>0</b> relevant lines.
      <span class="green"><b>0</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># Add new inflection rules using the following format. Inflections</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># are locale specific, and you may define rules for as many different</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"># locales as you wish. All of these examples are active by default:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"># ActiveSupport::Inflector.inflections(:en) do |inflect|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">#   inflect.plural /^(ox)$/i, &#39;\1en&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">#   inflect.singular /^(ox)en/i, &#39;\1&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">#   inflect.irregular &#39;person&#39;, &#39;people&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">#   inflect.uncountable %w( fish sheep )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"># end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"># These inflection rules are supported but not enabled by default:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"># ActiveSupport::Inflector.inflections(:en) do |inflect|</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">#   inflect.acronym &#39;RESTful&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"># end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="41ad92a1b29a88815b7b1a2f1958511576e3f235">
  <div class="header">
    <h3>config/initializers/mime_types.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>0</b> relevant lines.
      <span class="green"><b>0</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># Add new mime types for use in respond_to blocks:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># Mime::Type.register &quot;text/richtext&quot;, :rtf</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c7f1a95261b2a40feccecde316e36f4082a1f0b3">
  <div class="header">
    <h3>config/initializers/sanitizer.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">Rails::Html::WhiteListSanitizer.allowed_tags &lt;&lt; &quot;mark&quot;</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="3d5f1bc386f265f803d1d8c14bb8c187034566b3">
  <div class="header">
    <h3>config/initializers/session_store.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>1</b> relevant lines.
      <span class="green"><b>1</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">FinderFrontend::Application.config.session_store :cookie_store, expire_after: 15.minutes</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="80b4ad15896c1173531b8c845172b8e999e1bb0f">
  <div class="header">
    <h3>config/initializers/wrap_parameters.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Be sure to restart your server when you modify this file.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"># This file contains settings for ActionController::ParamsWrapper which</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># is enabled by default.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"># Enable parameter wrapping for JSON. You can disable this by setting :format to an empty array.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">ActiveSupport.on_load(:action_controller) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  wrap_parameters format: [:json] if respond_to?(:wrap_parameters)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="668f49036af12d467f0df72e90674a2f151635e4">
  <div class="header">
    <h3>config/initializers/zeitwerk.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>2</b> relevant lines.
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">Rails.autoloaders.each do |autoloader|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="2">
            <span class="hits">2</span>
            

            

            <code class="ruby">  autoloader.inflector.inflect(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby">    &quot;email_alert_signup_api&quot; =&gt; &quot;EmailAlertSignupAPI&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c0e21e9d727c6ade2b1f96c2929ac9793a4cad50">
  <div class="header">
    <h3>config/routes.rb</h3>
    <h4>
      <span class="green">
  94.12%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>34</b> relevant lines.
      <span class="green"><b>32</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FinderFrontend::Application.routes.draw do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  mount GovukPublishingComponents::Engine, at: &quot;/component-guide&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/healthcheck.json&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">      to: GovukHealthcheck.rack_response(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">        Healthchecks::RegistriesCache,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/healthcheck&quot;, to: proc { [200, {}, %w[OK]] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  root to: redirect(&quot;/development&quot;) unless Rails.env.test?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/development&quot; =&gt; &quot;development#index&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/search&quot; =&gt; &quot;search#index&quot;, as: :search</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/search/opensearch&quot; =&gt; &quot;search#opensearch&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">  if ENV[&quot;GOVUK_WEBSITE_ROOT&quot;] =~ /integration/ || ENV[&quot;GOVUK_WEBSITE_ROOT&quot;] =~ /staging/</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="17">
            
            

            

            <code class="ruby">    get &quot;/test-search/search&quot; =&gt; &quot;search#index&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">    get &quot;/test-search/search/opensearch&quot; =&gt; &quot;search#opensearch&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  scope &quot;/transition-check&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/results&quot; =&gt; &quot;brexit_checker#results&quot;, as: :transition_checker_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/questions&quot; =&gt; &quot;brexit_checker#show&quot;, as: :transition_checker_questions</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/email-signup&quot; =&gt; &quot;brexit_checker#email_signup&quot;, as: :transition_checker_email_signup</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    post &quot;/email-signup&quot; =&gt; &quot;brexit_checker#confirm_email_signup&quot;, as: :transition_checker_confirm_email_signup</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/login&quot;, to: &quot;sessions#create&quot;, as: :transition_checker_new_session</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/login/callback&quot;, to: &quot;sessions#callback&quot;, as: :transition_checker_new_session_callback</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/logout&quot;, to: &quot;sessions#delete&quot;, as: :transition_checker_end_session</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/save-your-results&quot; =&gt; &quot;brexit_checker#save_results&quot;, as: :transition_checker_save_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/save-your-results/confirm&quot;, to: &quot;brexit_checker#save_results_confirm&quot;, as: :transition_checker_save_results_confirm</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/save-your-results/email-signup&quot;, to: &quot;brexit_checker#save_results_email_signup&quot;, as: :transition_checker_save_results_email_signup</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            <span class="hits">1</span>
            

            

            <code class="ruby">    post &quot;/save-your-results/confirm&quot;, to: &quot;brexit_checker#save_results_apply&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/saved-results&quot;, to: &quot;brexit_checker#saved_results&quot;, as: :transition_checker_saved_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">    get &quot;/edit-saved-results&quot;, to: &quot;brexit_checker#edit_saved_results&quot;, as: :transition_checker_edit_saved_results</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">  # Transition/Brexit checker email signup routes</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/email/subscriptions/new&quot;, to: proc { [200, {}, [&quot;&quot;]] }, as: :email_alert_frontend_signup</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/*slug/email-signup&quot; =&gt; &quot;email_alert_subscriptions#new&quot;, as: :new_email_alert_subscriptions</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">  post &quot;/*slug/email-signup&quot; =&gt; &quot;email_alert_subscriptions#create&quot;, as: :email_alert_subscriptions</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">  # Q&amp;A frontend for &quot;UK Nationals in the EU&quot; (www.gov.uk/uk-nationals-in-the-eu)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/uk-nationals-living-eu&quot; =&gt; &quot;qa_to_content#show&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/search/advanced&quot; =&gt; &quot;redirection#advanced_search&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/*slug&quot; =&gt; &quot;redirection#redirect_covid&quot;, constraints: lambda { |request|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="49">
            <span class="hits">56</span>
            

            

            <code class="ruby">    topical_events = request.params[&quot;topical_events&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="56" data-linenumber="51">
            <span class="hits">56</span>
            

            

            <code class="ruby">    request.format == :html &amp;&amp;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">      topical_events &amp;&amp;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">      topical_events.include?(&quot;coronavirus-covid-19-uk-government-response&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">  }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">  # Whatever else you do here... keep this at the bottom of the file</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            <span class="hits">1</span>
            

            

            <code class="ruby">  get &quot;/*slug&quot; =&gt; &quot;finders#show&quot;, as: :finder</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="a2d2abb5a6ec0d50cba9096394ddc434889fb3eb">
  <div class="header">
    <h3>features/step_definitions/analytics_steps.rb</h3>
    <h4>
      <span class="red">
  17.14%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>35</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>29</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^the links on the page have tracking attributes$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="2">
            
            

            

            <code class="ruby">  visit finder_path(&quot;government/policies/benefits-reform&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            
            

            

            <code class="ruby">  expect(page).to have_selector(&#39;.finder-results[data-module=&quot;track-click&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="6">
            
            

            

            <code class="ruby">  document_links = page.all(&quot;.gem-c-document-list__item-title&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="7">
            
            

            

            <code class="ruby">  expect(document_links.count).to be_positive</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="9">
            
            

            

            <code class="ruby">  first_link = document_links.first</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">  expect(first_link[&quot;data-track-category&quot;]).to eq(&quot;navFinderLinkClicked&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="12">
            
            

            

            <code class="ruby">  expect(first_link[&quot;data-track-action&quot;]).to eq(&quot;Ministry of Silly Walks reports.1&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="13">
            
            

            

            <code class="ruby">  expect(first_link[&quot;data-track-label&quot;]).to eq(first_link[&quot;href&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="15">
            
            

            

            <code class="ruby">  options = JSON.parse(first_link[&quot;data-track-options&quot;])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="17">
            
            

            

            <code class="ruby">  expect(options[&quot;dimension28&quot;]).to eq(document_links.count)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">  expect(options[&quot;dimension29&quot;]).to eq(first_link.text)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^the ecommerce tracking tags are present$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">  visit finder_path(&quot;search/all&quot;, q: &quot;breakfast&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="24">
            
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;.js-live-search-results-block[data-analytics-ecommerce]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">  form = page.find(&quot;.js-live-search-results-block[data-analytics-ecommerce]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="27">
            
            

            

            <code class="ruby">  expect(form[&quot;data-ecommerce-start-index&quot;]).to eq(&quot;1&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="28">
            
            

            

            <code class="ruby">  expect(form[&quot;data-list-title&quot;]).to eq(&quot;Search&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="29">
            
            

            

            <code class="ruby">  expect(form[&quot;data-search-query&quot;]).to eq(&quot;breakfast&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="31">
            
            

            

            <code class="ruby">  results = page.all(&quot;a[data-ecommerce-row]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="32">
            
            

            

            <code class="ruby">  expect(results.count).to be_positive</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            
            

            

            <code class="ruby">  first_link = results.first</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="36">
            
            

            

            <code class="ruby">  expect(first_link[&quot;data-ecommerce-path&quot;]).to eq(&quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="39">
            <span class="hits">1</span>
            

            

            <code class="ruby">And &quot;I search for lunch&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="40">
            
            

            

            <code class="ruby">  stub_rummager_api_request_with_query_param_no_results(&quot;lunch&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="42">
            
            

            

            <code class="ruby">  fill_in &quot;Search&quot;, with: &quot;lunch&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            <span class="hits">1</span>
            

            

            <code class="ruby">And &quot;I search for superted&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="46">
            
            

            

            <code class="ruby">  stub_rummager_api_request_with_query_param_no_results(&quot;superted&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="48">
            
            

            

            <code class="ruby">  fill_in &quot;Search&quot;, with: &quot;superted&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="51">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^the data-search-query has been updated to (.*)$/) do |query|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="52">
            
            

            

            <code class="ruby">  form = page.find(&quot;.js-live-search-results-block[data-analytics-ecommerce]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="53">
            
            

            

            <code class="ruby">  expect(form[&quot;data-search-query&quot;]).to eq(query)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="56">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^the data-ecommerce-content-id has been updated to (.*)$/) do |query|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="57">
            
            

            

            <code class="ruby">  link = page.find(&quot;a[data-ecommerce-content-id]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="58">
            
            

            

            <code class="ruby">  expect(link[&quot;data-ecommerce-content-id&quot;]).to eq(query)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ca5ceb5e1db3a7e19a10ac6cca2d613249b0a036">
  <div class="header">
    <h3>features/step_definitions/filtering_steps.rb</h3>
    <h4>
      <span class="yellow">
  85.93%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>540</b> relevant lines.
      <span class="green"><b>464</b> lines covered</span> and
      <span class="red"><b>76</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a collection of documents exist$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="2">
            <span class="hits">3</span>
            

            

            <code class="ruby">  content_store_has_mosw_reports_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="3">
            <span class="hits">3</span>
            

            

            <code class="ruby">  stub_rummager_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="4">
            <span class="hits">3</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^no results$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_mosw_reports_finder_with_no_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_no_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view the finder with no keywords and no facets$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;mosw-reports&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/there is a zero results message$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">  expect(page).to have_content(&quot;no matching results&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/there is not a zero results message$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="22">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to_not have_content(&quot;no matching results&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/the page title contains both keywords$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">  expect(page).to have_title &quot;Keyword1 Keyword2 - News and communications - GOV.UK&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/the page title contains only Keyword2$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            
            

            

            <code class="ruby">  expect(page).to have_title &quot;Keyword2 - News and communications - GOV.UK&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/the page title contains no keywords$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            
            

            

            <code class="ruby">  expect(page).to have_title &quot;News and communications - GOV.UK&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/the page title is updated$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_title &quot;keyword searchable - Ministry of Silly Walks reports - GOV.UK&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can get a list of all documents with matching metadata$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;mosw-reports&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_content(&quot;2 reports&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="45">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.finder-results .gem-c-document-list__item&quot;, count: 2)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.gem-c-metadata&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(1)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_link(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">      &quot;West London wobbley walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">      href: &quot;/mosw-reports/west-london-wobbley-walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="53">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;30 December 2003&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Backward&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="57">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit_filtered_finder(&quot;walk_type&quot; =&gt; &quot;hopscotch&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="59">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_content(&quot;1 report&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="60">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.finder-results .gem-c-document-list__item&quot;, count: 1)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(&quot;I see email and feed sign up links&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="64">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;a[href=&quot;/search/news-and-communications/email-signup&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="65">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;a[href=&quot;/search/news-and-communications.atom&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="68">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(&quot;I see only one email and feed sign up link on mobile&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="69">
            <span class="hits">1</span>
            

            

            <code class="ruby">  width = page.driver.browser.manage.window.size.width</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="70">
            <span class="hits">1</span>
            

            

            <code class="ruby">  height = page.driver.browser.manage.window.size.height</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="71">
            <span class="hits">1</span>
            

            

            <code class="ruby">  page.driver.browser.manage.window.resize_to(375, 812)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="72">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;a[href=&quot;/search/news-and-communications/email-signup&quot;]&#39;, count: 1)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="73">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;a[href=&quot;/search/news-and-communications.atom&quot;]&#39;, count: 1)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="74">
            <span class="hits">1</span>
            

            

            <code class="ruby">  page.driver.browser.manage.window.resize_to(width, height)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="77">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(&quot;I see email and feed sign up links with filters applied&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="78">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;a[href=&quot;/search/news-and-communications/email-signup?people%5B%5D=rufus-scrimgeour&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="79">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;a[href=&quot;/search/news-and-communications.atom?people%5B%5D=rufus-scrimgeour&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="82">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(&quot;I see email and feed sign up links with filters and order applied&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="83">
            
            

            

            <code class="ruby">  expect(page).to have_css(&#39;a[href=&quot;/search/news-and-communications/email-signup?people%5B%5D=rufus-scrimgeour&amp;order=updated-newest&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="84">
            
            

            

            <code class="ruby">  expect(page).to have_css(&#39;a[href=&quot;/search/news-and-communications.atom?people%5B%5D=rufus-scrimgeour&amp;order=updated-newest&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="87">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view a list of news and communications$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="88">
            <span class="hits">4</span>
            

            

            <code class="ruby">  topic_taxonomy_has_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="89">
            <span class="hits">4</span>
            

            

            <code class="ruby">  content_store_has_news_and_communications_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="90">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="91">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="92">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="93">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_news_and_communication_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="94">
            <span class="hits">4</span>
            

            

            <code class="ruby">  visit finder_path(&quot;search/news-and-communications&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="97">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view the news and communications finder$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="98">
            <span class="hits">12</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="99">
            <span class="hits">12</span>
            

            

            <code class="ruby">  content_store_has_news_and_communications_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="100">
            <span class="hits">12</span>
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="101">
            <span class="hits">12</span>
            

            

            <code class="ruby">  stub_all_rummager_api_requests_with_news_and_communication_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="102">
            <span class="hits">12</span>
            

            

            <code class="ruby">  stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="103">
            <span class="hits">12</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="104">
            <span class="hits">12</span>
            

            

            <code class="ruby">  visit finder_path(&quot;search/news-and-communications&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="107">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view the news and communications finder filtered on the transition period topic$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="108">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="109">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_news_and_communications_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="110">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="111">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_all_rummager_api_requests_with_news_and_communication_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="112">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="113">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="114">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;search/news-and-communications&quot;, topic: &quot;d6c2de5d-ef90-45d1-82d4-5f2438369eea&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="115">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="117">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I (can|cannot) see the &quot;show only transition period results&quot; checkbox$/) do |can_or_cannot|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="118">
            <span class="hits">2</span>
            

            

            <code class="ruby">  have_clause = have_css(&quot;.govuk-checkboxes__label&quot;, text: &quot;Show only transition period results&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="119">
            <span class="hits">2</span>
            

            

            <code class="ruby">  if can_or_cannot == &quot;can&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="120">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_clause</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="121">
            
            

            

            <code class="ruby">  else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="122">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to_not have_clause</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="123">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="124">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="125">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="126">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^I am in the variant B control group$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="127">
            
            

            

            <code class="ruby">  ab_test_variant = double(:variant, variant_name: &quot;B&quot;, analytics_meta_tag: &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="128">
            
            

            

            <code class="ruby">  allow(ab_test_variant).to receive(:variant?).with(&quot;B&quot;).and_return(true)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="129">
            
            

            

            <code class="ruby">  allow(ab_test_variant).to receive(:configure_response)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="130">
            
            

            

            <code class="ruby">  allow_any_instance_of(FindersController).to receive(:finder_top_result_variant).and_return(ab_test_variant)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="131">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="132">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="133">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view the policy papers and consultations finder$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="134">
            <span class="hits">1</span>
            

            

            <code class="ruby">  topic_taxonomy_has_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="135">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_policy_and_engagement_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="136">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="137">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="138">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_policy_papers_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="139">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_filtered_policy_papers_results</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="140">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="141">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;search/policy-papers-and-consultations&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="142">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="143">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="144">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view the research and statistics finder$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="145">
            <span class="hits">3</span>
            

            

            <code class="ruby">  topic_taxonomy_has_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="146">
            <span class="hits">3</span>
            

            

            <code class="ruby">  content_store_has_statistics_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="147">
            <span class="hits">3</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="148">
            <span class="hits">3</span>
            

            

            <code class="ruby">  stub_manuals_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="149">
            <span class="hits">3</span>
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="150">
            <span class="hits">3</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_research_and_statistics_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="151">
            <span class="hits">3</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_filtered_research_and_statistics_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="152">
            <span class="hits">3</span>
            

            

            <code class="ruby">  visit finder_path(&quot;search/research-and-statistics&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="153">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="154">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="155">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view the research and statistics finder with a topic param set$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="156">
            <span class="hits">1</span>
            

            

            <code class="ruby">  topic_taxonomy_has_taxons([</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="157">
            
            

            

            <code class="ruby">    FactoryBot.build(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="158">
            
            

            

            <code class="ruby">      :level_one_taxon_hash,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="159">
            
            

            

            <code class="ruby">      content_id: &quot;c58fdadd-7743-46d6-9629-90bb3ccc4ef0&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="160">
            
            

            

            <code class="ruby">      title: &quot;Education, training and skills&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="161">
            
            

            

            <code class="ruby">    ),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="162">
            
            

            

            <code class="ruby">  ])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="163">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_statistics_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="164">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="165">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_manuals_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="166">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="167">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_research_and_statistics_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="168">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_filtered_research_and_statistics_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="169">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;search/research-and-statistics&quot;, topic: &quot;c58fdadd-7743-46d6-9629-90bb3ccc4ef0&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="170">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="171">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="172">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view the aaib reports finder with a topic param set$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="173">
            <span class="hits">1</span>
            

            

            <code class="ruby">  topic_taxonomy_has_taxons([</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="174">
            
            

            

            <code class="ruby">    FactoryBot.build(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="175">
            
            

            

            <code class="ruby">      :level_one_taxon_hash,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="176">
            
            

            

            <code class="ruby">      content_id: &quot;c58fdadd-7743-46d6-9629-90bb3ccc4ef0&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="177">
            
            

            

            <code class="ruby">      title: &quot;Education, training and skills&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="178">
            
            

            

            <code class="ruby">    ),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="179">
            
            

            

            <code class="ruby">  ])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="180">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_aaib_reports_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="181">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="182">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_manuals_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="183">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="184">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_aaib_reports_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="185">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;aaib-reports&quot;, topic: &quot;c58fdadd-7743-46d6-9629-90bb3ccc4ef0&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="186">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="187">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="188">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view the all content finder with a manual filter$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="189">
            <span class="hits">1</span>
            

            

            <code class="ruby">  topic_taxonomy_has_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="190">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_all_content_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="191">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="192">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="193">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="194">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_manuals_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="195">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="196">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_request(:get, DocumentHelper::SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="197">
            
            

            

            <code class="ruby">    .with(query: hash_including(q: &quot;Replacing bristles&quot;, order: &quot;-public_timestamp&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="198">
            
            

            

            <code class="ruby">    .to_return(body: all_content_results_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="199">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="200">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_request(:get, DocumentHelper::SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="201">
            
            

            

            <code class="ruby">    .with(query: hash_including(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="202">
            
            

            

            <code class="ruby">      filter_manual: &quot;/guidance/care-and-use-of-a-nimbus-2000&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="203">
            
            

            

            <code class="ruby">      q: &quot;Replacing bristles&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="204">
            
            

            

            <code class="ruby">      order: &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="205">
            
            

            

            <code class="ruby">    )).to_return(body: all_content_manuals_results_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="206">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="207">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;search/all&quot;, manual: &quot;/guidance/care-and-use-of-a-nimbus-2000&quot;, q: &quot;Replacing bristles&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="208">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="209">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="210">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view the all content finder$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="211">
            
            

            

            <code class="ruby">  topic_taxonomy_has_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="212">
            
            

            

            <code class="ruby">  content_store_has_all_content_finder</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="213">
            
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="214">
            
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="215">
            
            

            

            <code class="ruby">  stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="216">
            
            

            

            <code class="ruby">  stub_manuals_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="217">
            
            

            

            <code class="ruby">  stub_rummager_api_request_with_all_content_results</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="218">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="219">
            
            

            

            <code class="ruby">  visit finder_path(&quot;search/all&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="220">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="221">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="222">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I view a list of services$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="223">
            <span class="hits">4</span>
            

            

            <code class="ruby">  topic_taxonomy_has_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="224">
            <span class="hits">4</span>
            

            

            <code class="ruby">  content_store_has_services_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="225">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_services_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="226">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="227">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="228">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="229">
            <span class="hits">4</span>
            

            

            <code class="ruby">  visit finder_path(&quot;search/services&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="230">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="231">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="232">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I search documents by keyword$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="233">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_keyword_search_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="234">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="235">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;mosw-reports&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="236">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="237">
            <span class="hits">1</span>
            

            

            <code class="ruby">  @keyword_search = &quot;keyword searchable&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="238">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="239">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.filter-form&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="240">
            <span class="hits">1</span>
            

            

            <code class="ruby">    fill_in(&quot;Search&quot;, with: @keyword_search)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="241">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="242">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.js-live-search-fallback&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="243">
            <span class="hits">1</span>
            

            

            <code class="ruby">    click_on &quot;Filter results&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="244">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="245">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="246">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="247">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I see all documents which contain the keywords$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="248">
            <span class="hits">2</span>
            

            

            <code class="ruby">  within &quot;.filtered-results&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="249">
            <span class="hits">2</span>
            

            

            <code class="ruby">    expect(page).to have_css(&quot;a&quot;, text: @keyword_search)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="250">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="251">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="252">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="253">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I visit a finder by keyword with q parameter$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="254">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_keyword_search_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="255">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="256">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;mosw-reports&quot;, q: @keyword_search)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="257">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="258">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="259">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a government finder exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="260">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="261">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_government_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="262">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_government_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="263">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="264">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="265">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="266">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see the government header$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="267">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;government/policies/benefits-reform&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="268">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;#proposition-menu&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="269">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="270">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="271">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I should see a blue banner$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="272">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.gem-c-inverse-header&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="273">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_content(&quot;Education, training and skills&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="274">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to_not have_css(&quot;.app-taxonomy-select&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="275">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="276">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="277">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see documents which are marked as being in history mode$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="278">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.published-by&quot;, count: 5)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="279">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_content(&quot;2005 to 2010 Labour government&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="280">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="281">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="282">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see documents which have government metadata$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="283">
            
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(1)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="284">
            
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Updated:&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="285">
            
            

            

            <code class="ruby">    expect(page).to have_css(&#39;dl time[datetime=&quot;2007-02-14&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="286">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="287">
            
            

            

            <code class="ruby">    expect(page).to have_content(&quot;News Story&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="288">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="289">
            
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Ministry of Justice&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="290">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="291">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="292">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="293">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I see the atom feed$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="294">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;id&quot;, text: &quot;tag:www.dev.gov.uk,2005:/restrictions-on-usage-of-spells-within-school-grounds&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="295">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;updated&quot;, text: &quot;2017-12-30T10:00:00Z&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="296">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_selector(:css, &#39;link[href=&quot;http://www.dev.gov.uk/restrictions-on-usage-of-spells-within-school-grounds&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="297">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;title&quot;, text: &quot;Restrictions on usage of spells within school grounds&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="298">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;summary&quot;, text: &quot;Restrictions on usage of spells within school grounds&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="299">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="300">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="301">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a collection of documents with bad metadata exist$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="302">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="303">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_mosw_reports_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="304">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_bad_data</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="305">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="306">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="307">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can get a list of all documents with good metadata$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="308">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;mosw-reports&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="309">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.finder-results .gem-c-document-list__item&quot;, count: 2)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="310">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="311">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(1)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="312">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Backward&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="313">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).not_to have_content(&quot;England&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="314">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="315">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="316">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(2)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="317">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Northern Ireland&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="318">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).not_to have_content(&quot;Hopscotch&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="319">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="320">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="321">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="322">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a finder tagged to the topic taxonomy$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="323">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="324">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_content_store_with_a_taxon_tagged_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="325">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_with_cma_cases</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="326">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="327">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="328">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a collection of documents that can be filtered by dates$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="329">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="330">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_content_store_with_cma_cases_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="331">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_with_cma_cases</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="332">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="333">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="334">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I use a date filter$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="335">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit_cma_cases_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="336">
            <span class="hits">1</span>
            

            

            <code class="ruby">  apply_date_filter</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="337">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="338">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="339">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I use a collection of documents exist that can be filtered by checkbox filter$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="340">
            
            

            

            <code class="ruby">  visit_cma_cases_finder</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="341">
            
            

            

            <code class="ruby">  apply_date_filter</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="342">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="343">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="344">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I only see documents with matching dates$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="345">
            <span class="hits">1</span>
            

            

            <code class="ruby">  assert_cma_cases_are_filtered_by_date</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="346">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="347">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="348">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a finder with a dynamic filter exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="349">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="350">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_mosw_reports_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="351">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="352">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="353">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="354">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see filters based on the results$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="355">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;mosw-reports&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="356">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="357">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within first(&quot;.app-c-option-select&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="358">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_selector(&quot;input#walk_type-backward&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="359">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Hopscotch&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="360">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to_not have_selector(&quot;input#organisations-ministry-of-silly-walks&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="361">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="362">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="363">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="364">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^filters are wrapped in a progressive disclosure element$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="365">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;#facet-wrapper&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="366">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="367">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="368">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^filters are not wrapped in a progressive disclosure element$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="369">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).not_to have_selector(&quot;#facet-wrapper&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="370">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="371">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="372">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a finder with paginated results exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="373">
            <span class="hits">2</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="374">
            <span class="hits">2</span>
            

            

            <code class="ruby">  content_store_has_government_finder_with_10_items</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="375">
            <span class="hits">2</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_10_government_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="376">
            <span class="hits">2</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_query_param_no_results(&quot;xxxxxxxxxxxxxxYYYYYYYYYYYxxxxxxxxxxxxxxx&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="377">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="378">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="379">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see pagination$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="380">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;government/policies/benefits-reform&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="381">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="382">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).not_to have_content(&quot;Previous page&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="383">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_content(&quot;Next page&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="384">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="385">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="386">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can browse to the next page$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="387">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_10_government_results_page_2</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="388">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;government/policies/benefits-reform&quot;, page: 2)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="389">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="390">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_content(&quot;Previous page&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="391">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).not_to have_content(&quot;Next page&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="392">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="393">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="394">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I browse to a huge page number and get an appropriate error$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="395">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_422_response(999_999)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="396">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;government/policies/benefits-reform&quot;, page: 999_999)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="397">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="398">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page.status_code).to eq(422)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="399">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="400">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="401">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(&quot;I click on the atom feed link&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="402">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within(&quot;#subscription-links-footer&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="403">
            <span class="hits">1</span>
            

            

            <code class="ruby">    click_on &quot;Subscribe to feed&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="404">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="405">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="406">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="407">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(&quot;there is machine readable information&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="408">
            <span class="hits">1</span>
            

            

            <code class="ruby">  schema_sections = page.find_all(&quot;script[type=&#39;application/ld+json&#39;]&quot;, visible: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="409">
            <span class="hits">3</span>
            

            

            <code class="ruby">  schemas = schema_sections.map { |section| JSON.parse(section.text(:all)) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="410">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="411">
            <span class="hits">2</span>
            

            

            <code class="ruby">  org_schema = schemas.detect { |schema| schema[&quot;@type&quot;] == &quot;SearchResultsPage&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="412">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(org_schema[&quot;name&quot;]).to_not be_nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="413">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="414">
            <span class="hits">1</span>
            

            

            <code class="ruby">  tag = &quot;link[rel=&#39;canonical&#39;]&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="415">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(tag, visible: false)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="416">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="417">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="418">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see that Google won&#39;t index the page$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="419">
            <span class="hits">2</span>
            

            

            <code class="ruby">  tag = &quot;meta[name=&#39;robots&#39;][content=&#39;noindex&#39;]&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="420">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(tag, visible: false)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="421">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="422">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="423">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see that Google can index the page$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="424">
            <span class="hits">1</span>
            

            

            <code class="ruby">  tag = &quot;meta[name=&#39;robots&#39;][content=&#39;noindex&#39;]&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="425">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).not_to have_css(tag, visible: false)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="426">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="427">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="428">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a finder with description exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="429">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="430">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_content_store_with_cma_cases_finder_with_description</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="431">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_with_cma_cases</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="432">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="433">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="434">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a finder with a no_index property exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="435">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="436">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_content_store_with_cma_cases_finder_with_no_index</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="437">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_with_cma_cases</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="438">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="439">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="440">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a finder with metadata exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="441">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="442">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_content_store_with_cma_cases_finder_with_metadata</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="443">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_with_cma_cases</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="444">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="445">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="446">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a finder with metadata with a topic param set exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="447">
            
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="448">
            
            

            

            <code class="ruby">  stub_content_store_with_cma_cases_finder_with_metadata_with_topic_param</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="449">
            
            

            

            <code class="ruby">  stub_rummager_with_cma_cases</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="450">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="451">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="452">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I can see that the finder metadata is present$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="453">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit &quot;/cma-cases&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="454">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="455">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.gem-c-metadata&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="456">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to_not have_css(&quot;.gem-c-metadata.gem-c-metadata--inverse&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="457">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="458">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="459">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I can see that the finder metadata is present and inverted$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="460">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.gem-c-metadata&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="461">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.gem-c-metadata.gem-c-metadata--inverse&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="462">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="463">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="464">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I can see that the description in the metadata is present$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="465">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit &quot;/cma-cases&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="466">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="467">
            <span class="hits">1</span>
            

            

            <code class="ruby">  desc_text = &quot;Find reports and updates on current and historical CMA investigations&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="468">
            <span class="hits">1</span>
            

            

            <code class="ruby">  desc_tag = &quot;meta[name=&#39;description&#39;][content=&#39;#{desc_text}&#39;]&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="469">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(desc_tag, visible: false)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="470">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="471">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="472">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I can see that the noindex tag is is present in the metadata$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="473">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit &quot;/cma-cases&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="474">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="475">
            <span class="hits">1</span>
            

            

            <code class="ruby">  noindex_tag = &quot;meta[name=&#39;robots&#39;][content=&#39;noindex&#39;]&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="476">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(noindex_tag, visible: false)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="477">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="478">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="479">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^an organisation finder exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="480">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="481">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_government_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="482">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_government_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="483">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="484">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="485">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="486">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="487">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;government/policies/benefits-reform&quot;, parent: &quot;ministry-of-magic&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="488">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="489">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="490">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^an organisation finder exists but a bad breadcrumb path is given$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="491">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="492">
            <span class="hits">1</span>
            

            

            <code class="ruby">  content_store_has_government_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="493">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_api_request_with_government_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="494">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="495">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="496">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="497">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="498">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;government/policies/benefits-reform&quot;, parent: &quot;bernard-cribbins&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="499">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="500">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="501">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see a breadcrumb for home$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="502">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_link(&quot;Home&quot;, href: &quot;/&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="503">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-category=&#39;homeLinkClicked&#39;]&quot;, text: &quot;Home&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="504">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-action=&#39;homeBreadcrumb&#39;]&quot;, text: &quot;Home&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="505">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-label=&#39;&#39;]&quot;, text: &quot;Home&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="506">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-options=&#39;{}&#39;]&quot;, text: &quot;Home&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="507">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="508">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="509">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see a breadcrumb for all organisations$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="510">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_link(&quot;Organisations&quot;, href: &quot;/government/organisations&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="511">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-category=&#39;breadcrumbClicked&#39;]&quot;, text: &quot;Organisations&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="512">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-action=&#39;2&#39;]&quot;, text: &quot;Organisations&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="513">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-label=&#39;/government/organisations&#39;]&quot;, text: &quot;Organisations&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="514">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-options=&#39;{\&quot;dimension28\&quot;:\&quot;3\&quot;,\&quot;dimension29\&quot;:\&quot;Organisations\&quot;}&#39;]&quot;, text: &quot;Organisations&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="515">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="516">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="517">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^no breadcrumb for all organisations$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="518">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to_not have_link(&quot;Organisations&quot;, href: &quot;/government/organisations&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="519">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="520">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="521">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see a breadcrumb for the organisation$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="522">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_link(&quot;Ministry of Magic&quot;, href: &quot;/government/organisations/ministry-of-magic&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="523">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-category=&#39;breadcrumbClicked&#39;]&quot;, text: &quot;Ministry of Magic&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="524">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-action=&#39;3&#39;]&quot;, text: &quot;Ministry of Magic&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="525">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-label=&#39;/government/organisations/ministry-of-magic&#39;]&quot;, text: &quot;Ministry of Magic&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="526">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-options=&#39;{\&quot;dimension28\&quot;:\&quot;3\&quot;,\&quot;dimension29\&quot;:\&quot;Ministry of Magic\&quot;}&#39;]&quot;, text: &quot;Ministry of Magic&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="527">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="528">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="529">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see taxonomy breadcrumbs$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="530">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;cma-cases&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="531">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;.govuk-breadcrumbs.gem-c-breadcrumbs--collapse-on-mobile&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="532">
            
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;.govuk-breadcrumbs__list-item&quot;, text: &quot;Competition Act and cartels&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="533">
            
            

            

            <code class="ruby">  expect(page.find_all(&quot;.govuk-breadcrumbs__list-item&quot;).count).to eql(2)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="534">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="535">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="536">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see Brexit taxonomy breadcrumbs$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="537">
            
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;.govuk-breadcrumbs.gem-c-breadcrumbs--collapse-on-mobile&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="538">
            
            

            

            <code class="ruby">  expect(page.find_all(&quot;.govuk-breadcrumbs__list-item&quot;).count).to eql(3)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="539">
            
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;.govuk-breadcrumbs__list-item&quot;, text: &quot;Home&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="540">
            
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;.govuk-breadcrumbs__list-item&quot;, text: &quot;Government&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="541">
            
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;.govuk-breadcrumbs__list-item&quot;, text: &quot;Brexit&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="542">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="543">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="544">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^a collection of documents exist that can be filtered by checkbox$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="545">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="546">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_content_store_with_cma_cases_finder_for_supergroup_checkbox_filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="547">
            <span class="hits">4</span>
            

            

            <code class="ruby">  stub_rummager_with_cma_cases_for_supergroups_checkbox</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="548">
            <span class="hits">4</span>
            

            

            <code class="ruby">  visit_cma_cases_finder</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="549">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="550">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="551">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I use a checkbox filter$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="552">
            <span class="hits">2</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Show open cases&quot;).click</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="553">
            <span class="hits">2</span>
            

            

            <code class="ruby">  within &quot;.js-live-search-fallback&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="554">
            <span class="hits">2</span>
            

            

            <code class="ruby">    click_on &quot;Filter results&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="555">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="556">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="557">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="558">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I only see documents that match the checkbox filter$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="559">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_content(&quot;1 case&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="560">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.facet-tags__preposition&quot;, text: &quot;That Is&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="561">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.facet-tag__text&quot;, text: &quot;Open&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="562">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="563">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(1)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="564">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Big Beer Co / Salty Snacks Ltd merger inquiry&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="565">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to_not have_content(&quot;Bakery market investigation&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="566">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="567">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="568">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="569">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^The checkbox has the correct tracking data$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="570">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;input[type=&#39;checkbox&#39;][data-track-category=&#39;filterClicked&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="571">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;input[type=&#39;checkbox&#39;][data-track-action=&#39;checkboxFacet&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="572">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;input[type=&#39;checkbox&#39;][data-track-label=&#39;Show open cases&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="573">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to_not have_css(&quot;input[type=&#39;checkbox&#39;][data-module=&#39;track-click&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="574">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="575">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="576">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can sort by:$/) do |table|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="577">
            <span class="hits">6</span>
            

            

            <code class="ruby">  expect(find_all(&quot;.js-order-results option&quot;).collect(&amp;:text)).to eq(table.raw.flatten)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="578">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="579">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="580">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I sort by most viewed$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="581">
            <span class="hits">3</span>
            

            

            <code class="ruby">  select &quot;Most viewed&quot;, from: &quot;order&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="582">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="583">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="584">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I sort by A-Z$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="585">
            <span class="hits">2</span>
            

            

            <code class="ruby">  select &quot;A-Z&quot;, from: &quot;order&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="586">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="587">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="588">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I sort by most relevant$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="589">
            <span class="hits">1</span>
            

            

            <code class="ruby">  select &quot;Relevance&quot;, from: &quot;Sort by&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="590">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="591">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="592">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I filter the results$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="593">
            <span class="hits">4</span>
            

            

            <code class="ruby">  within &quot;.js-live-search-fallback&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="594">
            <span class="hits">4</span>
            

            

            <code class="ruby">    click_on &quot;Filter results&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="595">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="596">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="597">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="598">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I see the most viewed articles first$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="599">
            <span class="hits">2</span>
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(1)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="600">
            <span class="hits">2</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Press release from Hogwarts&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="601">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;25 December 2017&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="602">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="603">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="604">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(2)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="605">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;16 November 2018&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="606">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="607">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="608">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-category=&#39;navFinderLinkClicked&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="609">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;#order&quot;, text: &quot;Most viewed&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="610">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="611">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="612">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I see services in alphabetical order$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="613">
            <span class="hits">2</span>
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(1)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="614">
            <span class="hits">2</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Apply for your full broomstick licence&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="615">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="616">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="617">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(2)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="618">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Register a magical spell&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="619">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="620">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="621">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-category=&#39;navFinderLinkClicked&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="622">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;#order&quot;, text: &quot;A-Z&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="623">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="624">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="625">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I see most relevant order selected$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="626">
            
            

            

            <code class="ruby">  expect(page).to have_select(&quot;order&quot;, selected: &quot;Relevance&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="627">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="628">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="629">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I see (.*) order selected$/) do |label|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="630">
            <span class="hits">5</span>
            

            

            <code class="ruby">  expect(page).to have_select(&quot;order&quot;, selected: label)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="631">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="632">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="633">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I see the facet tag$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="634">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within first &quot;.facet-tags&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="635">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_button(&quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="636">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Open&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="637">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_css(&quot;[data-module=&#39;remove-filter-link&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="638">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_css(&quot;[aria-label=&#39;Remove filter Open&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="639">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="640">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="641">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="642">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I select a taxon$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="643">
            
            

            

            <code class="ruby">  select(&quot;Taxon_1&quot;, from: &quot;Topic&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="644">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="645">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="646">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I select a Person$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="647">
            <span class="hits">2</span>
            

            

            <code class="ruby">  check(&quot;Rufus Scrimgeour&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="648">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="649">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="650">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I select some document types$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="651">
            <span class="hits">1</span>
            

            

            <code class="ruby">  click_on(&quot;Document type&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="652">
            
            

            

            <code class="ruby">  find(&quot;.govuk-checkboxes__item .govuk-label&quot;, text: &quot;Policy papers&quot;).click</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="653">
            
            

            

            <code class="ruby">  find(&quot;.govuk-checkboxes__item .govuk-label&quot;, text: &quot;Consultations (closed)&quot;).click</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="654">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="655">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="656">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I select upcoming statistics$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="657">
            <span class="hits">2</span>
            

            

            <code class="ruby">  find(&quot;.govuk-label&quot;, text: &quot;Statistics (upcoming)&quot;).click</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="658">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="659">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="660">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I select published statistics$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="661">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;.govuk-label&quot;, text: &quot;Statistics (published)&quot;).click</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="662">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="663">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="664">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I click filter results$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="665">
            <span class="hits">2</span>
            

            

            <code class="ruby">  within &quot;.js-live-search-fallback&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="666">
            <span class="hits">2</span>
            

            

            <code class="ruby">    click_on &quot;Filter results&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="667">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="668">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="669">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="670">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I reload the page$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="671">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit [current_path, page.driver.request.env[&quot;QUERY_STRING&quot;]].reject(&amp;:blank?).join(&quot;?&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="672">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="673">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="674">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I should see all people in the people facet$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="675">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;input[id^=&quot;people-&quot;]&#39;, count: 5)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="676">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Albus Dumbledore&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="677">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Cornelius Fudge&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="678">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Harry Potter&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="679">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Ron Weasley&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="680">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Rufus Scrimgeour&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="681">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="682">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="683">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I should see all organisations in the organisation facet$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="684">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;input[id^=&quot;organisations-&quot;]&#39;, count: 4)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="685">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Department of Mysteries&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="686">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Gringots&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="687">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Ministry of Magic&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="688">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Closed organisation: Death Eaters&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="689">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="690">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="691">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I should see all world locations in the world location facet$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="692">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;input[id^=&quot;world_locations-&quot;]&#39;, count: 2)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="693">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Azkaban&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="694">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Tracy Island&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="695">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="696">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="697">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I select a World Location$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="698">
            
            

            

            <code class="ruby">  click_on(&quot;World location&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="699">
            
            

            

            <code class="ruby">  check(&quot;Azkaban&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="700">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="701">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="702">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I click button \&quot;([^\&quot;]*)\&quot; and select facet (.*)$/) do |button, facet|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="703">
            <span class="hits">4</span>
            

            

            <code class="ruby">  click_on(button)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="704">
            
            

            

            <code class="ruby">  find(&quot;label&quot;, text: facet).click</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="705">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="706">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="707">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I select facet (.*) in the already expanded \&quot;([^\&quot;]*)\&quot; section$/) do |facet, _button|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="708">
            
            

            

            <code class="ruby">  find(&quot;label&quot;, text: facet).click</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="709">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="710">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="711">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I click the (.*) remove control$/) do |filter|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="712">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.js-enabled&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="713">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="714">
            <span class="hits">1</span>
            

            

            <code class="ruby">  button = page.find(&quot;p[class=&#39;facet-tag__text&#39;]&quot;, text: filter).sibling(&quot;button[data-module=&#39;remove-filter-link&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="715">
            
            

            

            <code class="ruby">  button.click</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="716">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="717">
            
            

            

            <code class="ruby">  expect(page).to_not have_selector(&quot;p[class=&#39;facet-tag__text&#39;]&quot;, text: filter)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="718">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="719">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="720">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^The (.*) checkbox in deselected$/) do |checkbox|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="721">
            
            

            

            <code class="ruby">  expect(page.find(&quot;##{checkbox}&quot;, visible: :all)).to_not be_checked</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="722">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="723">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="724">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I fill in some keywords$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="725">
            <span class="hits">3</span>
            

            

            <code class="ruby">  fill_in &quot;Search&quot;, with: &quot;Keyword1 Keyword2\n&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="726">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="727">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="728">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I fill in a keyword that should match no results$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="729">
            <span class="hits">1</span>
            

            

            <code class="ruby">  fill_in &quot;Search&quot;, with: &quot;xxxxxxxxxxxxxxYYYYYYYYYYYxxxxxxxxxxxxxxx\n&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="730">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="731">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="732">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I submit the form$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="733">
            
            

            

            <code class="ruby">  page.execute_script(&quot;$(&#39;form.js-live-search-form&#39;).submit()&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="734">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="735">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="736">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^The keyword textbox is empty$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="737">
            
            

            

            <code class="ruby">  expect(page).to have_field(&quot;Search&quot;, with: &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="738">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="739">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="740">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^The keyword textbox only contains (.*)$/) do |filter|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="741">
            
            

            

            <code class="ruby">  expect(page).to have_field(&quot;Search&quot;, with: filter)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="742">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="743">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="744">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I use a checkbox filter and another disallowed filter$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="745">
            <span class="hits">1</span>
            

            

            <code class="ruby">  find(&quot;label&quot;, text: &quot;Show open cases&quot;).click</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="746">
            <span class="hits">1</span>
            

            

            <code class="ruby">  fill_in(&quot;closed_date[from]&quot;, with: &quot;1st November 2015&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="747">
            <span class="hits">1</span>
            

            

            <code class="ruby">  stub_rummager_with_cma_cases_for_supergroups_checkbox_and_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="748">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.js-live-search-fallback&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="749">
            <span class="hits">1</span>
            

            

            <code class="ruby">    click_on &quot;Filter results&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="750">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="751">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="752">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="753">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can sign up to email alerts for allowed filters$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="754">
            <span class="hits">2</span>
            

            

            <code class="ruby">  stub_email_alert_api_has_subscriber_list(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="755">
            
            

            

            <code class="ruby">    &quot;tags&quot; =&gt; { &quot;case_type&quot; =&gt; { any: %w[ca98-and-civil-cartels] }, &quot;format&quot; =&gt; { any: %w[cma_case] } },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="756">
            
            

            

            <code class="ruby">    &quot;subscription_url&quot; =&gt; &quot;http://www.rathergood.com&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="757">
            
            

            

            <code class="ruby">  )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="758">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="759">
            <span class="hits">2</span>
            

            

            <code class="ruby">  stub_content_store_has_item(&quot;/cma-cases/email-signup&quot;, cma_cases_with_multi_facets_signup_content_item)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="760">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="761">
            <span class="hits">2</span>
            

            

            <code class="ruby">  within &quot;#subscription-links-footer&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="762">
            <span class="hits">2</span>
            

            

            <code class="ruby">    click_link(&quot;Get email alerts&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="763">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="764">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="765">
            
            

            

            <code class="ruby">  begin</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="766">
            <span class="hits">2</span>
            

            

            <code class="ruby">    click_on(&quot;Create subscription&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="767">
            
            

            

            <code class="ruby">  rescue ActionController::RoutingError</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="768">
            
            

            

            <code class="ruby">    expect(page.status_code).to eq(302)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="769">
            
            

            

            <code class="ruby">    expect(page.response_headers[&quot;Location&quot;]).to eql(&quot;http://www.rathergood.com&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="770">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="771">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="772">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="773">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(&quot;I create an email subscription&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="774">
            
            

            

            <code class="ruby">  within &quot;#subscription-links-footer&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="775">
            
            

            

            <code class="ruby">    click_link(&quot;Get email alerts&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="776">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="777">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="778">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="779">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(&quot;I should see results in the default group&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="780">
            
            

            

            <code class="ruby">  within(&quot;#js-results .filtered-results__group&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="781">
            
            

            

            <code class="ruby">    expect(page.all(&quot;.gem-c-document-list__item&quot;).size).to eq(9) # 9 results in fixture</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="782">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="783">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="784">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="785">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(&quot;I should see results for scoped by the selected document type&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="786">
            
            

            

            <code class="ruby">  expect(page).to have_text(&quot;3 results&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="787">
            
            

            

            <code class="ruby">  within(&quot;#js-results&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="788">
            
            

            

            <code class="ruby">    expect(page.all(&quot;.gem-c-document-list__item&quot;).size).to eq(3) # 3 results in fixture</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="789">
            
            

            

            <code class="ruby">    expect(page).to have_link(&quot;Restrictions on usage of spells within school grounds&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="790">
            
            

            

            <code class="ruby">    expect(page).to have_link(&quot;New platform at Hogwarts for the express train&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="791">
            
            

            

            <code class="ruby">    expect(page).to have_link(&quot;Installation of double glazing at Hogwarts&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="792">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="793">
            
            

            

            <code class="ruby">    expect(page).to have_no_link(&quot;Proposed changes to magic tournaments&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="794">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="795">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="796">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="797">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(&quot;I see results grouped by primary facet value&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="798">
            
            

            

            <code class="ruby">  within(&quot;#js-results&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="799">
            
            

            

            <code class="ruby">    expect(page.all(&quot;.filtered-results__group&quot;).size).to eq(2)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="800">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="801">
            
            

            

            <code class="ruby">    within(&quot;.filtered-results__group:nth-child(1)&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="802">
            
            

            

            <code class="ruby">      expect(page).to have_css(&quot;h2.filtered-results__facet-heading&quot;, text: &quot;Aerospace&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="803">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="804">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="805">
            
            

            

            <code class="ruby">    within(&quot;.filtered-results__group:nth-child(2)&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="806">
            
            

            

            <code class="ruby">      expect(page).to have_css(&quot;h2.filtered-results__facet-heading&quot;, text: &quot;All businesses&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="807">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="808">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="809">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="810">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="811">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(&quot;I see results with top result&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="812">
            
            

            

            <code class="ruby">  within(&quot;#js-results&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="813">
            
            

            

            <code class="ruby">    expect(page.all(&quot;.gem-c-document-list__item--highlight&quot;).length).to eq(1)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="814">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="815">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="816">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="817">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(&quot;I should see upcoming statistics&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="818">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_text(&quot;1 result&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="819">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within(&quot;#js-results&quot;) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="820">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page.all(&quot;.gem-c-document-list__item&quot;).size).to eq(1)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="821">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_link(&quot;Restrictions on usage of spells within school grounds&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="822">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_no_link(&quot;New platform at Hogwarts for the express train&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="823">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_no_link(&quot;Installation of double glazing at Hogwarts&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="824">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_no_link(&quot;Proposed changes to magic tournaments&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="825">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="826">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="827">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="828">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I press (tab) key to navigate$/) do |key|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="829">
            <span class="hits">2</span>
            

            

            <code class="ruby">  find_field(&quot;Search&quot;).send_keys key.to_sym</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="830">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="831">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="832">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I click &quot;(.*)&quot; to expand|collapse all facets/) do |link_text|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="833">
            
            

            

            <code class="ruby">  click_button(link_text)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="834">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="835">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="836">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I visit the benefits-reform page$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="837">
            <span class="hits">1</span>
            

            

            <code class="ruby">  visit finder_path(&quot;government/policies/benefits-reform&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="838">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="839">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="840">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I should see results and pagination$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="841">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_text(&quot;20 reports&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="842">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.finder-results&quot;, visible: true)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="843">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.gem-c-pagination&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="844">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="845">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="846">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^the results and pagination should be removed$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="847">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).not_to have_text(&quot;20 reports&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="848">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.finder-results&quot;, visible: false)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="849">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to_not have_css(&quot;.gem-c-pagination&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="850">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="851">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="852">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I should (see|not see) a &quot;Skip to results&quot; link$/) do |can_be_seen|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="853">
            <span class="hits">2</span>
            

            

            <code class="ruby">  visibility = can_be_seen == &quot;see&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="854">
            <span class="hits">2</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;[href=&quot;#js-results&quot;]&#39;, visible: visibility)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="855">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="856">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="857">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^the page has results region$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="858">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;[id=&quot;js-results&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="859">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="860">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="861">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^the page has a landmark to the search results$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="862">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;[class=&quot;govuk-grid-column-two-thirds js-live-search-results-block filtered-results&quot;][role=&quot;region&quot;][aria-label$=&quot;search results&quot;]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="863">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="864">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="865">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^the page has a landmark to the search filters$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="866">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&#39;.govuk-grid-column-one-third[role=&quot;search&quot;][aria-label]&#39;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="867">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="868">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="869">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^I should not see an upcoming statistics facet tag$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="870">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to_not have_css(&quot;p.facet-tag__text&quot;, text: &quot;Upcoming statistics&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="871">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="872">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="873">
            <span class="hits">1</span>
            

            

            <code class="ruby">And(/^The top result has the correct tracking data$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="874">
            
            

            

            <code class="ruby">  expect(page).to have_css(&quot;a[data-track-category=&#39;navFinderLinkClicked&#39;]&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="875">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="876">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="877">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I can see results filtered by that manual$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="878">
            <span class="hits">1</span>
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.finder-results .gem-c-document-list__item&quot;, count: 1)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="879">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="880">
            <span class="hits">1</span>
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(1)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="881">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to_not have_content(&quot;Restrictions on usage of spells within school grounds&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="882">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Replacing bristles in your Nimbus 2000&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="883">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="884">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="885">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="886">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I see all content results$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="887">
            
            

            

            <code class="ruby">  expect(page).to have_css(&quot;.finder-results .gem-c-document-list__item&quot;, count: 1)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="888">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="889">
            
            

            

            <code class="ruby">  within &quot;.finder-results .gem-c-document-list__item:nth-child(1)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="890">
            
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Restrictions on usage of spells within school grounds&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="891">
            
            

            

            <code class="ruby">    expect(page).to_not have_content(&quot;Replacing bristles in your Nimbus 2000&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="892">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="893">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="369a0762d16ac5924b0784cd96e6f34ed6aabfcb">
  <div class="header">
    <h3>features/step_definitions/search_steps.rb</h3>
    <h4>
      <span class="red">
  35.48%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>31</b> relevant lines.
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>20</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^the search page exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="2">
            
            

            

            <code class="ruby">  stub_content_store_has_item(&quot;/search&quot;, schema: &quot;special_route&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I search for an empty string$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="6">
            
            

            

            <code class="ruby">  visit &quot;/search?q=&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I search for &quot;([^&quot;]*)&quot; from &quot;([^&quot;]*)&quot;$/) do |search_term, organisation|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="10">
            
            

            

            <code class="ruby">  visit &quot;/search?q=#{search_term}&amp;filter_organisations[]=#{organisation}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I search for &quot;([^&quot;]*)&quot; in manual &quot;([^&quot;]*)&quot;$/) do |search_term, manual|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="14">
            
            

            

            <code class="ruby">  visit &quot;/search?q=#{search_term}&amp;filter_manual[]=#{manual}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I search for &quot;([^&quot;]*)&quot; from &quot;(.*)&quot; on the json endpoint$/) do |search_term, organisation|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">  visit &quot;/search.json?q=#{search_term}&amp;filter_organisations[]=#{organisation}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I am able to set search terms$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">  expect(page).to have_field(&quot;Search GOV.UK&quot;, with: &quot;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">Given(/^the all content finder exists$/) do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">  topic_taxonomy_has_taxons</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="27">
            
            

            

            <code class="ruby">  content_store_has_all_content_finder</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="28">
            
            

            

            <code class="ruby">  stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="29">
            
            

            

            <code class="ruby">  stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            
            

            

            <code class="ruby">  stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="31">
            
            

            

            <code class="ruby">  stub_manuals_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="33">
            
            

            

            <code class="ruby">  stub_rummager_api_request_with_organisation_filter_all_content_results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="34">
            
            

            

            <code class="ruby">  stub_rummager_api_request_with_manual_filter_all_content_results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="35">
            
            

            

            <code class="ruby">  stub_rummager_api_request_with_misspelt_query</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I am redirected to the (html|json) all content finder results page$/) do |format|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            
            

            

            <code class="ruby">  expect(page).to have_current_path(finder_path(&quot;search/all&quot;), ignore_query: true)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="40">
            
            

            

            <code class="ruby">  expect(page.response_headers[&quot;Content-Type&quot;]).to include(format)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^results are filtered with a facet tag of (.*)/) do |text|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="44">
            
            

            

            <code class="ruby">  expect(page).to have_selector(&quot;p[class=&#39;facet-tag__text&#39;]&quot;, text: text)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="47">
            <span class="hits">1</span>
            

            

            <code class="ruby">When(/^I search for &quot;([^&quot;]*)&quot;$/) do |search_term|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="48">
            
            

            

            <code class="ruby">  visit &quot;/search?q=#{search_term}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="51">
            <span class="hits">1</span>
            

            

            <code class="ruby">Then(/^I see a &quot;(.*)&quot; spelling suggestion$/) do |suggestion|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="52">
            
            

            

            <code class="ruby">  expect(page).to have_link suggestion.to_s, href: &quot;/search/all?keywords=#{suggestion}&amp;order=relevance&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="366c49f44f976af436c63543745a0fbdb0d1f0df">
  <div class="header">
    <h3>features/support/document_helper.rb</h3>
    <h4>
      <span class="green">
  93.8%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>242</b> relevant lines.
      <span class="green"><b>227</b> lines covered</span> and
      <span class="red"><b>15</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">require_relative &quot;../../spec/support/content_helper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">require_relative &quot;../../spec/support/taxonomy_helper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">require_relative &quot;../../spec/support/registry_helper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">require_relative &quot;../../spec/support/fixtures_helper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;gds_api/test_helpers/email_alert_api&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;gds_api/test_helpers/content_store&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;gds_api/test_helpers/worldwide&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">module DocumentHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include FixturesHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include GovukContentSchemaExamples</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include TaxonomySpecHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include RegistrySpecHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include GdsApi::TestHelpers::EmailAlertApi</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include GdsApi::TestHelpers::ContentStore</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include GdsApi::TestHelpers::Worldwide</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  SEARCH_ENDPOINT = &quot;#{Plek.current.find(&#39;search&#39;)}/search.json&quot;.freeze</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_taxonomy_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="21">
            <span class="hits">35</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/&quot;, &quot;links&quot; =&gt; { &quot;level_one_taxons&quot; =&gt; [] })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="25">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">      .with(query: hash_including(rummager_all_documents_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">      .to_return(body: all_documents_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="29">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">      .with(query: rummager_hopscotch_walks_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">      .to_return(body: hopscotch_reports_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_keyword_search_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="35">
            <span class="hits">2</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">      .with(query: rummager_keyword_search_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">      .to_return(body: keyword_search_results)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="40">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_government_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="41">
            <span class="hits">3</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">      .with(query: hash_including({}))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">      .to_return(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">        body: government_documents_json,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="48">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_query_param_no_results(query)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="49">
            <span class="hits">2</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">      .with(query: hash_including(&quot;q&quot; =&gt; query))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">      .to_return(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">        body: no_results_json,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="56">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_10_government_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="57">
            <span class="hits">2</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">      .with(query: rummager_10_documents_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">      .to_return(body: government_documents_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="62">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_bad_data</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="63">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">      .with(query: rummager_all_documents_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">      .to_return(body: documents_with_bad_data_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="68">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_10_government_results_page_2</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="69">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">      .with(query: rummager_10_documents_page_2_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">      .to_return(body: government_documents_page_2_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="74">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_news_and_communication_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="75">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">      .with(query: hash_including(rummager_newest_news_and_communications_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">      .to_return(body: newest_news_and_communication_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="79">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">      .with(query: hash_including(rummager_popular_news_and_communications_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">      .to_return(body: popular_news_and_communication_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="84">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_policy_papers_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="85">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">      .with(query: hash_including(policy_papers_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">      .to_return(body: policy_and_engagement_results_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="90">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_all_content_results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="91">
            
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">      .with(query: hash_including(all_content_params.merge(order: &quot;-public_timestamp&quot;)))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">      .to_return(body: all_content_results_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="96">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_organisation_filter_all_content_results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="97">
            
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">      .with(query: hash_including(&quot;q&quot; =&gt; &quot;search-term&quot;, &quot;filter_organisations&quot; =&gt; %w[ministry-of-magic]))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">      .to_return(body: filtered_by_organisation_all_content_results_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="102">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_misspelt_query</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="103">
            
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">      .with(query: hash_including(&quot;q&quot; =&gt; &quot;drving&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby">      .to_return(body: spelling_suggestions_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="107">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="108">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_manual_filter_all_content_results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="109">
            
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            
            

            

            <code class="ruby">      .with(query: hash_including(&quot;q&quot; =&gt; &quot;search-term&quot;, &quot;filter_manual&quot; =&gt; %w[how-to-be-a-wizard]))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            
            

            

            <code class="ruby">      .to_return(body: filtered_by_manual_all_content_results_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="113">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="114">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_filtered_policy_papers_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="115">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            
            

            

            <code class="ruby">      .with(query: hash_including(policy_papers_params.merge(&quot;filter_content_store_document_type&quot; =&gt; %w[case_study impact_assessment policy_paper])))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="117">
            
            

            

            <code class="ruby">      .to_return(body: policy_and_engagement_results_for_policy_papers_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="118">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="119">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="120">
            
            

            

            <code class="ruby">      .with(query: hash_including(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="121">
            
            

            

            <code class="ruby">        policy_papers_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="122">
            
            

            

            <code class="ruby">          &quot;filter_content_store_document_type&quot; =&gt; %w[case_study closed_consultation consultation_outcome impact_assessment policy_paper],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="123">
            
            

            

            <code class="ruby">        ),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="124">
            
            

            

            <code class="ruby">      ))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="125">
            
            

            

            <code class="ruby">      .to_return(body: policy_and_engagement_results_for_policy_papers_and_closed_consultations_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="126">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="127">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="128">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_research_and_statistics_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="129">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="130">
            
            

            

            <code class="ruby">      .with(query: hash_including(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="131">
            
            

            

            <code class="ruby">        &quot;filter_content_store_document_type&quot; =&gt; %w[national_statistics official_statistics statistical_data_set statistics],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="132">
            
            

            

            <code class="ruby">      ))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="133">
            
            

            

            <code class="ruby">      .to_return(body: statistics_results_for_statistics_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="134">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="135">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="136">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_filtered_research_and_statistics_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="137">
            <span class="hits">4</span>
            

            

            <code class="ruby">    Timecop.freeze(Time.zone.local(&quot;2019-01-01&quot;).utc)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="138">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, &quot;#{Plek.current.find(&#39;search&#39;)}/search.json&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="139">
            
            

            

            <code class="ruby">      .with(query: hash_including(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="140">
            
            

            

            <code class="ruby">        &quot;filter_format&quot; =&gt; %w[statistics_announcement],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="141">
            
            

            

            <code class="ruby">        &quot;filter_release_timestamp&quot; =&gt; &quot;from:2019-01-01&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="142">
            
            

            

            <code class="ruby">      ))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="143">
            
            

            

            <code class="ruby">      .to_return(body: upcoming_statistics_results_for_statistics_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="144">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="145">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="146">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_aaib_reports_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="147">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="148">
            
            

            

            <code class="ruby">      .with(query: hash_including({}))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="149">
            
            

            

            <code class="ruby">      .to_return(body: %({ &quot;results&quot;: [], &quot;total&quot;: 0, &quot;start&quot;: 0}))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="150">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="151">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="152">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_all_rummager_api_requests_with_news_and_communication_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="13" data-linenumber="153">
            <span class="hits">13</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="154">
            
            

            

            <code class="ruby">      .with(query: hash_including({}))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="155">
            
            

            

            <code class="ruby">      .to_return(body: newest_news_and_communication_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="156">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="157">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="158">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_services_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="159">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="160">
            
            

            

            <code class="ruby">      .with(query: hash_including(rummager_alphabetical_services_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="161">
            
            

            

            <code class="ruby">      .to_return(body: alpabetical_services_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="162">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="163">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="164">
            
            

            

            <code class="ruby">      .with(query: hash_including(rummager_popular_services_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="165">
            
            

            

            <code class="ruby">      .to_return(body: popular_services_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="166">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="167">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="168">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_no_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="169">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="170">
            
            

            

            <code class="ruby">      .with(query: rummager_0_documents_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="171">
            
            

            

            <code class="ruby">      .to_return(body: %({ &quot;results&quot;: [], &quot;total&quot;: 0, &quot;start&quot;: 0}))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="172">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="173">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="174">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_422_response(page_number)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="175">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="176">
            
            

            

            <code class="ruby">      .with(query: rummager_document_other_page_search_params(page_number))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="177">
            
            

            

            <code class="ruby">      .to_return(status: 422)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="178">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="179">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="180">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_api_request_with_qa_finder_results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="181">
            
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="182">
            
            

            

            <code class="ruby">      .with(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="183">
            
            

            

            <code class="ruby">        query: hash_including({}),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="184">
            
            

            

            <code class="ruby">      ).to_return(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="185">
            
            

            

            <code class="ruby">        body: aaib_reports_search_results,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="186">
            
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="187">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="188">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="189">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_world_locations_api_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="24" data-linenumber="190">
            <span class="hits">24</span>
            

            

            <code class="ruby">    stub_worldwide_api_has_locations(%w[azkaban tracy-island])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="191">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="192">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="193">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_mosw_reports_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="194">
            <span class="hits">5</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/mosw-reports&quot;, govuk_content_schema_example(&quot;finder&quot;).to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="195">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="196">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="197">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_mosw_reports_finder_with_no_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="198">
            <span class="hits">1</span>
            

            

            <code class="ruby">    finder = govuk_content_schema_example(&quot;finder&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="199">
            <span class="hits">1</span>
            

            

            <code class="ruby">    finder[&quot;details&quot;][&quot;facets&quot;] = []</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="200">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/mosw-reports&quot;, finder.to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="201">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="202">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="203">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_qa_finder</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="204">
            
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/aaib-reports&quot;, aaib_reports_content_item.to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="205">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="206">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="207">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_news_and_communications_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="17" data-linenumber="208">
            <span class="hits">17</span>
            

            

            <code class="ruby">    finder_fixture = File.read(Rails.root.join(&quot;features/fixtures/news_and_communications_with_checkboxes.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="209">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="17" data-linenumber="210">
            <span class="hits">17</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/search/news-and-communications&quot;, finder_fixture)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="211">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="212">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="213">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_government_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="214">
            <span class="hits">3</span>
            

            

            <code class="ruby">    base_path = &quot;/government/policies/benefits-reform&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="215">
            <span class="hits">3</span>
            

            

            <code class="ruby">    finder = govuk_content_schema_example(&quot;finder&quot;).merge(&quot;base_path&quot; =&gt; base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="216">
            <span class="hits">3</span>
            

            

            <code class="ruby">    finder[&quot;details&quot;][&quot;sort&quot;] = [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="217">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="218">
            
            

            

            <code class="ruby">        &quot;name&quot;: &quot;Most viewed&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="219">
            
            

            

            <code class="ruby">        &quot;key&quot;: &quot;-popularity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="220">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="221">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="222">
            
            

            

            <code class="ruby">        &quot;name&quot;: &quot;Relevance&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="223">
            
            

            

            <code class="ruby">        &quot;key&quot;: &quot;-relevance&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="224">
            
            

            

            <code class="ruby">        &quot;default&quot;: true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="225">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="226">
            
            

            

            <code class="ruby">    ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="227">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="228">
            <span class="hits">3</span>
            

            

            <code class="ruby">    stub_content_store_has_item(base_path, finder.to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="229">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="230">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="231">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_services_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="232">
            <span class="hits">4</span>
            

            

            <code class="ruby">    finder_fixture = File.read(Rails.root.join(&quot;features/fixtures/services.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="233">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="234">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/search/services&quot;, finder_fixture)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="235">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="236">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="237">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_government_finder_with_10_items</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="238">
            <span class="hits">2</span>
            

            

            <code class="ruby">    base_path = &quot;/government/policies/benefits-reform&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="239">
            <span class="hits">2</span>
            

            

            <code class="ruby">    content_item = govuk_content_schema_example(&quot;finder&quot;).merge(&quot;base_path&quot; =&gt; base_path)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="240">
            <span class="hits">2</span>
            

            

            <code class="ruby">    content_item[&quot;details&quot;][&quot;default_documents_per_page&quot;] = 10</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="241">
            <span class="hits">2</span>
            

            

            <code class="ruby">    stub_content_store_has_item(base_path, content_item.to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="242">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="243">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="244">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_statistics_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="245">
            <span class="hits">4</span>
            

            

            <code class="ruby">    finder_fixture = File.read(Rails.root.join(&quot;features/fixtures/statistics.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="246">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="247">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/search/research-and-statistics&quot;, finder_fixture)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="248">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="249">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="250">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_aaib_reports_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="251">
            <span class="hits">1</span>
            

            

            <code class="ruby">    finder_fixture = File.read(Rails.root.join(&quot;features/fixtures/aaib_reports_example.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="252">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="253">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/aaib-reports&quot;, finder_fixture)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="254">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="255">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="256">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_all_content_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="257">
            <span class="hits">1</span>
            

            

            <code class="ruby">    finder_fixture = File.read(Rails.root.join(&quot;features/fixtures/all_content.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="258">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="259">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/search/all&quot;, finder_fixture)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="260">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="261">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="262">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def content_store_has_policy_and_engagement_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="263">
            <span class="hits">1</span>
            

            

            <code class="ruby">    finder_fixture = File.read(Rails.root.join(&quot;features/fixtures/policy_and_engagement.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="264">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="265">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/search/policy-papers-and-consultations&quot;, finder_fixture)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="266">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="267">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="268">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def search_params(params = {})</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="269">
            
            

            

            <code class="ruby">    default_search_params.merge(params).to_a.map { |tuple|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="270">
            
            

            

            <code class="ruby">      tuple.join(&quot;=&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="271">
            
            

            

            <code class="ruby">    }.join(&quot;&amp;&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="272">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="273">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="274">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_content_store_with_cma_cases_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="275">
            <span class="hits">1</span>
            

            

            <code class="ruby">    schema = govuk_content_schema_example(&quot;cma-cases&quot;, &quot;finder&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="276">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="277">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_content_store_has_item(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="278">
            
            

            

            <code class="ruby">      schema.fetch(&quot;base_path&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="279">
            
            

            

            <code class="ruby">      schema.to_json,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="280">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="281">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="282">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="283">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_content_store_with_a_taxon_tagged_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="284">
            <span class="hits">1</span>
            

            

            <code class="ruby">    schema = govuk_content_schema_example(&quot;cma-cases&quot;, &quot;finder&quot;).merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="285">
            
            

            

            <code class="ruby">      &quot;links&quot; =&gt; {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="286">
            
            

            

            <code class="ruby">        &quot;taxons&quot; =&gt; [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="287">
            
            

            

            <code class="ruby">          {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="288">
            
            

            

            <code class="ruby">            &quot;api_path&quot; =&gt; &quot;/api/content/business/competition-competition-act-cartels&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="289">
            
            

            

            <code class="ruby">            &quot;base_path&quot; =&gt; &quot;/business/competition-competition-act-cartels&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="290">
            
            

            

            <code class="ruby">            &quot;content_id&quot; =&gt; &quot;900ee60d-32ed-4dba-9834-09f54de01d5d&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="291">
            
            

            

            <code class="ruby">            &quot;document_type&quot; =&gt; &quot;taxon&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="292">
            
            

            

            <code class="ruby">            &quot;locale&quot; =&gt; &quot;en&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="293">
            
            

            

            <code class="ruby">            &quot;public_updated_at&quot; =&gt; &quot;2018-09-03T15:41:04Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="294">
            
            

            

            <code class="ruby">            &quot;schema_name&quot; =&gt; &quot;taxon&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="295">
            
            

            

            <code class="ruby">            &quot;title&quot; =&gt; &quot;Competition Act and cartels&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="296">
            
            

            

            <code class="ruby">            &quot;withdrawn&quot;: false,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="297">
            
            

            

            <code class="ruby">            &quot;details&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="298">
            
            

            

            <code class="ruby">              &quot;internal_name&quot; =&gt; &quot;Competition Act and cartels [T]&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="299">
            
            

            

            <code class="ruby">              &quot;notes_for_editors&quot; =&gt; &quot;&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="300">
            
            

            

            <code class="ruby">              &quot;visible_to_departmental_editors&quot;: false,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="301">
            
            

            

            <code class="ruby">            },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="302">
            
            

            

            <code class="ruby">            &quot;phase&quot; =&gt; &quot;live&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="303">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="304">
            
            

            

            <code class="ruby">        ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="305">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="306">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="307">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="308">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_content_store_has_item(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="309">
            
            

            

            <code class="ruby">      schema.fetch(&quot;base_path&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="310">
            
            

            

            <code class="ruby">      schema.to_json,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="311">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="312">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="313">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="314">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_with_cma_cases</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="315">
            <span class="hits">5</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="316">
            
            

            

            <code class="ruby">      .with(query: rummager_all_cma_case_documents_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="317">
            
            

            

            <code class="ruby">      .to_return(body: all_cma_case_documents_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="318">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="319">
            <span class="hits">5</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="320">
            
            

            

            <code class="ruby">      .with(query: rummager_filtered_cma_case_documents_params)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="321">
            
            

            

            <code class="ruby">      .to_return(body: filtered_cma_case_documents_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="322">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="323">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="324">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_content_store_with_cma_cases_finder_with_description</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="325">
            <span class="hits">1</span>
            

            

            <code class="ruby">    schema = govuk_content_schema_example(&quot;cma-cases&quot;, &quot;finder&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="326">
            
            

            

            <code class="ruby">      .merge(&quot;description&quot; =&gt; &quot;Find reports and updates on current and historical CMA investigations&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="327">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="328">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_content_store_has_item(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="329">
            
            

            

            <code class="ruby">      schema.fetch(&quot;base_path&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="330">
            
            

            

            <code class="ruby">      schema.to_json,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="331">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="332">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="333">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="334">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_content_store_with_cma_cases_finder_with_no_index</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="335">
            <span class="hits">1</span>
            

            

            <code class="ruby">    schema = govuk_content_schema_example(&quot;cma-cases&quot;, &quot;finder&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="336">
            <span class="hits">1</span>
            

            

            <code class="ruby">    schema[&quot;details&quot;][&quot;no_index&quot;] = true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="337">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="338">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_content_store_has_item(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="339">
            
            

            

            <code class="ruby">      schema.fetch(&quot;base_path&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="340">
            
            

            

            <code class="ruby">      schema.to_json,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="341">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="342">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="343">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="344">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_content_store_with_cma_cases_finder_with_metadata</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="345">
            <span class="hits">1</span>
            

            

            <code class="ruby">    schema = govuk_content_schema_example(&quot;cma-cases&quot;, &quot;finder&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="346">
            
            

            

            <code class="ruby">      .merge(&quot;from&quot; =&gt; &quot;An authority&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="347">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="348">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_content_store_has_item(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="349">
            
            

            

            <code class="ruby">      schema.fetch(&quot;base_path&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="350">
            
            

            

            <code class="ruby">      schema.to_json,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="351">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="352">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="353">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="354">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_content_store_with_cma_cases_finder_with_metadata_with_topic_param</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="355">
            
            

            

            <code class="ruby">    schema = govuk_content_schema_example(&quot;cma-cases&quot;, &quot;finder&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="356">
            
            

            

            <code class="ruby">      .merge(&quot;from&quot; =&gt; &quot;An authority&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="357">
            
            

            

            <code class="ruby">    schema[&quot;content_id&quot;] = &quot;c58fdadd-7743-46d6-9629-90bb3ccc4ef0&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="358">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="359">
            
            

            

            <code class="ruby">    stub_content_store_has_item(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="360">
            
            

            

            <code class="ruby">      schema.fetch(&quot;base_path&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="361">
            
            

            

            <code class="ruby">      schema.to_json,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="362">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="363">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="364">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="365">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_content_store_with_cma_cases_finder_for_supergroup_checkbox_filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="366">
            <span class="hits">4</span>
            

            

            <code class="ruby">    schema = govuk_content_schema_example(&quot;cma-cases&quot;, &quot;finder&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="367">
            <span class="hits">4</span>
            

            

            <code class="ruby">    schema[&quot;details&quot;][&quot;facets&quot;].map! do |facet|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="24" data-linenumber="368">
            <span class="hits">24</span>
            

            

            <code class="ruby">      if facet[&quot;key&quot;] == &quot;case_state&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="369">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="370">
            <span class="hits">4</span>
            

            

            <code class="ruby">          &quot;value&quot; =&gt; &quot;open&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="371">
            
            

            

            <code class="ruby">          &quot;filter_value&quot; =&gt; &quot;open&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="372">
            
            

            

            <code class="ruby">          &quot;key&quot; =&gt; &quot;case_state&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="373">
            
            

            

            <code class="ruby">          &quot;name&quot; =&gt; &quot;Show open cases&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="374">
            
            

            

            <code class="ruby">          &quot;short_name&quot; =&gt; &quot;Open&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="375">
            
            

            

            <code class="ruby">          &quot;type&quot; =&gt; &quot;checkbox&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="376">
            
            

            

            <code class="ruby">          &quot;display_as_result_metadata&quot; =&gt; false,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="377">
            
            

            

            <code class="ruby">          &quot;filterable&quot; =&gt; true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="378">
            
            

            

            <code class="ruby">          &quot;preposition&quot; =&gt; &quot;that is&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="379">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="380">
            
            

            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="381">
            <span class="hits">20</span>
            

            

            <code class="ruby">        facet</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="382">
            
            

            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="383">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="384">
            <span class="hits">4</span>
            

            

            <code class="ruby">    schema[&quot;details&quot;][&quot;facets&quot;] &lt;&lt; stub_content_store_has_item(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="385">
            
            

            

            <code class="ruby">      schema.fetch(&quot;base_path&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="386">
            
            

            

            <code class="ruby">      schema.to_json,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="387">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="388">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="389">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="390">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_with_cma_cases_for_supergroups_checkbox</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="391">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="392">
            
            

            

            <code class="ruby">      .with(query: hash_including(rummager_all_cma_case_documents_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="393">
            
            

            

            <code class="ruby">      .to_return(body: all_cma_case_documents_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="394">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="395">
            
            

            

            <code class="ruby">    open_cma_case_documents_params =</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="396">
            <span class="hits">4</span>
            

            

            <code class="ruby">      cma_case_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="397">
            
            

            

            <code class="ruby">        &quot;filter_case_state&quot; =&gt; &quot;open&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="398">
            
            

            

            <code class="ruby">        &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="399">
            
            

            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="400">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="401">
            <span class="hits">4</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="402">
            
            

            

            <code class="ruby">      .with(query: hash_including(open_cma_case_documents_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="403">
            
            

            

            <code class="ruby">      .to_return(body: filtered_cma_case_documents_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="404">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="405">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="406">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_rummager_with_cma_cases_for_supergroups_checkbox_and_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="407">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="408">
            
            

            

            <code class="ruby">      .with(query: hash_including(rummager_all_cma_case_documents_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="409">
            
            

            

            <code class="ruby">      .to_return(body: all_cma_case_documents_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="410">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="411">
            <span class="hits">1</span>
            

            

            <code class="ruby">    open_cma_case_documents_params = cma_case_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="412">
            
            

            

            <code class="ruby">      &quot;filter_case_state&quot; =&gt; &quot;open&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="413">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="414">
            
            

            

            <code class="ruby">      &quot;filter_closed_date&quot; =&gt; &quot;from:2015-11-01&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="415">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="416">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="417">
            <span class="hits">1</span>
            

            

            <code class="ruby">    stub_request(:get, SEARCH_ENDPOINT)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="418">
            
            

            

            <code class="ruby">      .with(query: hash_including(open_cma_case_documents_params))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="419">
            
            

            

            <code class="ruby">      .to_return(body: filtered_cma_case_documents_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="420">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="421">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="422">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_all_documents_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="423">
            <span class="hits">5</span>
            

            

            <code class="ruby">    mosw_search_params.merge(&quot;order&quot; =&gt; &quot;-public_timestamp&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="424">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="425">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="426">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_0_documents_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="427">
            <span class="hits">1</span>
            

            

            <code class="ruby">    mosw_search_params_no_facets.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="428">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="429">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; 1500,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="430">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="431">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="432">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="433">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_10_documents_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="434">
            <span class="hits">2</span>
            

            

            <code class="ruby">    mosw_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="435">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="436">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; 10,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="437">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="438">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="439">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="440">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_10_documents_page_2_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="441">
            <span class="hits">1</span>
            

            

            <code class="ruby">    mosw_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="442">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="443">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; 10,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="444">
            
            

            

            <code class="ruby">      &quot;start&quot; =&gt; 10,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="445">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="446">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="447">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="448">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_hopscotch_walks_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="449">
            <span class="hits">4</span>
            

            

            <code class="ruby">    mosw_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="450">
            
            

            

            <code class="ruby">      &quot;filter_walk_type&quot; =&gt; %w[hopscotch],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="451">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="452">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="453">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="454">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="455">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_keyword_search_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="456">
            <span class="hits">2</span>
            

            

            <code class="ruby">    mosw_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="457">
            
            

            

            <code class="ruby">      &quot;q&quot; =&gt; &quot;keyword searchable&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="458">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="459">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="460">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="461">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="462">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_newest_news_and_communications_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="463">
            <span class="hits">4</span>
            

            

            <code class="ruby">    news_and_communications_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="464">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="465">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; &quot;20&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="466">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="467">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="468">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="469">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_popular_news_and_communications_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="470">
            <span class="hits">4</span>
            

            

            <code class="ruby">    news_and_communications_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="471">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-popularity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="472">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; &quot;20&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="473">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="474">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="475">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="476">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_popular_services_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="477">
            <span class="hits">4</span>
            

            

            <code class="ruby">    services_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="478">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-popularity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="479">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; &quot;20&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="480">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="481">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="482">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="483">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_alphabetical_services_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="484">
            <span class="hits">4</span>
            

            

            <code class="ruby">    services_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="485">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;title&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="486">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; &quot;20&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="487">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="488">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="489">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="490">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_document_other_page_search_params(page_number)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="491">
            <span class="hits">1</span>
            

            

            <code class="ruby">    count_per_page = 10</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="492">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="493">
            <span class="hits">1</span>
            

            

            <code class="ruby">    mosw_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="494">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="495">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; count_per_page,</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="496">
            <span class="hits">1</span>
            

            

            <code class="ruby">      &quot;start&quot; =&gt; ((page_number - 1) * count_per_page),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="497">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="498">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="499">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="500">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_all_cma_case_documents_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="501">
            <span class="hits">10</span>
            

            

            <code class="ruby">    cma_case_search_params.merge(&quot;order&quot; =&gt; &quot;-public_timestamp&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="502">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="503">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="504">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_filtered_cma_case_documents_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="505">
            <span class="hits">5</span>
            

            

            <code class="ruby">    cma_case_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="506">
            
            

            

            <code class="ruby">      &quot;filter_closed_date&quot; =&gt; &quot;from:2015-11-01&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="507">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="508">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="509">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="510">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="511">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def aaib_reports_search_results</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="512">
            
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="513">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="514">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="515">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Acme keyword searchable walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="516">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2010-10-06&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="517">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;ACME researched a new type of silly walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="518">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;mosw_report&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="519">
            
            

            

            <code class="ruby">          &quot;walk_type&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="520">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;backwards&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="521">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Backwards&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="522">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="523">
            
            

            

            <code class="ruby">          &quot;place_of_origin&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="524">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;scotland&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="525">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Scotland&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="526">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="527">
            
            

            

            <code class="ruby">          &quot;creator&quot;: &quot;Wile E Coyote&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="528">
            
            

            

            <code class="ruby">          &quot;date_of_introduction&quot;: &quot;2014-08-28&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="529">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;mosw-reports/acme-keyword-searchable-walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="530">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;mosw-reports/acme-keyword-searchable-walk&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="531">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="532">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="533">
            
            

            

            <code class="ruby">      &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="534">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="535">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="536">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="537">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="538">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="539">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="540">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def keyword_search_results</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="541">
            <span class="hits">2</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="542">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="543">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="544">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Acme keyword searchable walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="545">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2010-10-06&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="546">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;ACME researched a new type of silly walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="547">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;mosw_report&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="548">
            
            

            

            <code class="ruby">          &quot;walk_type&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="549">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;backwards&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="550">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Backwards&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="551">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="552">
            
            

            

            <code class="ruby">          &quot;place_of_origin&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="553">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;scotland&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="554">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Scotland&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="555">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="556">
            
            

            

            <code class="ruby">          &quot;creator&quot;: &quot;Wile E Coyote&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="557">
            
            

            

            <code class="ruby">          &quot;date_of_introduction&quot;: &quot;2014-08-28&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="558">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;mosw-reports/acme-keyword-searchable-walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="559">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;mosw-reports/acme-keyword-searchable-walk&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="560">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="561">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="562">
            
            

            

            <code class="ruby">      &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="563">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="564">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="565">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="566">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="567">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="568">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="569">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_documents_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="570">
            <span class="hits">4</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="571">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="572">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="573">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;West London wobbley walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="574">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2014-11-25&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="575">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;MOSW researched a new type of silly walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="576">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;mosw_report&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="577">
            
            

            

            <code class="ruby">          &quot;walk_type&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="578">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;backward&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="579">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Backward&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="580">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="581">
            
            

            

            <code class="ruby">          &quot;place_of_origin&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="582">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;england&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="583">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;England&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="584">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="585">
            
            

            

            <code class="ruby">          &quot;creator&quot;: &quot;Road Runner&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="586">
            
            

            

            <code class="ruby">          &quot;date_of_introduction&quot;: &quot;2003-12-30&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="587">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/mosw-reports/west-london-wobbley-walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="588">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/mosw-reports/west-london-wobbley-walk&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="589">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="590">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="591">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;The Gerry Anderson&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="592">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2010-10-06&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="593">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;Rhyming slang for Dander, an Irish colloquialism for walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="594">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;mosw_report&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="595">
            
            

            

            <code class="ruby">          &quot;walk_type&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="596">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;hopscotch&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="597">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Hopscotch&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="598">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="599">
            
            

            

            <code class="ruby">          &quot;place_of_origin&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="600">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;northern-ireland&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="601">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Northern Ireland&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="602">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="603">
            
            

            

            <code class="ruby">          &quot;creator&quot;: &quot;&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="604">
            
            

            

            <code class="ruby">          &quot;date_of_introduction&quot;: &quot;1914-08-28&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="605">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/mosw-reports/the-gerry-anderson&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="606">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/mosw-reports/the-gerry-anderson&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="607">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="608">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="609">
            
            

            

            <code class="ruby">      &quot;total&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="610">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="611">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="612">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="613">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="614">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="615">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="616">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def no_results_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="617">
            <span class="hits">2</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="618">
            
            

            

            <code class="ruby">      &quot;results&quot;: [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="619">
            
            

            

            <code class="ruby">      &quot;total&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="620">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="621">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="622">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="623">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="624">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="625">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="626">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def spelling_suggestions_json</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="627">
            
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="628">
            
            

            

            <code class="ruby">      &quot;results&quot;: #{government_document_results_json},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="629">
            
            

            

            <code class="ruby">      &quot;total&quot;: 20,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="630">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="631">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="632">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: [{ &quot;text&quot;: &quot;driving&quot;, &quot;highlighted&quot;: &quot;&lt;mark&gt;driving&lt;/mark&gt;&quot; }]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="633">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="634">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="635">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="636">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def government_documents_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="637">
            <span class="hits">5</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="638">
            
            

            

            <code class="ruby">      &quot;results&quot;: #{government_document_results_json},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="639">
            
            

            

            <code class="ruby">      &quot;total&quot;: 20,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="640">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="641">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="642">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="643">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="644">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="645">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="646">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def government_documents_page_2_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="647">
            <span class="hits">1</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="648">
            
            

            

            <code class="ruby">      &quot;results&quot;: #{government_document_results_json(5)},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="649">
            
            

            

            <code class="ruby">      &quot;total&quot;: 20,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="650">
            
            

            

            <code class="ruby">      &quot;start&quot;: 10,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="651">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="652">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="653">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="654">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="655">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="656">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def government_document_results_json(start_at = 0)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="657">
            <span class="hits">6</span>
            

            

            <code class="ruby">    results = []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="658">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="659">
            <span class="hits">6</span>
            

            

            <code class="ruby">    5.times do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="660">
            <span class="hits">30</span>
            

            

            <code class="ruby">      results &lt;&lt; [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="661">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="662">
            
            

            

            <code class="ruby">          &quot;title&quot; =&gt; &quot;Document #{n + start_at}&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="663">
            
            

            

            <code class="ruby">          &quot;summary&quot; =&gt; &quot;Giving all children access to a computer&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="664">
            
            

            

            <code class="ruby">          &quot;format&quot; =&gt; &quot;news_article&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="665">
            
            

            

            <code class="ruby">          &quot;creator&quot; =&gt; &quot;Dale Cooper&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="666">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot; =&gt; &quot;2007-02-14T00:00:00.000+01:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="667">
            
            

            

            <code class="ruby">          &quot;is_historic&quot; =&gt; true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="668">
            
            

            

            <code class="ruby">          &quot;display_type&quot; =&gt; &quot;News Story&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="669">
            
            

            

            <code class="ruby">          &quot;organisations&quot; =&gt; [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="670">
            
            

            

            <code class="ruby">            &quot;slug&quot; =&gt; &quot;ministry-of-justice&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="671">
            
            

            

            <code class="ruby">            &quot;link&quot; =&gt; &quot;/government/organisations/ministry-of-justice&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="672">
            
            

            

            <code class="ruby">            &quot;title&quot; =&gt; &quot;Ministry of Justice&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="673">
            
            

            

            <code class="ruby">            &quot;acronym&quot; =&gt; &quot;MoJ&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="674">
            
            

            

            <code class="ruby">            &quot;organisation_state&quot; =&gt; &quot;live&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="675">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="676">
            
            

            

            <code class="ruby">          &quot;government_name&quot; =&gt; &quot;2005 to 2010 Labour government&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="677">
            
            

            

            <code class="ruby">          &quot;link&quot; =&gt; &quot;/government/policies/education/free-computers-for-schools&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="678">
            
            

            

            <code class="ruby">          &quot;_id&quot; =&gt; &quot;/government/policies/education/free-computers-for-schools&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="679">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="680">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="681">
            
            

            

            <code class="ruby">          &quot;title&quot; =&gt; &quot;Document #{n + 1 + start_at}&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="682">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot; =&gt; &quot;2015-03-14T00:00:00.000+01:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="683">
            
            

            

            <code class="ruby">          &quot;summary&quot; =&gt; &quot;We lost a day and found it again so everyone can get it off&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="684">
            
            

            

            <code class="ruby">          &quot;format&quot; =&gt; &quot;news_article&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="685">
            
            

            

            <code class="ruby">          &quot;creator&quot; =&gt; &quot;Dale Cooper&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="686">
            
            

            

            <code class="ruby">          &quot;is_historic&quot; =&gt; false,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="687">
            
            

            

            <code class="ruby">          &quot;display_type&quot; =&gt; &quot;News Story&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="688">
            
            

            

            <code class="ruby">          &quot;organisations&quot; =&gt; [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="689">
            
            

            

            <code class="ruby">            &quot;slug&quot; =&gt; &quot;ministry-of-justice&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="690">
            
            

            

            <code class="ruby">            &quot;link&quot; =&gt; &quot;/government/organisations/ministry-of-justice&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="691">
            
            

            

            <code class="ruby">            &quot;title&quot; =&gt; &quot;Ministry of Justice&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="692">
            
            

            

            <code class="ruby">            &quot;acronym&quot; =&gt; &quot;MoJ&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="693">
            
            

            

            <code class="ruby">            &quot;organisation_state&quot; =&gt; &quot;live&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="694">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="695">
            
            

            

            <code class="ruby">          &quot;government_name&quot; =&gt; &quot;2010 to 2015 Conservative and Liberal Democrat Coalition government&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="696">
            
            

            

            <code class="ruby">          &quot;link&quot; =&gt; &quot;/government/policies/education/an-extra-bank-holiday-per-year&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="697">
            
            

            

            <code class="ruby">          &quot;_id&quot; =&gt; &quot;/government/policies/education/an-extra-bank-holiday-per-year&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="698">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="699">
            
            

            

            <code class="ruby">      ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="700">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="701">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="702">
            <span class="hits">6</span>
            

            

            <code class="ruby">    results.flatten.to_json</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="703">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="704">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="705">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def newest_news_and_communication_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="17" data-linenumber="706">
            <span class="hits">17</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="707">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="708">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="709">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;News from Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="710">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/news-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="711">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Breaking wizard news from Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="712">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="713">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="714">
            
            

            

            <code class="ruby">            &quot;4bc72a8b-6011-457a-87e0-06dbb427cf36&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="715">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="716">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="717">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="718">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="719">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="720">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="721">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="722">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="723">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="724">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="725">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="726">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="727">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="728">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="729">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="730">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="731">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="732">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="733">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="734">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/news-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="735">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;news_article&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="736">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;news_article&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="737">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="738">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="739">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Press release from Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="740">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/press-release-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="741">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;An important press release from Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="742">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-25T09:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="743">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="744">
            
            

            

            <code class="ruby">            &quot;4bc72a8b-6011-457a-87e0-06dbb427cf36&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="745">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="746">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="747">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="748">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="749">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="750">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="751">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="752">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="753">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="754">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="755">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="756">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="757">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="758">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="759">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="760">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="761">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="762">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="763">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="764">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/press-release-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="765">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;press_release&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="766">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;press_release&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="767">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="768">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="769">
            
            

            

            <code class="ruby">      &quot;total&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="770">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="771">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="772">
            
            

            

            <code class="ruby">        &quot;people&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="773">
            
            

            

            <code class="ruby">          &quot;options&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="774">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="775">
            
            

            

            <code class="ruby">              &quot;value&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="776">
            
            

            

            <code class="ruby">                &quot;slug&quot;: &quot;harry-potter&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="777">
            
            

            

            <code class="ruby">                &quot;title&quot;: &quot;Harry Potter&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="778">
            
            

            

            <code class="ruby">                &quot;content_id&quot;: &quot;aca5d2de-1fef-45fe-a39d-6a779589d220&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="779">
            
            

            

            <code class="ruby">                &quot;link&quot;: &quot;/people/harry-potter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="780">
            
            

            

            <code class="ruby">              },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="781">
            
            

            

            <code class="ruby">              &quot;documents&quot;: 2</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="782">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="783">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="784">
            
            

            

            <code class="ruby">          &quot;documents_with_no_value&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="785">
            
            

            

            <code class="ruby">          &quot;total_options&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="786">
            
            

            

            <code class="ruby">          &quot;missing_options&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="787">
            
            

            

            <code class="ruby">          &quot;scope&quot;: &quot;exclude_field_filter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="788">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="789">
            
            

            

            <code class="ruby">        &quot;organisations&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="790">
            
            

            

            <code class="ruby">          &quot;options&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="791">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="792">
            
            

            

            <code class="ruby">              &quot;value&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="793">
            
            

            

            <code class="ruby">                &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="794">
            
            

            

            <code class="ruby">                &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="795">
            
            

            

            <code class="ruby">                &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="796">
            
            

            

            <code class="ruby">                &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="797">
            
            

            

            <code class="ruby">                &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="798">
            
            

            

            <code class="ruby">                &quot;link&quot;: &quot;/organisations/academy-for-social-justice-commissioning&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="799">
            
            

            

            <code class="ruby">                &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="800">
            
            

            

            <code class="ruby">                &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="801">
            
            

            

            <code class="ruby">                &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="802">
            
            

            

            <code class="ruby">                &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="803">
            
            

            

            <code class="ruby">                &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="804">
            
            

            

            <code class="ruby">              },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="805">
            
            

            

            <code class="ruby">              &quot;documents&quot;: 2</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="806">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="807">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="808">
            
            

            

            <code class="ruby">          &quot;documents_with_no_value&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="809">
            
            

            

            <code class="ruby">          &quot;total_options&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="810">
            
            

            

            <code class="ruby">          &quot;missing_options&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="811">
            
            

            

            <code class="ruby">          &quot;scope&quot;: &quot;exclude_field_filter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="812">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="813">
            
            

            

            <code class="ruby">        &quot;world_locations&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="814">
            
            

            

            <code class="ruby">          &quot;options&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="815">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="816">
            
            

            

            <code class="ruby">              &quot;value&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="817">
            
            

            

            <code class="ruby">                &quot;slug&quot;: &quot;azkaban&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="818">
            
            

            

            <code class="ruby">                &quot;title&quot;: &quot;Azkaban&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="819">
            
            

            

            <code class="ruby">                &quot;content_id&quot;: &quot;db3c2a86-2060-4c37-b8a4-9e3c4e6c91e2&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="820">
            
            

            

            <code class="ruby">                &quot;link&quot;: &quot;/world/azkaban&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="821">
            
            

            

            <code class="ruby">              },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="822">
            
            

            

            <code class="ruby">              &quot;documents&quot;: 2</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="823">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="824">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="825">
            
            

            

            <code class="ruby">          &quot;documents_with_no_value&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="826">
            
            

            

            <code class="ruby">          &quot;total_options&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="827">
            
            

            

            <code class="ruby">          &quot;missing_options&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="828">
            
            

            

            <code class="ruby">          &quot;scope&quot;: &quot;exclude_field_filter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="829">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="830">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="831">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="832">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="833">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="834">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="835">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def popular_news_and_communication_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="836">
            <span class="hits">4</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="837">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="838">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="839">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Press release from Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="840">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/press-release-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="841">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;An important press release from Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="842">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-25T09:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="843">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="844">
            
            

            

            <code class="ruby">            &quot;4bc72a8b-6011-457a-87e0-06dbb427cf36&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="845">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="846">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="847">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="848">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="849">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="850">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="851">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="852">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="853">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="854">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="855">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="856">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="857">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="858">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="859">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="860">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="861">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="862">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="863">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="864">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/press-release-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="865">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;press_release&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="866">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;press_release&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="867">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="868">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="869">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;News from Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="870">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/news-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="871">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Breaking wizard news from Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="872">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="873">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="874">
            
            

            

            <code class="ruby">            &quot;4bc72a8b-6011-457a-87e0-06dbb427cf36&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="875">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="876">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="877">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="878">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="879">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="880">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="881">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="882">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="883">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="884">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="885">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="886">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="887">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="888">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="889">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="890">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="891">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="892">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="893">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="894">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/news-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="895">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;news_article&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="896">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;news_article&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="897">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="898">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="899">
            
            

            

            <code class="ruby">      &quot;total&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="900">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="901">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="902">
            
            

            

            <code class="ruby">        &quot;people&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="903">
            
            

            

            <code class="ruby">          &quot;options&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="904">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="905">
            
            

            

            <code class="ruby">              &quot;value&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="906">
            
            

            

            <code class="ruby">                &quot;slug&quot;: &quot;harry-potter&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="907">
            
            

            

            <code class="ruby">                &quot;title&quot;: &quot;Harry Potter&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="908">
            
            

            

            <code class="ruby">                &quot;content_id&quot;: &quot;aca5d2de-1fef-45fe-a39d-6a779589d220&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="909">
            
            

            

            <code class="ruby">                &quot;link&quot;: &quot;/people/harry-potter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="910">
            
            

            

            <code class="ruby">              },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="911">
            
            

            

            <code class="ruby">              &quot;documents&quot;: 2</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="912">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="913">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="914">
            
            

            

            <code class="ruby">          &quot;documents_with_no_value&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="915">
            
            

            

            <code class="ruby">          &quot;total_options&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="916">
            
            

            

            <code class="ruby">          &quot;missing_options&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="917">
            
            

            

            <code class="ruby">          &quot;scope&quot;: &quot;exclude_field_filter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="918">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="919">
            
            

            

            <code class="ruby">        &quot;organisations&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="920">
            
            

            

            <code class="ruby">          &quot;options&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="921">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="922">
            
            

            

            <code class="ruby">              &quot;value&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="923">
            
            

            

            <code class="ruby">                &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="924">
            
            

            

            <code class="ruby">                &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="925">
            
            

            

            <code class="ruby">                &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="926">
            
            

            

            <code class="ruby">                &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="927">
            
            

            

            <code class="ruby">                &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="928">
            
            

            

            <code class="ruby">                &quot;link&quot;: &quot;/organisations/academy-for-social-justice-commissioning&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="929">
            
            

            

            <code class="ruby">                &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="930">
            
            

            

            <code class="ruby">                &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="931">
            
            

            

            <code class="ruby">                &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="932">
            
            

            

            <code class="ruby">                &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="933">
            
            

            

            <code class="ruby">                &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="934">
            
            

            

            <code class="ruby">              },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="935">
            
            

            

            <code class="ruby">              &quot;documents&quot;: 2</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="936">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="937">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="938">
            
            

            

            <code class="ruby">          &quot;documents_with_no_value&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="939">
            
            

            

            <code class="ruby">          &quot;total_options&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="940">
            
            

            

            <code class="ruby">          &quot;missing_options&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="941">
            
            

            

            <code class="ruby">          &quot;scope&quot;: &quot;exclude_field_filter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="942">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="943">
            
            

            

            <code class="ruby">        &quot;world_locations&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="944">
            
            

            

            <code class="ruby">          &quot;options&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="945">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="946">
            
            

            

            <code class="ruby">              &quot;value&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="947">
            
            

            

            <code class="ruby">                &quot;slug&quot;: &quot;azkaban&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="948">
            
            

            

            <code class="ruby">                &quot;title&quot;: &quot;Azkaban&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="949">
            
            

            

            <code class="ruby">                &quot;content_id&quot;: &quot;db3c2a86-2060-4c37-b8a4-9e3c4e6c91e2&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="950">
            
            

            

            <code class="ruby">                &quot;link&quot;: &quot;/world/azkaban&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="951">
            
            

            

            <code class="ruby">              },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="952">
            
            

            

            <code class="ruby">              &quot;documents&quot;: 2</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="953">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="954">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="955">
            
            

            

            <code class="ruby">          &quot;documents_with_no_value&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="956">
            
            

            

            <code class="ruby">          &quot;total_options&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="957">
            
            

            

            <code class="ruby">          &quot;missing_options&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="958">
            
            

            

            <code class="ruby">          &quot;scope&quot;: &quot;exclude_field_filter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="959">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="960">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="961">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="962">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="963">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="964">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="965">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def alpabetical_services_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="966">
            <span class="hits">4</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="967">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="968">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="969">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Apply for your full broomstick licence&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="970">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;apply-for-your-full-broomstick-licence&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="971">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;How to get your full broomstick licence once you&#39;ve passed your broomstick test&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="972">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="973">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="974">
            
            

            

            <code class="ruby">            &quot;4bc72a8b-6011-457a-87e0-06dbb427cf36&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="975">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="976">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="977">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="978">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="979">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="980">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="981">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="982">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="983">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="984">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="985">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="986">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="987">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="988">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="989">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="990">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="991">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="992">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="993">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="994">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/news-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="995">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;transaction&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="996">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;transaction&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="997">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="998">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="999">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Register a spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1000">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/register-a-spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1001">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Register a magical spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1002">
            
            

            

            <code class="ruby">          &quot;description_with_highlighting&quot;: &quot;Register a magical spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1003">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-25T09:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1004">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1005">
            
            

            

            <code class="ruby">            &quot;4bc72a8b-6011-457a-87e0-06dbb427cf36&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1006">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1007">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1008">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1009">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1010">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1011">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1012">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1013">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1014">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1015">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1016">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1017">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1018">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1019">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1020">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1021">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1022">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1023">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1024">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1025">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/register-a-spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1026">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;transaction&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1027">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;transaction&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1028">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1029">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1030">
            
            

            

            <code class="ruby">      &quot;total&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1031">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1032">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1033">
            
            

            

            <code class="ruby">        &quot;organisations&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1034">
            
            

            

            <code class="ruby">          &quot;options&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1035">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1036">
            
            

            

            <code class="ruby">              &quot;value&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1037">
            
            

            

            <code class="ruby">                &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1038">
            
            

            

            <code class="ruby">                &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1039">
            
            

            

            <code class="ruby">                &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1040">
            
            

            

            <code class="ruby">                &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1041">
            
            

            

            <code class="ruby">                &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1042">
            
            

            

            <code class="ruby">                &quot;link&quot;: &quot;/organisations/academy-for-social-justice-commissioning&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1043">
            
            

            

            <code class="ruby">                &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1044">
            
            

            

            <code class="ruby">                &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1045">
            
            

            

            <code class="ruby">                &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1046">
            
            

            

            <code class="ruby">                &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1047">
            
            

            

            <code class="ruby">                &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1048">
            
            

            

            <code class="ruby">              },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1049">
            
            

            

            <code class="ruby">              &quot;documents&quot;: 2</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1050">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1051">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1052">
            
            

            

            <code class="ruby">          &quot;documents_with_no_value&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1053">
            
            

            

            <code class="ruby">          &quot;total_options&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1054">
            
            

            

            <code class="ruby">          &quot;missing_options&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1055">
            
            

            

            <code class="ruby">          &quot;scope&quot;: &quot;exclude_field_filter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1056">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1057">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1058">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1059">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1060">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1061">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1062">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def popular_services_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="1063">
            <span class="hits">4</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1064">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1065">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1066">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Register a spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1067">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/register-a-spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1068">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Register a magical spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1069">
            
            

            

            <code class="ruby">          &quot;description_with_highlighting&quot;: &quot;Register a magical spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1070">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-25T09:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1071">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1072">
            
            

            

            <code class="ruby">            &quot;4bc72a8b-6011-457a-87e0-06dbb427cf36&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1073">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1074">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1075">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1076">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1077">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1078">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1079">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1080">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1081">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1082">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1083">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1084">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1085">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1086">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1087">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1088">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1089">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1090">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1091">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1092">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/register-a-spell&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1093">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;transaction&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1094">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;transaction&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1095">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1096">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1097">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Apply for your full broomstick licence&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1098">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;apply-for-your-full-broomstick-licence&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1099">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;How to get your full broomstick licence once you&#39;ve passed your broomstick test&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1100">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1101">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1102">
            
            

            

            <code class="ruby">            &quot;4bc72a8b-6011-457a-87e0-06dbb427cf36&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1103">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1104">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1105">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1106">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1107">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1108">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1109">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1110">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1111">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1112">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1113">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1114">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1115">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1116">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1117">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1118">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1119">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1120">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1121">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1122">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/news-from-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1123">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;transaction&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1124">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;transaction&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1125">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1126">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1127">
            
            

            

            <code class="ruby">      &quot;total&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1128">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1129">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1130">
            
            

            

            <code class="ruby">        &quot;organisations&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1131">
            
            

            

            <code class="ruby">          &quot;options&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1132">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1133">
            
            

            

            <code class="ruby">              &quot;value&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1134">
            
            

            

            <code class="ruby">                &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1135">
            
            

            

            <code class="ruby">                &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1136">
            
            

            

            <code class="ruby">                &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1137">
            
            

            

            <code class="ruby">                &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1138">
            
            

            

            <code class="ruby">                &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1139">
            
            

            

            <code class="ruby">                &quot;link&quot;: &quot;/organisations/academy-for-social-justice-commissioning&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1140">
            
            

            

            <code class="ruby">                &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1141">
            
            

            

            <code class="ruby">                &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1142">
            
            

            

            <code class="ruby">                &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1143">
            
            

            

            <code class="ruby">                &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1144">
            
            

            

            <code class="ruby">                &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1145">
            
            

            

            <code class="ruby">              },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1146">
            
            

            

            <code class="ruby">              &quot;documents&quot;: 2</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1147">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1148">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1149">
            
            

            

            <code class="ruby">          &quot;documents_with_no_value&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1150">
            
            

            

            <code class="ruby">          &quot;total_options&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1151">
            
            

            

            <code class="ruby">          &quot;missing_options&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1152">
            
            

            

            <code class="ruby">          &quot;scope&quot;: &quot;exclude_field_filter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1153">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1154">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1155">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1156">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1157">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1158">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1159">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def documents_with_bad_data_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1160">
            <span class="hits">1</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1161">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1162">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1163">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;West London wobbley walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1164">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2014-11-25&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1165">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;MOSW researched a new type of silly walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1166">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;mosw_report&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1167">
            
            

            

            <code class="ruby">          &quot;walk_type&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1168">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;backward&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1169">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Backward&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1170">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1171">
            
            

            

            <code class="ruby">          &quot;place_of_origin&quot;: [null],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1172">
            
            

            

            <code class="ruby">          &quot;creator&quot;: &quot;Road Runner&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1173">
            
            

            

            <code class="ruby">          &quot;date_of_introduction&quot;: &quot;2003-12-30&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1174">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;mosw-reports/west-london-wobbley-walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1175">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;mosw-reports/west-london-wobbley-walk&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1176">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1177">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1178">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;The Gerry Anderson&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1179">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2010-10-06&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1180">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;Rhyming slang for Dander, an Irish colloquialism for walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1181">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;mosw_report&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1182">
            
            

            

            <code class="ruby">          &quot;walk_type&quot;: [null],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1183">
            
            

            

            <code class="ruby">          &quot;place_of_origin&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1184">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;northern-ireland&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1185">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Northern Ireland&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1186">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1187">
            
            

            

            <code class="ruby">          &quot;creator&quot;: &quot;&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1188">
            
            

            

            <code class="ruby">          &quot;date_of_introduction&quot;: &quot;1914-08-28&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1189">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;mosw-reports/the-gerry-anderson&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1190">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;mosw-reports/the-gerry-anderson&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1191">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1192">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1193">
            
            

            

            <code class="ruby">      &quot;total&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1194">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1195">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1196">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1197">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1198">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1199">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1200">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def hopscotch_reports_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="1201">
            <span class="hits">4</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1202">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1203">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1204">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;The Gerry Anderson&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1205">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2010-10-06&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1206">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;Rhyming slang for Dander, an Irish colloquialism for walk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1207">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;mosw_report&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1208">
            
            

            

            <code class="ruby">          &quot;walk_type&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1209">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;hopscotch&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1210">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Hopscotch&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1211">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1212">
            
            

            

            <code class="ruby">          &quot;place_of_origin&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1213">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;northern-ireland&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1214">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Northern Ireland&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1215">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1216">
            
            

            

            <code class="ruby">          &quot;creator&quot;: &quot;&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1217">
            
            

            

            <code class="ruby">          &quot;date_of_introduction&quot;: &quot;1914-08-28&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1218">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;mosw-reports/the-gerry-anderson&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1219">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;mosw-reports/the-gerry-anderson&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1220">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1221">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1222">
            
            

            

            <code class="ruby">      &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1223">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1224">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1225">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1226">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1227">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1228">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1229">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_cma_case_documents_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="1230">
            <span class="hits">10</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1231">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1232">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1233">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Big Beer Co / Salty Snacks Ltd merger inquiry&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1234">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2015-03-17T09:18:18+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1235">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;The CMA is investigating the merging of Big Beer Co and Salty Snacks Ltd.&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1236">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;cma_case&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1237">
            
            

            

            <code class="ruby">          &quot;case_type&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1238">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;mergers&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1239">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Mergers&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1240">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1241">
            
            

            

            <code class="ruby">          &quot;case_state&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1242">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;closed&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1243">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Closed&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1244">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1245">
            
            

            

            <code class="ruby">          &quot;market_sector&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1246">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;food-manufacturing&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1247">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Food manufacturing&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1248">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1249">
            
            

            

            <code class="ruby">          &quot;opened_date&quot;: &quot;2015-02-14&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1250">
            
            

            

            <code class="ruby">          &quot;closed_date&quot;: &quot;2016-02-14&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1251">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;cma-cases/big-beer-co-salty-snacks-ltd-merger&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1252">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;cma-cases/big-beer-co-salty-snacks-ltd-merger&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1253">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1254">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1255">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Bakery market investigation&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1256">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2015-01-06T10:34:17+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1257">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;The CMA is investigation the supply and marketing of pizza-cakes in Great Britain.&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1258">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;cma_case&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1259">
            
            

            

            <code class="ruby">          &quot;case_type&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1260">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;markets&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1261">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Markets&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1262">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1263">
            
            

            

            <code class="ruby">          &quot;case_state&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1264">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;closed&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1265">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Closed&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1266">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1267">
            
            

            

            <code class="ruby">          &quot;market_sector&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1268">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;food-manufacturing&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1269">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Food manufacturing&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1270">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1271">
            
            

            

            <code class="ruby">          &quot;opened_date&quot;: &quot;2014-10-31&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1272">
            
            

            

            <code class="ruby">          &quot;closed_date&quot;: &quot;2015-10-31&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1273">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;cma-cases/bakery-market-investigation&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1274">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;cma-cases/bakery-market-investigation&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1275">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1276">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1277">
            
            

            

            <code class="ruby">      &quot;total&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1278">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1279">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1280">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1281">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1282">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1283">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1284">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filtered_cma_case_documents_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="1285">
            <span class="hits">10</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1286">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1287">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1288">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Big Beer Co / Salty Snacks Ltd merger inquiry&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1289">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2015-03-17T09:18:18+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1290">
            
            

            

            <code class="ruby">          &quot;summary&quot;: &quot;The CMA is investigating the merging of Big Beer Co and Salty Snacks Ltd.&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1291">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;cma_case&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1292">
            
            

            

            <code class="ruby">          &quot;case_type&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1293">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;mergers&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1294">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Mergers&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1295">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1296">
            
            

            

            <code class="ruby">          &quot;case_state&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1297">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;open&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1298">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Open&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1299">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1300">
            
            

            

            <code class="ruby">          &quot;market_sector&quot;: [{</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1301">
            
            

            

            <code class="ruby">            &quot;value&quot;: &quot;food-manufacturing&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1302">
            
            

            

            <code class="ruby">            &quot;label&quot;: &quot;Food manufacturing&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1303">
            
            

            

            <code class="ruby">          }],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1304">
            
            

            

            <code class="ruby">          &quot;opened_date&quot;: &quot;2015-02-14&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1305">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;cma-cases/big-beer-co-salty-snacks-ltd-merger&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1306">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;cma-cases/big-beer-co-salty-snacks-ltd-merger&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1307">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1308">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1309">
            
            

            

            <code class="ruby">      &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1310">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1311">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {},</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1312">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1313">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1314">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1315">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1316">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def policy_and_engagement_results_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1317">
            <span class="hits">1</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1318">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1319">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1320">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1321">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1322">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1323">
            
            

            

            <code class="ruby">          &quot;description_with_highlighting&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1324">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-30T10:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1325">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1326">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1327">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1328">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1329">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1330">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1331">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1332">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1333">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1334">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1335">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1336">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1337">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1338">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1339">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1340">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1341">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1342">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1343">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1344">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1345">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1346">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1347">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;policy_paper&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1348">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;policy_paper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1349">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1350">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1351">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Proposed changes to magic tournaments&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1352">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;proposed-changes-to-magic-tournaments&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1353">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Proposed changes to magic tournaments&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1354">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1355">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1356">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1357">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1358">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1359">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1360">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1361">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1362">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1363">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1364">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1365">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1366">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1367">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1368">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1369">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1370">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1371">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1372">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1373">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1374">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1375">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1376">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/proposed-changes-to-magic-tournaments&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1377">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;open_consultation&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1378">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;open_consultation&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1379">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1380">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1381">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;New platform at Hogwarts for the express train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1382">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;new-platform-at-hogwarts-for-the-express-train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1383">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;New platform at Hogwarts for the express train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1384">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1385">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1386">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1387">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1388">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1389">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1390">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1391">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1392">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1393">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1394">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1395">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1396">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1397">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1398">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1399">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1400">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1401">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1402">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1403">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1404">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1405">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1406">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/new-platform-at-hogwarts-for-the-express-train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1407">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;closed_consultation&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1408">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;closed_consultation&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1409">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1410">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1411">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Installation of double glazing at Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1412">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;installation-of-double-glazing-at-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1413">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Installation of double glazing at Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1414">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1415">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1416">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1417">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1418">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1419">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1420">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1421">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1422">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1423">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1424">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1425">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1426">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1427">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1428">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1429">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1430">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1431">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1432">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1433">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1434">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1435">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1436">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/installation-of-double-glazing-at-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1437">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;consultation_outcome&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1438">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;consultation_outcome&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1439">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1440">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1441">
            
            

            

            <code class="ruby">      &quot;total&quot;: 4,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1442">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1443">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1444">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1445">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1446">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1447">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def policy_and_engagement_results_for_policy_papers_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1448">
            <span class="hits">1</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1449">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1450">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1451">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1452">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1453">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1454">
            
            

            

            <code class="ruby">          &quot;description_with_highlighting&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1455">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-30T10:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1456">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1457">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1458">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1459">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1460">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1461">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1462">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1463">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1464">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1465">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1466">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1467">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1468">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1469">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1470">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1471">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1472">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1473">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1474">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1475">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1476">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1477">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1478">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;policy_paper&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1479">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;policy_paper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1480">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1481">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1482">
            
            

            

            <code class="ruby">      &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1483">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1484">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1485">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1486">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1487">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1488">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def policy_and_engagement_results_for_policy_papers_and_closed_consultations_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1489">
            <span class="hits">1</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1490">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1491">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1492">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1493">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1494">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1495">
            
            

            

            <code class="ruby">          &quot;description_with_highlighting&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1496">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-30T10:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1497">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1498">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1499">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1500">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1501">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1502">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1503">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1504">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1505">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1506">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1507">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1508">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1509">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1510">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1511">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1512">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1513">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1514">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1515">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1516">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1517">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1518">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1519">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;policy_paper&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1520">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;policy_paper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1521">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1522">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1523">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;New platform at Hogwarts for the express train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1524">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;new-platform-at-hogwarts-for-the-express-train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1525">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;New platform at Hogwarts for the express train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1526">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1527">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1528">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1529">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1530">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1531">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1532">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1533">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1534">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1535">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1536">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1537">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1538">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1539">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1540">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1541">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1542">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1543">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1544">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1545">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1546">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1547">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1548">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/new-platform-at-hogwarts-for-the-express-train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1549">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;closed_consultation&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1550">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;closed_consultation&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1551">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1552">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1553">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Installation of double glazing at Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1554">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;installation-of-double-glazing-at-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1555">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Installation of double glazing at Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1556">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1557">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1558">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1559">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1560">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1561">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1562">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1563">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1564">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1565">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1566">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1567">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1568">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1569">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1570">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1571">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1572">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1573">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1574">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1575">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1576">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1577">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1578">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/installation-of-double-glazing-at-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1579">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;consultation_outcome&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1580">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;consultation_outcome&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1581">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1582">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1583">
            
            

            

            <code class="ruby">      &quot;total&quot;: 3,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1584">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1585">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1586">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1587">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1588">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1589">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def statistics_results_for_statistics_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="1590">
            <span class="hits">4</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1591">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1592">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1593">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1594">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1595">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1596">
            
            

            

            <code class="ruby">          &quot;description_with_highlighting&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1597">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-30T10:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1598">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1599">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1600">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1601">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1602">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1603">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1604">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1605">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1606">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1607">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1608">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1609">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1610">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1611">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1612">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1613">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1614">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1615">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1616">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1617">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1618">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1619">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1620">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;policy_paper&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1621">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;policy_paper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1622">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1623">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1624">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;New platform at Hogwarts for the express train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1625">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;new-platform-at-hogwarts-for-the-express-train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1626">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;New platform at Hogwarts for the express train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1627">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1628">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1629">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1630">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1631">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1632">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1633">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1634">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1635">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1636">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1637">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1638">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1639">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1640">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1641">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1642">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1643">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1644">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1645">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1646">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1647">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1648">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1649">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/new-platform-at-hogwarts-for-the-express-train&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1650">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;closed_consultation&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1651">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;closed_consultation&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1652">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1653">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1654">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Installation of double glazing at Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1655">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;installation-of-double-glazing-at-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1656">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Installation of double glazing at Hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1657">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2018-11-16T11:11:42Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1658">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1659">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1660">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1661">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1662">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1663">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1664">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1665">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1666">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1667">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1668">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1669">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1670">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1671">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1672">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1673">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1674">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1675">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1676">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1677">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1678">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1679">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/installation-of-double-glazing-at-hogwarts&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1680">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;consultation_outcome&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1681">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;consultation_outcome&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1682">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1683">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1684">
            
            

            

            <code class="ruby">      &quot;total&quot;: 3,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1685">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1686">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1687">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1688">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1689">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1690">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def upcoming_statistics_results_for_statistics_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="1691">
            <span class="hits">4</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1692">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1693">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1694">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1695">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1696">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1697">
            
            

            

            <code class="ruby">          &quot;description_with_highlighting&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1698">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-30T10:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1699">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1700">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1701">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1702">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1703">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1704">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1705">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1706">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1707">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1708">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1709">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1710">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1711">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1712">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1713">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1714">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1715">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1716">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1717">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1718">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1719">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1720">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1721">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;policy_paper&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1722">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;policy_paper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1723">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1724">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1725">
            
            

            

            <code class="ruby">      &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1726">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1727">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1728">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1729">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1730">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1731">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_content_results_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1732">
            <span class="hits">1</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1733">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1734">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1735">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1736">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1737">
            
            

            

            <code class="ruby">          &quot;content_id&quot;: &quot;1234&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1738">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1739">
            
            

            

            <code class="ruby">          &quot;description_with_highlighting&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1740">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-30T10:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1741">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1742">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1743">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1744">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1745">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1746">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1747">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1748">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1749">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1750">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1751">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1752">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1753">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1754">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1755">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1756">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1757">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1758">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1759">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1760">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1761">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1762">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1763">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;policy_paper&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1764">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;policy_paper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1765">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1766">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1767">
            
            

            

            <code class="ruby">      &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1768">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1769">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1770">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1771">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1772">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1773">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_content_manuals_results_json</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1774">
            <span class="hits">1</span>
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1775">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1776">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1777">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Replacing bristles in your Nimbus 2000&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1778">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/replacing-bristles-nimbus-2000&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1779">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Replacing bristles in your Nimbus 2000&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1780">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-30T10:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1781">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1782">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1783">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1784">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1785">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1786">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1787">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1788">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1789">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1790">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1791">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1792">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1793">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1794">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1795">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1796">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1797">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1798">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1799">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1800">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1801">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1802">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/replacing-bristles-nimbus-2000&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1803">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;manual&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1804">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;manual&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1805">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1806">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1807">
            
            

            

            <code class="ruby">    &quot;facets&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1808">
            
            

            

            <code class="ruby">      &quot;manual&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1809">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1810">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Replacing bristles in your Nimbus 2000&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1811">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/guidance/care-and-use-of-a-nimbus-2000&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1812">
            
            

            

            <code class="ruby">        },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1813">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1814">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Upgrading the baud rate on the Floo Network&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1815">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;upgrading-baud-rate-on-the-floo-network&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1816">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1817">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1818">
            
            

            

            <code class="ruby">      &quot;documents_with_no_value&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1819">
            
            

            

            <code class="ruby">      &quot;total_options&quot;: 2,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1820">
            
            

            

            <code class="ruby">      &quot;missing_options&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1821">
            
            

            

            <code class="ruby">      &quot;scope&quot;: &quot;exclude_field_filter&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1822">
            
            

            

            <code class="ruby">    },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1823">
            
            

            

            <code class="ruby">    &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1824">
            
            

            

            <code class="ruby">    &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1825">
            
            

            

            <code class="ruby">    &quot;suggested_queries&quot;: []</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1826">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1827">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1828">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1829">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filtered_by_organisation_all_content_results_json</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="1830">
            
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1831">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1832">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1833">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1834">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1835">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1836">
            
            

            

            <code class="ruby">          &quot;description_with_highlighting&quot;: &quot;Restrictions on usage of spells within school grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1837">
            
            

            

            <code class="ruby">          &quot;public_timestamp&quot;: &quot;2017-12-30T10:00:00Z&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1838">
            
            

            

            <code class="ruby">          &quot;part_of_taxonomy_tree&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1839">
            
            

            

            <code class="ruby">            &quot;622e9691-4b4f-4e9c-bce1-098b0c4f5ee2&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1840">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1841">
            
            

            

            <code class="ruby">          &quot;organisations&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1842">
            
            

            

            <code class="ruby">            {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1843">
            
            

            

            <code class="ruby">              &quot;organisation_crest&quot;: &quot;single-identity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1844">
            
            

            

            <code class="ruby">              &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1845">
            
            

            

            <code class="ruby">              &quot;link&quot;: &quot;/organisations/ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1846">
            
            

            

            <code class="ruby">              &quot;analytics_identifier&quot;: &quot;MM1&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1847">
            
            

            

            <code class="ruby">              &quot;public_timestamp&quot;: &quot;2017-12-15T11:11:02.000+00:00&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1848">
            
            

            

            <code class="ruby">              &quot;organisation_brand&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1849">
            
            

            

            <code class="ruby">              &quot;logo_formatted_title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1850">
            
            

            

            <code class="ruby">              &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1851">
            
            

            

            <code class="ruby">              &quot;content_id&quot;: &quot;92881ac6-2804-4522-bf48-cf8c781c98bf&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1852">
            
            

            

            <code class="ruby">              &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1853">
            
            

            

            <code class="ruby">              &quot;organisation_type&quot;: &quot;other&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1854">
            
            

            

            <code class="ruby">              &quot;organisation_state&quot;: &quot;live&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1855">
            
            

            

            <code class="ruby">            }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1856">
            
            

            

            <code class="ruby">          ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1857">
            
            

            

            <code class="ruby">          &quot;index&quot;: &quot;govuk&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1858">
            
            

            

            <code class="ruby">          &quot;es_score&quot;: null,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1859">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/restrictions-on-usage-of-spells-within-school-grounds&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1860">
            
            

            

            <code class="ruby">          &quot;elasticsearch_type&quot;: &quot;policy_paper&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1861">
            
            

            

            <code class="ruby">          &quot;document_type&quot;: &quot;policy_paper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1862">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1863">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1864">
            
            

            

            <code class="ruby">      &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1865">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1866">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1867">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1868">
            
            

            

            <code class="ruby">        &quot;organisations&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1869">
            
            

            

            <code class="ruby">          &quot;options&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1870">
            
            

            

            <code class="ruby">            {&quot;value&quot;: {&quot;title&quot;: &quot;Ministry of Magic&quot;, &quot;slug&quot;: &quot;ministry-of-magic&quot;}}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1871">
            
            

            

            <code class="ruby">          ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1872">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1873">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1874">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1875">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1876">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1877">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def filtered_by_manual_all_content_results_json</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="1878">
            
            

            

            <code class="ruby">    %({</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1879">
            
            

            

            <code class="ruby">      &quot;results&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1880">
            
            

            

            <code class="ruby">        {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1881">
            
            

            

            <code class="ruby">          &quot;title&quot;: &quot;Choosing your wand&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1882">
            
            

            

            <code class="ruby">          &quot;link&quot;: &quot;/choosing-your-wand&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1883">
            
            

            

            <code class="ruby">          &quot;description&quot;: &quot;Choosing your wand - a practical guide&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1884">
            
            

            

            <code class="ruby">          &quot;_id&quot;: &quot;/choosing-your-wand&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1885">
            
            

            

            <code class="ruby">        }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1886">
            
            

            

            <code class="ruby">      ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1887">
            
            

            

            <code class="ruby">      &quot;total&quot;: 1,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1888">
            
            

            

            <code class="ruby">      &quot;start&quot;: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1889">
            
            

            

            <code class="ruby">      &quot;suggested_queries&quot;: [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1890">
            
            

            

            <code class="ruby">      &quot;facets&quot;: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1891">
            
            

            

            <code class="ruby">        &quot;manual&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1892">
            
            

            

            <code class="ruby">          {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1893">
            
            

            

            <code class="ruby">            &quot;title&quot;: &quot;Choosing your wand&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1894">
            
            

            

            <code class="ruby">            &quot;_id&quot;: &quot;/choosing-your-wand&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1895">
            
            

            

            <code class="ruby">          }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1896">
            
            

            

            <code class="ruby">        ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1897">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1898">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1899">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1900">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1901">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def visit_filtered_finder(facets = {})</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1902">
            <span class="hits">1</span>
            

            

            <code class="ruby">    visit finder_path(&quot;mosw-reports&quot;, facets)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1903">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1904">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1905">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def visit_cma_cases_finder</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="5" data-linenumber="1906">
            <span class="hits">5</span>
            

            

            <code class="ruby">    visit finder_path(&quot;cma-cases&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1907">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1908">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1909">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def apply_date_filter</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1910">
            <span class="hits">1</span>
            

            

            <code class="ruby">    fill_in(&quot;Closed after&quot;, with: &quot;2015-11-01&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1911">
            <span class="hits">1</span>
            

            

            <code class="ruby">    within &quot;.js-live-search-fallback&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1912">
            <span class="hits">1</span>
            

            

            <code class="ruby">      click_on &quot;Filter results&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1913">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1914">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1915">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1916">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def assert_cma_cases_are_filtered_by_date</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1917">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;1 case&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1918">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;Closed After&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1919">
            <span class="hits">1</span>
            

            

            <code class="ruby">    expect(page).to have_content(&quot;1 November 2015&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1920">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1921">
            <span class="hits">1</span>
            

            

            <code class="ruby">    within &quot;.finder-results .gem-c-document-list__item:nth-child(1)&quot; do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1922">
            <span class="hits">1</span>
            

            

            <code class="ruby">      expect(page).to have_content(&quot;Big Beer Co / Salty Snacks Ltd merger inquiry&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1923">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1924">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1925">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1926">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1927">
            <span class="hits">1</span>
            

            

            <code class="ruby">World(DocumentHelper)</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="de47d5e21884e5ce32f275d325eb0b440fdf38e5">
  <div class="header">
    <h3>features/support/qa_helper.rb</h3>
    <h4>
      <span class="red">
  45.45%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>22</b> relevant lines.
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">require_relative &quot;../../spec/support/fixtures_helper&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">module QAHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include FixturesHelper</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def mock_qa_config</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="7">
            
            

            

            <code class="ruby">    @mock_qa_config ||= YAML.load_file(&quot;./features/fixtures/aaib_reports_qa.yaml&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def first_question</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">    mock_qa_config[&quot;pages&quot;].values.first[&quot;question&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def get_question_by_type(type)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="15">
            
            

            

            <code class="ruby">    selected_questions = mock_qa_config[&quot;pages&quot;].select do |_key, value|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="16">
            
            

            

            <code class="ruby">      value[&quot;question_type&quot;] == type</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">    selected_questions.values.first[&quot;question&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def get_question_with_custom_options</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="22">
            
            

            

            <code class="ruby">    selected_questions = mock_qa_config[&quot;pages&quot;].select do |_key, value|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">      value[&quot;question_type&quot;] == &quot;single&quot; &amp;&amp; value[&quot;custom_options&quot;].present?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="25">
            
            

            

            <code class="ruby">    selected_questions.values.first[&quot;question&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def get_page_number(question)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="29">
            
            

            

            <code class="ruby">    mock_qa_config[&quot;pages&quot;].each_with_index do |(_key, value), index|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="30">
            
            

            

            <code class="ruby">      return index + 1 if value[&quot;question&quot;] == question</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def facets</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="35">
            
            

            

            <code class="ruby">    @facets ||= aaib_reports_content_item[&quot;details&quot;][&quot;facets&quot;].select do |facet|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="36">
            
            

            

            <code class="ruby">      facet[&quot;type&quot;] == &quot;text&quot; &amp;&amp; facet[&quot;filterable&quot;] &amp;&amp; mock_qa_config[&quot;pages&quot;][facet[&quot;key&quot;]][&quot;show_in_qa&quot;]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">World(QAHelper)</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="fafd6cff850fa798f7166e045d0a74eac1efde90">
  <div class="header">
    <h3>features/support/rummager_url_helper.rb</h3>
    <h4>
      <span class="green">
  92.31%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>26</b> relevant lines.
      <span class="green"><b>24</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module RummagerUrlHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def rummager_url(params)</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="3">
            
            

            

            <code class="ruby">    &quot;#{Plek.current.find(&#39;search&#39;)}/search.json?#{params.to_query}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def mosw_search_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="7">
            <span class="hits">15</span>
            

            

            <code class="ruby">    base_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">      &quot;fields&quot; =&gt; mosw_search_fields.join(&quot;,&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">      &quot;filter_document_type&quot; =&gt; &quot;mosw_report&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def mosw_search_params_no_facets</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">    base_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">      &quot;fields&quot; =&gt; base_search_fields.join(&quot;,&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">      &quot;filter_document_type&quot; =&gt; &quot;mosw_report&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def mosw_search_fields</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="21">
            <span class="hits">15</span>
            

            

            <code class="ruby">    base_search_fields + %w[</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">      walk_type</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">      place_of_origin</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">      date_of_introduction</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">      creator</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">    ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def news_and_communications_search_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="30">
            <span class="hits">8</span>
            

            

            <code class="ruby">    base_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">      &quot;filter_content_purpose_supergroup&quot; =&gt; &quot;news_and_communications&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="35">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def services_search_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="8" data-linenumber="36">
            <span class="hits">8</span>
            

            

            <code class="ruby">    base_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">      &quot;filter_content_purpose_supergroup&quot; =&gt; &quot;services&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def policy_papers_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="42">
            <span class="hits">3</span>
            

            

            <code class="ruby">    base_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">      &quot;filter_content_purpose_supergroup&quot; =&gt; %w[policy_and_engagement],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; &quot;20&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">      &quot;order&quot; =&gt; &quot;-public_timestamp&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="49">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def all_content_params</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="50">
            
            

            

            <code class="ruby">    base_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">      &quot;count&quot; =&gt; &quot;20&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def cma_case_search_params</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="56">
            <span class="hits">20</span>
            

            

            <code class="ruby">    base_search_params.merge(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">      &quot;fields&quot; =&gt; cma_case_search_fields.join(&quot;,&quot;),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">      &quot;filter_document_type&quot; =&gt; &quot;cma_case&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby">    )</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="62">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def cma_case_search_fields</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="63">
            <span class="hits">20</span>
            

            

            <code class="ruby">    base_search_fields + %w[</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">      case_type</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">      case_state</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">      market_sector</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">      outcome_type</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">      opened_date</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">      closed_date</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">    ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="73">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def base_search_params</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby">    {</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="55" data-linenumber="75">
            <span class="hits">55</span>
            

            

            <code class="ruby">      &quot;count&quot; =&gt; &quot;1500&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">      &quot;start&quot; =&gt; &quot;0&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">      &quot;suggest&quot; =&gt; &quot;spelling_with_highlighting&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby">    }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="81">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def base_search_fields</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby">    %w[</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="36" data-linenumber="83">
            <span class="hits">36</span>
            

            

            <code class="ruby">      title</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby">      link</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            
            

            

            <code class="ruby">      description_with_highlighting</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            
            

            

            <code class="ruby">      public_timestamp</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">      popularity</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby">      content_purpose_supergroup</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">      content_store_document_type</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">      format</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby">      is_historic</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">      government_name</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">      content_id</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">      parts</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">    ]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="99">
            <span class="hits">1</span>
            

            

            <code class="ruby">World(RummagerUrlHelper)</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="34175305ca8434ba77268f2ab2334a3a4462051a">
  <div class="header">
    <h3>spec/factories/brexit_checker/action.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>14</b> relevant lines.
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :brexit_checker_action, class: BrexitChecker::Action do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    title { &quot;A title&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    title_url { &quot;http://www.gov.uk&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    consequence { &quot;A consequence&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    priority { 5 }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    criteria { %w[construction] }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">    audience { &quot;business&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence(:id) { |n| &quot;Action#{n}&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            <span class="hits">1</span>
            

            

            <code class="ruby">    trait :citizen do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">      audience { &quot;citizen&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">      grouping_criteria { %w[living-uk] }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">      criteria { %w[living-uk] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with { BrexitChecker::Action.new(attributes) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="92dfee68d45491efeefcc329ae9206f17593df9c">
  <div class="header">
    <h3>spec/factories/brexit_checker/criterion.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>5</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :brexit_checker_criterion, class: BrexitChecker::Criterion do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    key { &quot;forestry&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    text { &quot;You work in plants and forestry&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with { BrexitChecker::Criterion.new(attributes) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="6a0c9f89960f2d98bbe3cd9559c6efd1225ed694">
  <div class="header">
    <h3>spec/factories/brexit_checker/group.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>6</b> relevant lines.
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :brexit_checker_group, class: BrexitChecker::Group do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    key { &quot;living-uk&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    heading { &quot;You live in the UK&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    priority { 6 }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with { BrexitChecker::Group.new(attributes) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="459cf651f7c28d317777fe6ec7183db3b03f396f">
  <div class="header">
    <h3>spec/factories/brexit_checker/notification.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>7</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :brexit_checker_notification, class: BrexitChecker::Notification do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    id { SecureRandom.uuid }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    action_id { SecureRandom.uuid }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    type { &quot;addition&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    date { &quot;2019-08-07&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with { BrexitChecker::Notification.new(attributes) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="7578f4032cfcccef4e3c5cc0b39d69033f6c9e86">
  <div class="header">
    <h3>spec/factories/brexit_checker/option.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>5</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :brexit_checker_option, class: BrexitChecker::Question::Option do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    label { &quot;A title&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sub_options { [] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with { BrexitChecker::Question::Option.new(attributes) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="37c3d293700e7d3fdcca23b2d3650018468278f1">
  <div class="header">
    <h3>spec/factories/brexit_checker/question.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>7</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :brexit_checker_question, class: BrexitChecker::Question do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    text { &quot;A title&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    key { SecureRandom.uuid }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    type { &quot;single&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    options { [] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with { BrexitChecker::Question.new(attributes) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="d5eadc82299a603364917d24e590404b1edd669a">
  <div class="header">
    <h3>spec/factories/content_item.rb</h3>
    <h4>
      <span class="red">
  72.73%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>11</b> relevant lines.
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :content_item, class: ContentItem do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :content_id, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            
            

            

            <code class="ruby">      &quot;content_id_#{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    slug { &quot;/finder_slug&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    title { &quot;finder-title&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">    links { {} }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    details do</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">        &#39;details_show_summaries&#39;: true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">        &quot;sort&quot;: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">          {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">            &quot;name&quot;: &quot;Topic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">            &quot;key&quot;: &quot;topic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">            &quot;default&quot;: true,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">          {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">            &quot;name&quot;: &quot;Most viewed&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">            &quot;key&quot;: &quot;-popularity&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">        ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">      }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="26">
            
            

            

            <code class="ruby">      new(attributes.deep_stringify_keys)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="95462c451e06925d7379622af48b47b2d4979350">
  <div class="header">
    <h3>spec/factories/date_facet.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>7</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :date_facet, class: DateFacet do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    key { &quot;published_at&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    filterable { true }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    type { &quot;date&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    display_as_result_metadata { true }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with { new(attributes.deep_stringify_keys, {}) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="c4f6ab8f1d88e751985a27890271f1cbc2ffdf9e">
  <div class="header">
    <h3>spec/factories/document.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>5</b> relevant lines.
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :document, class: Document do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    transient do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">      index { 1 }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with { new(FactoryBot.build(:document_hash, attributes), index) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="84456bc0cae9c93698b12b3efd769e40c9da9e1f">
  <div class="header">
    <h3>spec/factories/document_hash.rb</h3>
    <h4>
      <span class="yellow">
  83.33%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>24</b> relevant lines.
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :document_hash, class: Hash do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :title, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="4">
            
            

            

            <code class="ruby">      &quot;document_title_#{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :link, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="7">
            
            

            

            <code class="ruby">      &quot;path/to/document_#{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    content_id { SecureRandom.uuid }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :description, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">      &quot;description_#{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">    public_timestamp { Time.zone.now }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">    release_timestamp { Time.zone.now }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            <span class="hits">1</span>
            

            

            <code class="ruby">    document_type { &quot;answer&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">    organisations do</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">      [{</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="18">
            
            

            

            <code class="ruby">        &quot;acronym&quot; =&gt; &quot;DWP&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">        &quot;content_id&quot; =&gt; &quot;b548a09f-8b35-4104-89f4-f1a40bf3136d&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">        &quot;title&quot; =&gt; &quot;Department for Work and Pensions&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">      }]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">    content_purpose_supergroup { &quot;guidance_and_regulation&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">    is_historic { false }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    government_name { &quot;2015 Conservative government&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">    es_score { nil }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="27">
            <span class="hits">1</span>
            

            

            <code class="ruby">    combined_score { nil }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            <span class="hits">1</span>
            

            

            <code class="ruby">    original_rank { nil }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            <span class="hits">1</span>
            

            

            <code class="ruby">    format { &quot;answer&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">    facet_values { [] }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            <span class="hits">1</span>
            

            

            <code class="ruby">    parts { [] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="33">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with { attributes.deep_stringify_keys }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="f39e19f5ceda445bdfc750206e69e0c8282ccde7">
  <div class="header">
    <h3>spec/factories/level_one_taxon_hash.rb</h3>
    <h4>
      <span class="green">
  95.45%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>22</b> relevant lines.
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :level_one_taxon_hash, class: Hash do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :title, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="26" data-linenumber="4">
            <span class="hits">26</span>
            

            

            <code class="ruby">      &quot;level_one_taxon_title_#{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="27" data-linenumber="7">
            <span class="hits">27</span>
            

            

            <code class="ruby">    content_id { SecureRandom.uuid }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :base_path, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="28" data-linenumber="10">
            <span class="hits">28</span>
            

            

            <code class="ruby">      &quot;/path/level_one_taxon_#{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :description, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="28" data-linenumber="14">
            <span class="hits">28</span>
            

            

            <code class="ruby">      &quot;this is level one taxon #{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">    transient do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="3" data-linenumber="18">
            <span class="hits">3</span>
            

            

            <code class="ruby">      number_of_children { 0 }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    transient do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="29" data-linenumber="22">
            <span class="hits">29</span>
            

            

            <code class="ruby">      child_taxons { [] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="25">
            <span class="hits">1</span>
            

            

            <code class="ruby">    after(:build) do |taxon, evaluator|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="28" data-linenumber="26">
            <span class="hits">28</span>
            

            

            <code class="ruby">      taxon[:links] =</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="28" data-linenumber="27">
            <span class="hits">28</span>
            

            

            <code class="ruby">        if evaluator.child_taxons.any?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="28">
            
            

            

            <code class="ruby">          { child_taxons: evaluator.child_taxons }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="28" data-linenumber="29">
            <span class="hits">28</span>
            

            

            <code class="ruby">        elsif evaluator.number_of_children == 0</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="30">
            <span class="hits">2</span>
            

            

            <code class="ruby">          {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">        else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="26" data-linenumber="32">
            <span class="hits">26</span>
            

            

            <code class="ruby">          { child_taxons: FactoryBot.build_list(:taxon_hash, evaluator.number_of_children) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="28" data-linenumber="34">
            <span class="hits">28</span>
            

            

            <code class="ruby">      taxon.deep_stringify_keys!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="29" data-linenumber="37">
            <span class="hits">29</span>
            

            

            <code class="ruby">    initialize_with { attributes }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="3850ebabc5640b9b7e0db3db5da9000245c5dbc2">
  <div class="header">
    <h3>spec/factories/option_select_facet.rb</h3>
    <h4>
      <span class="yellow">
  90.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>10</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :option_select_facet, class: OptionSelectFacet do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    key { &quot;organisations&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">    filterable { true }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">    type { &quot;text&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">    display_as_result_metadata { true }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">    transient do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">      values { nil }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">    initialize_with do</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">      new(attributes.deep_stringify_keys, values)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="a43ac0fc68f0b27577ede51e14342608328f7af4">
  <div class="header">
    <h3>spec/factories/root_taxon_hash.rb</h3>
    <h4>
      <span class="green">
  93.33%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>15</b> relevant lines.
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :root_taxon_hash, class: Hash do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="3">
            <span class="hits">16</span>
            

            

            <code class="ruby">    title { &quot;root taxon&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="4">
            <span class="hits">16</span>
            

            

            <code class="ruby">    content_id { SecureRandom.uuid }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="5">
            <span class="hits">16</span>
            

            

            <code class="ruby">    base_path { &quot;/&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="6">
            <span class="hits">16</span>
            

            

            <code class="ruby">    description { &quot;The root taxon&quot; }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            <span class="hits">1</span>
            

            

            <code class="ruby">    transient do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">      level_one_taxon_hashes { [] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="12">
            <span class="hits">16</span>
            

            

            <code class="ruby">    initialize_with { attributes }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">    after(:build) do |taxon, evaluator|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="15">
            <span class="hits">15</span>
            

            

            <code class="ruby">      taxon[:links] =</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="16">
            <span class="hits">15</span>
            

            

            <code class="ruby">        if evaluator.level_one_taxon_hashes.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="17">
            
            

            

            <code class="ruby">          {}</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">        else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="43" data-linenumber="19">
            <span class="hits">43</span>
            

            

            <code class="ruby">          { level_one_taxons: evaluator.level_one_taxon_hashes.map { |t| t.except(:links).merge(links: {}) } }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="21">
            <span class="hits">15</span>
            

            

            <code class="ruby">      taxon.deep_stringify_keys!</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="a1fcb2a892314f6b63c98b71ebcc387cea491ca3">
  <div class="header">
    <h3>spec/factories/taxon_hash.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>10</b> relevant lines.
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">FactoryBot.define do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  factory :taxon_hash, class: Hash do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :title, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="52" data-linenumber="4">
            <span class="hits">52</span>
            

            

            <code class="ruby">      &quot;taxon_title_#{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="53" data-linenumber="7">
            <span class="hits">53</span>
            

            

            <code class="ruby">    content_id { SecureRandom.uuid }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :base_path, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="52" data-linenumber="10">
            <span class="hits">52</span>
            

            

            <code class="ruby">      &quot;/path/taxon_#{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">    sequence :description, 1 do |n|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="52" data-linenumber="14">
            <span class="hits">52</span>
            

            

            <code class="ruby">      &quot;this is taxon #{n}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="53" data-linenumber="17">
            <span class="hits">53</span>
            

            

            <code class="ruby">    initialize_with { attributes }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="d793e8ba25b49374422bb1303a44d600018fba96">
  <div class="header">
    <h3>spec/support/content_helper.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>11</b> relevant lines.
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            
            

            

            <code class="ruby"># Include this module to get access to the GOVUK Content Schema examples in the</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            
            

            

            <code class="ruby"># tests.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby"># By default, the govuk-content-schemas repository is expected to be located</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"># at ../govuk-content-schemas. This can be overridden with the</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"># GOVUK_CONTENT_SCHEMAS_PATH environment variable, for example:</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">#   $ GOVUK_CONTENT_SCHEMAS_PATH=/some/dir/govuk-content-schemas bundle exec rake</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">#</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;gds_api/test_helpers/content_store&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            <span class="hits">1</span>
            

            

            <code class="ruby">GovukContentSchemaTestHelpers.configure do |config|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.schema_type = &quot;frontend&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  config.project_root = Rails.root</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="17">
            <span class="hits">1</span>
            

            

            <code class="ruby">module GovukContentSchemaExamples</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  extend ActiveSupport::Concern</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="20">
            <span class="hits">1</span>
            

            

            <code class="ruby">  included do</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            <span class="hits">1</span>
            

            

            <code class="ruby">    include GdsApi::TestHelpers::ContentStore</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">    # Returns a hash representing an finder content item from govuk-content-schemas</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            <span class="hits">1</span>
            

            

            <code class="ruby">    def govuk_content_schema_example(name, format = &quot;finder&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="25">
            <span class="hits">20</span>
            

            

            <code class="ruby">      string = GovukContentSchemaTestHelpers::Examples.new.get(format, name)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="26">
            <span class="hits">20</span>
            

            

            <code class="ruby">      JSON.parse(string)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="dc81a60c7a3bc8c04f3a3dc5cbe2a2bb73f84da7">
  <div class="header">
    <h3>spec/support/fixtures_helper.rb</h3>
    <h4>
      <span class="red">
  57.58%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>33</b> relevant lines.
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module FixturesHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def fixtures_path</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="3">
            <span class="hits">2</span>
            

            

            <code class="ruby">    File.expand_path(Rails.root + &quot;features/fixtures&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def aaib_reports_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="7">
            
            

            

            <code class="ruby">    @aaib_reports_content_item ||= JSON.parse(File.read(fixtures_path + &quot;/aaib_reports_example.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="10">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def aaib_reports_qa_config</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="11">
            
            

            

            <code class="ruby">    YAML.load_file(fixtures_path + &quot;/aaib_reports_qa.yaml&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def uk_nationals_in_eu_config</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="15">
            
            

            

            <code class="ruby">    YAML.load_file(fixtures_path + &quot;/uk_nationals_in_eu.yaml&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def cma_cases_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="19">
            
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/cma_cases_content_item.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def cma_cases_signup_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="23">
            
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/cma_cases_signup_content_item.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def news_and_communications_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="27">
            
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/news_and_communications.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def news_and_communications_signup_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="31">
            
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/news_and_communications_signup_content_item.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="34">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def cma_cases_with_multi_facets_signup_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="2" data-linenumber="35">
            <span class="hits">2</span>
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/cma_cases_with_multi_facets_signup_content_item.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def actions_csv_to_convert_to_yaml</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="39">
            
            

            

            <code class="ruby">    fixtures_path + &quot;/actions_csv_to_convert.csv&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="42">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def criteria_csv_to_convert_to_yaml</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="43">
            
            

            

            <code class="ruby">    fixtures_path + &quot;/criteria_csv_to_convert.csv&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="46">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def policy_papers_finder_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="47">
            
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/policy_and_engagement.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="50">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def policy_papers_finder_signup_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="51">
            
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/policy_papers_and_consultations_email_signup.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def research_and_stats_finder_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="55">
            
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/statistics.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="58">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def research_and_stats_finder_signup_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="59">
            
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/research_and_statistics_email_signup.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="62">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def bad_input_finder_signup_content_item</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="63">
            
            

            

            <code class="ruby">    JSON.parse(File.read(fixtures_path + &quot;/bad_input_email_signup.json&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="8164c81838b846708738775b9bbb13c3f9133c74">
  <div class="header">
    <h3>spec/support/registry_helper.rb</h3>
    <h4>
      <span class="yellow">
  81.82%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>11</b> relevant lines.
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">module RegistrySpecHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_people_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="24" data-linenumber="3">
            <span class="hits">24</span>
            

            

            <code class="ruby">    stub_request(:get, &quot;http://search.dev.gov.uk/search.json&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            
            

            

            <code class="ruby">        .with(query: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            
            

            

            <code class="ruby">          count: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby">          facet_people: &quot;1500,examples:0,order:value.title&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            
            

            

            <code class="ruby">        })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="8">
            
            

            

            <code class="ruby">        .to_return(body: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">          results: [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby">          facets: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            
            

            

            <code class="ruby">            people: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            
            

            

            <code class="ruby">              options: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            
            

            

            <code class="ruby">                {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">                  value: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby">                    title: &quot;Albus Dumbledore&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            
            

            

            <code class="ruby">                    slug: &quot;albus-dumbledore&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby">                    _id: &quot;a field that we&#39;re not using&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            
            

            

            <code class="ruby">                    content_id: &quot;content_id_for_albus-dumbledore&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            
            

            

            <code class="ruby">                  },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            
            

            

            <code class="ruby">                },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">                {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby">                  value: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            
            

            

            <code class="ruby">                    title: &quot;Cornelius Fudge&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            
            

            

            <code class="ruby">                    slug: &quot;cornelius-fudge&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby">                    _id: &quot;a field that we&#39;re not using&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            
            

            

            <code class="ruby">                    content_id: &quot;content_id_for_cornelius-fudge&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            
            

            

            <code class="ruby">                  },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">                },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">                {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">                  value: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            
            

            

            <code class="ruby">                    title: &quot;Harry Potter&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            
            

            

            <code class="ruby">                    slug: &quot;harry-potter&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            
            

            

            <code class="ruby">                    _id: &quot;a field that we&#39;re not using&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            
            

            

            <code class="ruby">                    content_id: &quot;content_id_for_harry-potter&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            
            

            

            <code class="ruby">                  },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            
            

            

            <code class="ruby">                },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            
            

            

            <code class="ruby">                {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            
            

            

            <code class="ruby">                  value: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            
            

            

            <code class="ruby">                    title: &quot;Ron Weasley&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            
            

            

            <code class="ruby">                    slug: &quot;ron-weasley&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            
            

            

            <code class="ruby">                    _id: &quot;a field that we&#39;re not using&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            
            

            

            <code class="ruby">                    content_id: &quot;content_id_for_ron-weasley&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            
            

            

            <code class="ruby">                  },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="45">
            
            

            

            <code class="ruby">                },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            
            

            

            <code class="ruby">                {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            
            

            

            <code class="ruby">                  value: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            
            

            

            <code class="ruby">                    title: &quot;Rufus Scrimgeour&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            
            

            

            <code class="ruby">                    slug: &quot;rufus-scrimgeour&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            
            

            

            <code class="ruby">                    _id: &quot;/government/people/rufus-scrimgeour&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            
            

            

            <code class="ruby">                    content_id: &quot;content_id_for_rufus-scrimgeour&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            
            

            

            <code class="ruby">                  },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            
            

            

            <code class="ruby">                },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            
            

            

            <code class="ruby">              ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            
            

            

            <code class="ruby">            },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="56">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="57">
            
            

            

            <code class="ruby">        }.to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="60">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_roles_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="61">
            
            

            

            <code class="ruby">    stub_request(:get, &quot;http://search.dev.gov.uk/search.json&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            
            

            

            <code class="ruby">        .with(query: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="63">
            
            

            

            <code class="ruby">          count: 0,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            
            

            

            <code class="ruby">          facet_roles: &quot;1500,examples:0,order:value.title&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="65">
            
            

            

            <code class="ruby">        })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="66">
            
            

            

            <code class="ruby">        .to_return(body: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="67">
            
            

            

            <code class="ruby">          results: [],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            
            

            

            <code class="ruby">          facets: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            
            

            

            <code class="ruby">            roles: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="70">
            
            

            

            <code class="ruby">              options: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            
            

            

            <code class="ruby">                {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            
            

            

            <code class="ruby">                  value: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            
            

            

            <code class="ruby">                    title: &quot;Prime Minister&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="74">
            
            

            

            <code class="ruby">                    slug: &quot;prime-minister&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="75">
            
            

            

            <code class="ruby">                    _id: &quot;a field that we&#39;re not using&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            
            

            

            <code class="ruby">                    content_id: &quot;content_id_for_prime-minister&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            
            

            

            <code class="ruby">                  },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="78">
            
            

            

            <code class="ruby">                },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="79">
            
            

            

            <code class="ruby">              ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="80">
            
            

            

            <code class="ruby">            },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="81">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="82">
            
            

            

            <code class="ruby">        }.to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="84">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="85">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_organisations_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="31" data-linenumber="86">
            <span class="hits">31</span>
            

            

            <code class="ruby">    stub_request(:get, &quot;http://search.dev.gov.uk/search.json&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            
            

            

            <code class="ruby">    .with(query: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="88">
            
            

            

            <code class="ruby">      count: 1500,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="89">
            
            

            

            <code class="ruby">      fields: %w[slug title acronym content_id],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            
            

            

            <code class="ruby">      filter_format: %(organisation),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            
            

            

            <code class="ruby">      order: &quot;title&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="93">
            
            

            

            <code class="ruby">    .to_return(body: { results: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="94">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="95">
            
            

            

            <code class="ruby">        &quot;title&quot;: &quot;Closed organisation: Death Eaters&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="96">
            
            

            

            <code class="ruby">        &quot;slug&quot;: &quot;death-eaters&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="97">
            
            

            

            <code class="ruby">        &quot;_id&quot;: &quot;/government/organisations/death-eaters&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="98">
            
            

            

            <code class="ruby">        &quot;content_id&quot;: &quot;content_id_for_death-eaters&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="99">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="100">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="101">
            
            

            

            <code class="ruby">        &quot;title&quot;: &quot;Department of Mysteries&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="102">
            
            

            

            <code class="ruby">        &quot;slug&quot;: &quot;department-of-mysteries&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="103">
            
            

            

            <code class="ruby">        &quot;_id&quot;: &quot;/government/organisations/department-of-mysteries&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="104">
            
            

            

            <code class="ruby">        &quot;content_id&quot;: &quot;content_id_for_department-of-mysteries&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="105">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="106">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="107">
            
            

            

            <code class="ruby">        &quot;title&quot;: &quot;Gringots&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="108">
            
            

            

            <code class="ruby">        &quot;acronym&quot;: &quot;GRI&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="109">
            
            

            

            <code class="ruby">        &quot;slug&quot;: &quot;gringots&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="110">
            
            

            

            <code class="ruby">        &quot;_id&quot;: &quot;/government/organisations/gringots&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="111">
            
            

            

            <code class="ruby">        &quot;content_id&quot;: &quot;content_id_for_gringots&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="112">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="113">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="114">
            
            

            

            <code class="ruby">        &quot;title&quot;: &quot;Ministry of Magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="115">
            
            

            

            <code class="ruby">        &quot;slug&quot;: &quot;ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="116">
            
            

            

            <code class="ruby">        &quot;acronym&quot;: &quot;MOM&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="117">
            
            

            

            <code class="ruby">        &quot;_id&quot;: &quot;a field that we&#39;re not using&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="118">
            
            

            

            <code class="ruby">        &quot;content_id&quot;: &quot;content_id_for_ministry-of-magic&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="119">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="120">
            
            

            

            <code class="ruby">    ] }.to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="121">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="122">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="123">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_manuals_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="6" data-linenumber="124">
            <span class="hits">6</span>
            

            

            <code class="ruby">    stub_request(:get, &quot;http://search.dev.gov.uk/search.json&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="125">
            
            

            

            <code class="ruby">      .with(query: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="126">
            
            

            

            <code class="ruby">        filter_document_type: %w[manual service_manual_homepage service_manual_guide],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="127">
            
            

            

            <code class="ruby">        fields: %w[title],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="128">
            
            

            

            <code class="ruby">        count: 1500,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="129">
            
            

            

            <code class="ruby">      })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="130">
            
            

            

            <code class="ruby">      .to_return(body: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="131">
            
            

            

            <code class="ruby">        results: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="132">
            
            

            

            <code class="ruby">          {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="133">
            
            

            

            <code class="ruby">            title: &quot;Replacing bristles in your Nimbus 2000&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="134">
            
            

            

            <code class="ruby">            _id: &quot;/guidance/care-and-use-of-a-nimbus-2000&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="135">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="136">
            
            

            

            <code class="ruby">          {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="137">
            
            

            

            <code class="ruby">            title: &quot;Upgrading the baud rate on the Floo Network&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="138">
            
            

            

            <code class="ruby">            _id: &quot;upgrading-baud-rate-on-the-floo-network&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="139">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="140">
            
            

            

            <code class="ruby">          {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="141">
            
            

            

            <code class="ruby">            title: &quot;How to be a Wizard&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="142">
            
            

            

            <code class="ruby">            _id: &quot;how-to-be-a-wizard&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="143">
            
            

            

            <code class="ruby">          },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="144">
            
            

            

            <code class="ruby">        ],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="145">
            
            

            

            <code class="ruby">      }.to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="146">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="147">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="148">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def stub_full_topical_events_registry_request</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="149">
            
            

            

            <code class="ruby">    stub_request(:get, &quot;http://search.dev.gov.uk/search.json&quot;)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="150">
            
            

            

            <code class="ruby">    .with(query: {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="151">
            
            

            

            <code class="ruby">      count: 1500,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="152">
            
            

            

            <code class="ruby">      fields: %w[slug title],</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="153">
            
            

            

            <code class="ruby">      filter_format: %(topical_event),</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="154">
            
            

            

            <code class="ruby">      order: &quot;title&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="155">
            
            

            

            <code class="ruby">    })</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="156">
            
            

            

            <code class="ruby">    .to_return(body: { results: [</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="157">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="158">
            
            

            

            <code class="ruby">        &quot;title&quot;: &quot;2014 Overseas Territories Joint Ministerial Council&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="159">
            
            

            

            <code class="ruby">        &quot;slug&quot;: &quot;2014-overseas-territories-joint-ministerial-council&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="160">
            
            

            

            <code class="ruby">        &quot;_id&quot;: &quot;/government/topical-events/2014-overseas-territories-joint-ministerial-council&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="161">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="162">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="163">
            
            

            

            <code class="ruby">        &quot;title&quot;: &quot;Anti-Corruption Summit: London 2016&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="164">
            
            

            

            <code class="ruby">        &quot;slug&quot;: &quot;anti-corruption-summit-london-2016&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="165">
            
            

            

            <code class="ruby">        &quot;_id&quot;: &quot;/government/topical-events/anti-corruption-summit-london-2016&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="166">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="167">
            
            

            

            <code class="ruby">      {</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="168">
            
            

            

            <code class="ruby">        &quot;title&quot;: &quot;Autumn Budget 2017&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="169">
            
            

            

            <code class="ruby">        &quot;slug&quot;: &quot;autumn-budget-2017&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="170">
            
            

            

            <code class="ruby">        &quot;_id&quot;: &quot;/government/topical-events/autumn-budget-2017&quot;,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="171">
            
            

            

            <code class="ruby">      },</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="172">
            
            

            

            <code class="ruby">    ] }.to_json)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="173">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="174">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="aea4d507fee70b8b56ba42da22b7b66811338744">
  <div class="header">
    <h3>spec/support/taxonomy_helper.rb</h3>
    <h4>
      <span class="green">
  94.44%
</span>

      lines covered
    </h4>

    

    <div class="t-line-summary">
      <b>18</b> relevant lines.
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="1">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;gds_api/test_helpers/content_store&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="2">
            <span class="hits">1</span>
            

            

            <code class="ruby">require &quot;registries/base_registries&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="3">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            <span class="hits">1</span>
            

            

            <code class="ruby">module TaxonomySpecHelper</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            <span class="hits">1</span>
            

            

            <code class="ruby">  include ::GdsApi::TestHelpers::ContentStore</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def topic_taxonomy_api_is_unavailable</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="8">
            
            

            

            <code class="ruby">    stub_content_store_isnt_available</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="9">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def topic_taxonomy_has_taxons(level_one_taxon_hashes = FactoryBot.build_list(:level_one_taxon_hash, 2, number_of_children: 2))</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="12">
            <span class="hits">15</span>
            

            

            <code class="ruby">    has_taxons(level_one_taxon_hashes)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="13">
            <span class="hits">15</span>
            

            

            <code class="ruby">    has_root_taxon_with(level_one_taxon_hashes)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="16">
            <span class="hits">1</span>
            

            

            <code class="ruby">private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="18">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_root_taxon_with(level_one_taxon_hashes)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="19">
            <span class="hits">15</span>
            

            

            <code class="ruby">    root_taxon_hash = FactoryBot.build(:root_taxon_hash, level_one_taxon_hashes: level_one_taxon_hashes)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="15" data-linenumber="20">
            <span class="hits">15</span>
            

            

            <code class="ruby">    stub_content_store_has_item(&quot;/&quot;, root_taxon_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="23">
            <span class="hits">1</span>
            

            

            <code class="ruby">  def has_taxons(taxon_hashes)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="95" data-linenumber="24">
            <span class="hits">95</span>
            

            

            <code class="ruby">    return if taxon_hashes.nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            
            

            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="41" data-linenumber="26">
            <span class="hits">41</span>
            

            

            <code class="ruby">    taxon_hashes.each do |taxon_hash|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="80" data-linenumber="27">
            <span class="hits">80</span>
            

            

            <code class="ruby">      stub_content_store_has_item(taxon_hash[&quot;base_path&quot;], taxon_hash)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="80" data-linenumber="28">
            <span class="hits">80</span>
            

            

            <code class="ruby">      has_taxons(taxon_hash.dig(&quot;links&quot;, &quot;child_taxons&quot;))</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            
            

            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            
            

            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            
            

            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
